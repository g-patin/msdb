
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../package-usage/">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.34">
    
    
      
        <title>References - msdb</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.35f28582.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../css/custom.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#commands" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="msdb" class="md-header__button md-logo" aria-label="msdb" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            msdb
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              References
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="msdb" class="md-nav__button md-logo" aria-label="msdb" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    msdb
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome !
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../get-started.md      -" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    None
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    How-to-guides
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            How-to-guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../create-MFT-class-instance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create an MFT class instance
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Explanation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Explanation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../package-usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Package usage
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    References
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    References
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#commands" class="md-nav__link">
    <span class="md-ellipsis">
      Commands
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datasets" class="md-nav__link">
    <span class="md-ellipsis">
      Datasets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#databases-management" class="md-nav__link">
    <span class="md-ellipsis">
      Databases management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Data processing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mft-class" class="md-nav__link">
    <span class="md-ellipsis">
      MFT class
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading" class="md-nav__link">
    <span class="md-ellipsis">
      microfading
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.MFT" class="md-nav__link">
    <span class="md-ellipsis">
      MFT
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MFT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_meas_ids" class="md-nav__link">
    <span class="md-ellipsis">
      get_meas_ids
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_objects" class="md-nav__link">
    <span class="md-ellipsis">
      get_objects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_wavelength" class="md-nav__link">
    <span class="md-ellipsis">
      get_wavelength
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__init__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.__init__--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.compute_JND" class="md-nav__link">
    <span class="md-ellipsis">
      compute_JND
    </span>
  </a>
  
    <nav class="md-nav" aria-label="compute_JND">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.compute_JND--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.compute_JND--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.compute_delta" class="md-nav__link">
    <span class="md-ellipsis">
      compute_delta
    </span>
  </a>
  
    <nav class="md-nav" aria-label="compute_delta">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.compute_delta--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.compute_delta--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.compute_fitting" class="md-nav__link">
    <span class="md-ellipsis">
      compute_fitting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="compute_fitting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.compute_fitting--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.compute_fitting--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.compute_mean" class="md-nav__link">
    <span class="md-ellipsis">
      compute_mean
    </span>
  </a>
  
    <nav class="md-nav" aria-label="compute_mean">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.compute_mean--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.compute_mean--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.compute_mean--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.compute_sp_derivate" class="md-nav__link">
    <span class="md-ellipsis">
      compute_sp_derivate
    </span>
  </a>
  
    <nav class="md-nav" aria-label="compute_sp_derivate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.compute_sp_derivate--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_Lab" class="md-nav__link">
    <span class="md-ellipsis">
      get_Lab
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_Lab">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_Lab--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_Lab--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_XYZ" class="md-nav__link">
    <span class="md-ellipsis">
      get_XYZ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_XYZ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_XYZ--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_XYZ--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_cielab" class="md-nav__link">
    <span class="md-ellipsis">
      get_cielab
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_cielab">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_cielab--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_cielab--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_data--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_data--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_doses" class="md-nav__link">
    <span class="md-ellipsis">
      get_doses
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_doses">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_doses--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_doses--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_illuminant" class="md-nav__link">
    <span class="md-ellipsis">
      get_illuminant
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_illuminant">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_illuminant--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_illuminant--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      get_metadata
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_metadata">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_metadata--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_metadata--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_observer" class="md-nav__link">
    <span class="md-ellipsis">
      get_observer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_observer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_observer--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_observer--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_sRGB" class="md-nav__link">
    <span class="md-ellipsis">
      get_sRGB
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_sRGB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_sRGB--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_sRGB--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_spectra" class="md-nav__link">
    <span class="md-ellipsis">
      get_spectra
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_spectra">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_spectra--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_spectra--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_xy" class="md-nav__link">
    <span class="md-ellipsis">
      get_xy
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_xy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_xy--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_xy--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plot_CIELAB" class="md-nav__link">
    <span class="md-ellipsis">
      plot_CIELAB
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plot_CIELAB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plot_CIELAB--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plot_CIELAB--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plot_bars" class="md-nav__link">
    <span class="md-ellipsis">
      plot_bars
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plot_bars">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plot_bars--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plot_delta" class="md-nav__link">
    <span class="md-ellipsis">
      plot_delta
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plot_delta">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plot_delta--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plot_sp" class="md-nav__link">
    <span class="md-ellipsis">
      plot_sp
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plot_sp">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plot_sp--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plot_sp--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plot_swatches_circle" class="md-nav__link">
    <span class="md-ellipsis">
      plot_swatches_circle
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plot_swatches_circle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plot_swatches_circle--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plot_swatches_circle--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plots" class="md-nav__link">
    <span class="md-ellipsis">
      plots
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plots">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plots--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.read_files" class="md-nav__link">
    <span class="md-ellipsis">
      read_files
    </span>
  </a>
  
    <nav class="md-nav" aria-label="read_files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.read_files--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.read_files--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.get_colorimetry_info" class="md-nav__link">
    <span class="md-ellipsis">
      get_colorimetry_info
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_colorimetry_info">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.get_colorimetry_info--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.get_config" class="md-nav__link">
    <span class="md-ellipsis">
      get_config
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_config">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.get_config--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.get_config--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.get_config_path" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_path
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.get_datasets" class="md-nav__link">
    <span class="md-ellipsis">
      get_datasets
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_datasets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.get_datasets--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.get_datasets--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.get_devices_info" class="md-nav__link">
    <span class="md-ellipsis">
      get_devices_info
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_devices_info">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.get_devices_info--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.get_exposure_conditions" class="md-nav__link">
    <span class="md-ellipsis">
      get_exposure_conditions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_exposure_conditions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.get_exposure_conditions--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.get_institution_info" class="md-nav__link">
    <span class="md-ellipsis">
      get_institution_info
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_institution_info">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.get_institution_info--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.get_light_dose_info" class="md-nav__link">
    <span class="md-ellipsis">
      get_light_dose_info
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_light_dose_info">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.get_light_dose_info--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.is_DB" class="md-nav__link">
    <span class="md-ellipsis">
      is_DB
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.process_rawdata" class="md-nav__link">
    <span class="md-ellipsis">
      process_rawdata
    </span>
  </a>
  
    <nav class="md-nav" aria-label="process_rawdata">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.process_rawdata--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.process_rawdata--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.reset_config" class="md-nav__link">
    <span class="md-ellipsis">
      reset_config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.set_DB" class="md-nav__link">
    <span class="md-ellipsis">
      set_DB
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.set_colorimetry_info" class="md-nav__link">
    <span class="md-ellipsis">
      set_colorimetry_info
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.set_devices_info" class="md-nav__link">
    <span class="md-ellipsis">
      set_devices_info
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.set_exposure_conditions" class="md-nav__link">
    <span class="md-ellipsis">
      set_exposure_conditions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.set_institution_info" class="md-nav__link">
    <span class="md-ellipsis">
      set_institution_info
    </span>
  </a>
  
    <nav class="md-nav" aria-label="set_institution_info">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.set_institution_info--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.set_light_dose" class="md-nav__link">
    <span class="md-ellipsis">
      set_light_dose
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#commands" class="md-nav__link">
    <span class="md-ellipsis">
      Commands
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datasets" class="md-nav__link">
    <span class="md-ellipsis">
      Datasets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#databases-management" class="md-nav__link">
    <span class="md-ellipsis">
      Databases management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Data processing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mft-class" class="md-nav__link">
    <span class="md-ellipsis">
      MFT class
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading" class="md-nav__link">
    <span class="md-ellipsis">
      microfading
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.MFT" class="md-nav__link">
    <span class="md-ellipsis">
      MFT
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MFT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_meas_ids" class="md-nav__link">
    <span class="md-ellipsis">
      get_meas_ids
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_objects" class="md-nav__link">
    <span class="md-ellipsis">
      get_objects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_wavelength" class="md-nav__link">
    <span class="md-ellipsis">
      get_wavelength
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__init__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.__init__--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.compute_JND" class="md-nav__link">
    <span class="md-ellipsis">
      compute_JND
    </span>
  </a>
  
    <nav class="md-nav" aria-label="compute_JND">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.compute_JND--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.compute_JND--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.compute_delta" class="md-nav__link">
    <span class="md-ellipsis">
      compute_delta
    </span>
  </a>
  
    <nav class="md-nav" aria-label="compute_delta">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.compute_delta--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.compute_delta--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.compute_fitting" class="md-nav__link">
    <span class="md-ellipsis">
      compute_fitting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="compute_fitting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.compute_fitting--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.compute_fitting--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.compute_mean" class="md-nav__link">
    <span class="md-ellipsis">
      compute_mean
    </span>
  </a>
  
    <nav class="md-nav" aria-label="compute_mean">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.compute_mean--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.compute_mean--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.compute_mean--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.compute_sp_derivate" class="md-nav__link">
    <span class="md-ellipsis">
      compute_sp_derivate
    </span>
  </a>
  
    <nav class="md-nav" aria-label="compute_sp_derivate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.compute_sp_derivate--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_Lab" class="md-nav__link">
    <span class="md-ellipsis">
      get_Lab
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_Lab">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_Lab--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_Lab--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_XYZ" class="md-nav__link">
    <span class="md-ellipsis">
      get_XYZ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_XYZ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_XYZ--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_XYZ--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_cielab" class="md-nav__link">
    <span class="md-ellipsis">
      get_cielab
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_cielab">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_cielab--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_cielab--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_data--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_data--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_doses" class="md-nav__link">
    <span class="md-ellipsis">
      get_doses
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_doses">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_doses--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_doses--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_illuminant" class="md-nav__link">
    <span class="md-ellipsis">
      get_illuminant
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_illuminant">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_illuminant--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_illuminant--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      get_metadata
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_metadata">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_metadata--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_metadata--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_observer" class="md-nav__link">
    <span class="md-ellipsis">
      get_observer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_observer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_observer--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_observer--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_sRGB" class="md-nav__link">
    <span class="md-ellipsis">
      get_sRGB
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_sRGB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_sRGB--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_sRGB--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_spectra" class="md-nav__link">
    <span class="md-ellipsis">
      get_spectra
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_spectra">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_spectra--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_spectra--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_xy" class="md-nav__link">
    <span class="md-ellipsis">
      get_xy
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_xy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_xy--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_xy--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plot_CIELAB" class="md-nav__link">
    <span class="md-ellipsis">
      plot_CIELAB
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plot_CIELAB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plot_CIELAB--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plot_CIELAB--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plot_bars" class="md-nav__link">
    <span class="md-ellipsis">
      plot_bars
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plot_bars">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plot_bars--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plot_delta" class="md-nav__link">
    <span class="md-ellipsis">
      plot_delta
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plot_delta">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plot_delta--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plot_sp" class="md-nav__link">
    <span class="md-ellipsis">
      plot_sp
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plot_sp">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plot_sp--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plot_sp--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plot_swatches_circle" class="md-nav__link">
    <span class="md-ellipsis">
      plot_swatches_circle
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plot_swatches_circle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plot_swatches_circle--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plot_swatches_circle--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plots" class="md-nav__link">
    <span class="md-ellipsis">
      plots
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plots">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plots--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.read_files" class="md-nav__link">
    <span class="md-ellipsis">
      read_files
    </span>
  </a>
  
    <nav class="md-nav" aria-label="read_files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.read_files--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.read_files--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.get_colorimetry_info" class="md-nav__link">
    <span class="md-ellipsis">
      get_colorimetry_info
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_colorimetry_info">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.get_colorimetry_info--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.get_config" class="md-nav__link">
    <span class="md-ellipsis">
      get_config
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_config">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.get_config--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.get_config--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.get_config_path" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_path
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.get_datasets" class="md-nav__link">
    <span class="md-ellipsis">
      get_datasets
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_datasets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.get_datasets--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.get_datasets--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.get_devices_info" class="md-nav__link">
    <span class="md-ellipsis">
      get_devices_info
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_devices_info">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.get_devices_info--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.get_exposure_conditions" class="md-nav__link">
    <span class="md-ellipsis">
      get_exposure_conditions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_exposure_conditions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.get_exposure_conditions--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.get_institution_info" class="md-nav__link">
    <span class="md-ellipsis">
      get_institution_info
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_institution_info">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.get_institution_info--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.get_light_dose_info" class="md-nav__link">
    <span class="md-ellipsis">
      get_light_dose_info
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_light_dose_info">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.get_light_dose_info--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.is_DB" class="md-nav__link">
    <span class="md-ellipsis">
      is_DB
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.process_rawdata" class="md-nav__link">
    <span class="md-ellipsis">
      process_rawdata
    </span>
  </a>
  
    <nav class="md-nav" aria-label="process_rawdata">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.process_rawdata--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.process_rawdata--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.reset_config" class="md-nav__link">
    <span class="md-ellipsis">
      reset_config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.set_DB" class="md-nav__link">
    <span class="md-ellipsis">
      set_DB
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.set_colorimetry_info" class="md-nav__link">
    <span class="md-ellipsis">
      set_colorimetry_info
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.set_devices_info" class="md-nav__link">
    <span class="md-ellipsis">
      set_devices_info
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.set_exposure_conditions" class="md-nav__link">
    <span class="md-ellipsis">
      set_exposure_conditions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.set_institution_info" class="md-nav__link">
    <span class="md-ellipsis">
      set_institution_info
    </span>
  </a>
  
    <nav class="md-nav" aria-label="set_institution_info">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.set_institution_info--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.set_light_dose" class="md-nav__link">
    <span class="md-ellipsis">
      set_light_dose
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>References</h1>

<h2 id="commands">Commands<a class="headerlink" href="#commands" title="Permanent link">&para;</a></h2>
<h3 id="datasets">Datasets<a class="headerlink" href="#datasets" title="Permanent link">&para;</a></h3>
<ul>
<li><code>get_datasets [MFT, rawfiles, BWS, stdev]</code> - Retrieve examples of data files.</li>
</ul>
<h3 id="databases-management">Databases management<a class="headerlink" href="#databases-management" title="Permanent link">&para;</a></h3>
<ul>
<li><code>create_DB [folder]</code> - Create two empty databases (projects and objects).</li>
<li><code>get_creators</code> - Retrieve a list of names corresponding to the persons that created the microfaded objects.</li>
<li><code>get_DB [db]</code> - Retrieve the databases.</li>
<li><code>get_institutions</code> - Retrieve a list of institutions owning the microfaded objects.</li>
<li><code>get_path_DB</code> - Retrieve the absolute path of the folder where the databases are stored.</li>
<li><code>get_persons</code> - Retrieve a list of persons that performed microfading analyses.</li>
<li><code>add_new_institution</code> - Add a new institution to the database.</li>
<li><code>add_new_person</code> - Add a new person to the list of persons doing microfading analyses.</li>
<li><code>add_new_project</code> - Add a new project to the database.</li>
<li><code>add_new_object</code> - Add a new object to the database.</li>
<li><code>update_DB_project [new, old]</code> - Modify or add a new parameter to the project database.</li>
<li><code>update_DB_object [new, old]</code> - Modify or add a new parameter to the object database.</li>
</ul>
<h3 id="data-processing">Data processing<a class="headerlink" href="#data-processing" title="Permanent link">&para;</a></h3>
<ul>
<li><code>process_rawdata [files, device]</code> - Process rawdata files into interim files.</li>
</ul>
<h3 id="mft-class">MFT class<a class="headerlink" href="#mft-class" title="Permanent link">&para;</a></h3>
<ul>
<li><code>data_points</code> - Select colourimetric values for one or multiple light dose values.</li>
</ul>


<div class="doc doc-object doc-module">



<a id="microfading.microfading"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="microfading.microfading.MFT" class="doc doc-heading">
            <code>MFT</code>


<a href="#microfading.microfading.MFT" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>object</code></p>


              <details class="quote">
                <summary>Source code in <code>microfading/microfading.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span>
<span class="normal">2082</span>
<span class="normal">2083</span>
<span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span>
<span class="normal">2088</span>
<span class="normal">2089</span>
<span class="normal">2090</span>
<span class="normal">2091</span>
<span class="normal">2092</span>
<span class="normal">2093</span>
<span class="normal">2094</span>
<span class="normal">2095</span>
<span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span>
<span class="normal">2099</span>
<span class="normal">2100</span>
<span class="normal">2101</span>
<span class="normal">2102</span>
<span class="normal">2103</span>
<span class="normal">2104</span>
<span class="normal">2105</span>
<span class="normal">2106</span>
<span class="normal">2107</span>
<span class="normal">2108</span>
<span class="normal">2109</span>
<span class="normal">2110</span>
<span class="normal">2111</span>
<span class="normal">2112</span>
<span class="normal">2113</span>
<span class="normal">2114</span>
<span class="normal">2115</span>
<span class="normal">2116</span>
<span class="normal">2117</span>
<span class="normal">2118</span>
<span class="normal">2119</span>
<span class="normal">2120</span>
<span class="normal">2121</span>
<span class="normal">2122</span>
<span class="normal">2123</span>
<span class="normal">2124</span>
<span class="normal">2125</span>
<span class="normal">2126</span>
<span class="normal">2127</span>
<span class="normal">2128</span>
<span class="normal">2129</span>
<span class="normal">2130</span>
<span class="normal">2131</span>
<span class="normal">2132</span>
<span class="normal">2133</span>
<span class="normal">2134</span>
<span class="normal">2135</span>
<span class="normal">2136</span>
<span class="normal">2137</span>
<span class="normal">2138</span>
<span class="normal">2139</span>
<span class="normal">2140</span>
<span class="normal">2141</span>
<span class="normal">2142</span>
<span class="normal">2143</span>
<span class="normal">2144</span>
<span class="normal">2145</span>
<span class="normal">2146</span>
<span class="normal">2147</span>
<span class="normal">2148</span>
<span class="normal">2149</span>
<span class="normal">2150</span>
<span class="normal">2151</span>
<span class="normal">2152</span>
<span class="normal">2153</span>
<span class="normal">2154</span>
<span class="normal">2155</span>
<span class="normal">2156</span>
<span class="normal">2157</span>
<span class="normal">2158</span>
<span class="normal">2159</span>
<span class="normal">2160</span>
<span class="normal">2161</span>
<span class="normal">2162</span>
<span class="normal">2163</span>
<span class="normal">2164</span>
<span class="normal">2165</span>
<span class="normal">2166</span>
<span class="normal">2167</span>
<span class="normal">2168</span>
<span class="normal">2169</span>
<span class="normal">2170</span>
<span class="normal">2171</span>
<span class="normal">2172</span>
<span class="normal">2173</span>
<span class="normal">2174</span>
<span class="normal">2175</span>
<span class="normal">2176</span>
<span class="normal">2177</span>
<span class="normal">2178</span>
<span class="normal">2179</span>
<span class="normal">2180</span>
<span class="normal">2181</span>
<span class="normal">2182</span>
<span class="normal">2183</span>
<span class="normal">2184</span>
<span class="normal">2185</span>
<span class="normal">2186</span>
<span class="normal">2187</span>
<span class="normal">2188</span>
<span class="normal">2189</span>
<span class="normal">2190</span>
<span class="normal">2191</span>
<span class="normal">2192</span>
<span class="normal">2193</span>
<span class="normal">2194</span>
<span class="normal">2195</span>
<span class="normal">2196</span>
<span class="normal">2197</span>
<span class="normal">2198</span>
<span class="normal">2199</span>
<span class="normal">2200</span>
<span class="normal">2201</span>
<span class="normal">2202</span>
<span class="normal">2203</span>
<span class="normal">2204</span>
<span class="normal">2205</span>
<span class="normal">2206</span>
<span class="normal">2207</span>
<span class="normal">2208</span>
<span class="normal">2209</span>
<span class="normal">2210</span>
<span class="normal">2211</span>
<span class="normal">2212</span>
<span class="normal">2213</span>
<span class="normal">2214</span>
<span class="normal">2215</span>
<span class="normal">2216</span>
<span class="normal">2217</span>
<span class="normal">2218</span>
<span class="normal">2219</span>
<span class="normal">2220</span>
<span class="normal">2221</span>
<span class="normal">2222</span>
<span class="normal">2223</span>
<span class="normal">2224</span>
<span class="normal">2225</span>
<span class="normal">2226</span>
<span class="normal">2227</span>
<span class="normal">2228</span>
<span class="normal">2229</span>
<span class="normal">2230</span>
<span class="normal">2231</span>
<span class="normal">2232</span>
<span class="normal">2233</span>
<span class="normal">2234</span>
<span class="normal">2235</span>
<span class="normal">2236</span>
<span class="normal">2237</span>
<span class="normal">2238</span>
<span class="normal">2239</span>
<span class="normal">2240</span>
<span class="normal">2241</span>
<span class="normal">2242</span>
<span class="normal">2243</span>
<span class="normal">2244</span>
<span class="normal">2245</span>
<span class="normal">2246</span>
<span class="normal">2247</span>
<span class="normal">2248</span>
<span class="normal">2249</span>
<span class="normal">2250</span>
<span class="normal">2251</span>
<span class="normal">2252</span>
<span class="normal">2253</span>
<span class="normal">2254</span>
<span class="normal">2255</span>
<span class="normal">2256</span>
<span class="normal">2257</span>
<span class="normal">2258</span>
<span class="normal">2259</span>
<span class="normal">2260</span>
<span class="normal">2261</span>
<span class="normal">2262</span>
<span class="normal">2263</span>
<span class="normal">2264</span>
<span class="normal">2265</span>
<span class="normal">2266</span>
<span class="normal">2267</span>
<span class="normal">2268</span>
<span class="normal">2269</span>
<span class="normal">2270</span>
<span class="normal">2271</span>
<span class="normal">2272</span>
<span class="normal">2273</span>
<span class="normal">2274</span>
<span class="normal">2275</span>
<span class="normal">2276</span>
<span class="normal">2277</span>
<span class="normal">2278</span>
<span class="normal">2279</span>
<span class="normal">2280</span>
<span class="normal">2281</span>
<span class="normal">2282</span>
<span class="normal">2283</span>
<span class="normal">2284</span>
<span class="normal">2285</span>
<span class="normal">2286</span>
<span class="normal">2287</span>
<span class="normal">2288</span>
<span class="normal">2289</span>
<span class="normal">2290</span>
<span class="normal">2291</span>
<span class="normal">2292</span>
<span class="normal">2293</span>
<span class="normal">2294</span>
<span class="normal">2295</span>
<span class="normal">2296</span>
<span class="normal">2297</span>
<span class="normal">2298</span>
<span class="normal">2299</span>
<span class="normal">2300</span>
<span class="normal">2301</span>
<span class="normal">2302</span>
<span class="normal">2303</span>
<span class="normal">2304</span>
<span class="normal">2305</span>
<span class="normal">2306</span>
<span class="normal">2307</span>
<span class="normal">2308</span>
<span class="normal">2309</span>
<span class="normal">2310</span>
<span class="normal">2311</span>
<span class="normal">2312</span>
<span class="normal">2313</span>
<span class="normal">2314</span>
<span class="normal">2315</span>
<span class="normal">2316</span>
<span class="normal">2317</span>
<span class="normal">2318</span>
<span class="normal">2319</span>
<span class="normal">2320</span>
<span class="normal">2321</span>
<span class="normal">2322</span>
<span class="normal">2323</span>
<span class="normal">2324</span>
<span class="normal">2325</span>
<span class="normal">2326</span>
<span class="normal">2327</span>
<span class="normal">2328</span>
<span class="normal">2329</span>
<span class="normal">2330</span>
<span class="normal">2331</span>
<span class="normal">2332</span>
<span class="normal">2333</span>
<span class="normal">2334</span>
<span class="normal">2335</span>
<span class="normal">2336</span>
<span class="normal">2337</span>
<span class="normal">2338</span>
<span class="normal">2339</span>
<span class="normal">2340</span>
<span class="normal">2341</span>
<span class="normal">2342</span>
<span class="normal">2343</span>
<span class="normal">2344</span>
<span class="normal">2345</span>
<span class="normal">2346</span>
<span class="normal">2347</span>
<span class="normal">2348</span>
<span class="normal">2349</span>
<span class="normal">2350</span>
<span class="normal">2351</span>
<span class="normal">2352</span>
<span class="normal">2353</span>
<span class="normal">2354</span>
<span class="normal">2355</span>
<span class="normal">2356</span>
<span class="normal">2357</span>
<span class="normal">2358</span>
<span class="normal">2359</span>
<span class="normal">2360</span>
<span class="normal">2361</span>
<span class="normal">2362</span>
<span class="normal">2363</span>
<span class="normal">2364</span>
<span class="normal">2365</span>
<span class="normal">2366</span>
<span class="normal">2367</span>
<span class="normal">2368</span>
<span class="normal">2369</span>
<span class="normal">2370</span>
<span class="normal">2371</span>
<span class="normal">2372</span>
<span class="normal">2373</span>
<span class="normal">2374</span>
<span class="normal">2375</span>
<span class="normal">2376</span>
<span class="normal">2377</span>
<span class="normal">2378</span>
<span class="normal">2379</span>
<span class="normal">2380</span>
<span class="normal">2381</span>
<span class="normal">2382</span>
<span class="normal">2383</span>
<span class="normal">2384</span>
<span class="normal">2385</span>
<span class="normal">2386</span>
<span class="normal">2387</span>
<span class="normal">2388</span>
<span class="normal">2389</span>
<span class="normal">2390</span>
<span class="normal">2391</span>
<span class="normal">2392</span>
<span class="normal">2393</span>
<span class="normal">2394</span>
<span class="normal">2395</span>
<span class="normal">2396</span>
<span class="normal">2397</span>
<span class="normal">2398</span>
<span class="normal">2399</span>
<span class="normal">2400</span>
<span class="normal">2401</span>
<span class="normal">2402</span>
<span class="normal">2403</span>
<span class="normal">2404</span>
<span class="normal">2405</span>
<span class="normal">2406</span>
<span class="normal">2407</span>
<span class="normal">2408</span>
<span class="normal">2409</span>
<span class="normal">2410</span>
<span class="normal">2411</span>
<span class="normal">2412</span>
<span class="normal">2413</span>
<span class="normal">2414</span>
<span class="normal">2415</span>
<span class="normal">2416</span>
<span class="normal">2417</span>
<span class="normal">2418</span>
<span class="normal">2419</span>
<span class="normal">2420</span>
<span class="normal">2421</span>
<span class="normal">2422</span>
<span class="normal">2423</span>
<span class="normal">2424</span>
<span class="normal">2425</span>
<span class="normal">2426</span>
<span class="normal">2427</span>
<span class="normal">2428</span>
<span class="normal">2429</span>
<span class="normal">2430</span>
<span class="normal">2431</span>
<span class="normal">2432</span>
<span class="normal">2433</span>
<span class="normal">2434</span>
<span class="normal">2435</span>
<span class="normal">2436</span>
<span class="normal">2437</span>
<span class="normal">2438</span>
<span class="normal">2439</span>
<span class="normal">2440</span>
<span class="normal">2441</span>
<span class="normal">2442</span>
<span class="normal">2443</span>
<span class="normal">2444</span>
<span class="normal">2445</span>
<span class="normal">2446</span>
<span class="normal">2447</span>
<span class="normal">2448</span>
<span class="normal">2449</span>
<span class="normal">2450</span>
<span class="normal">2451</span>
<span class="normal">2452</span>
<span class="normal">2453</span>
<span class="normal">2454</span>
<span class="normal">2455</span>
<span class="normal">2456</span>
<span class="normal">2457</span>
<span class="normal">2458</span>
<span class="normal">2459</span>
<span class="normal">2460</span>
<span class="normal">2461</span>
<span class="normal">2462</span>
<span class="normal">2463</span>
<span class="normal">2464</span>
<span class="normal">2465</span>
<span class="normal">2466</span>
<span class="normal">2467</span>
<span class="normal">2468</span>
<span class="normal">2469</span>
<span class="normal">2470</span>
<span class="normal">2471</span>
<span class="normal">2472</span>
<span class="normal">2473</span>
<span class="normal">2474</span>
<span class="normal">2475</span>
<span class="normal">2476</span>
<span class="normal">2477</span>
<span class="normal">2478</span>
<span class="normal">2479</span>
<span class="normal">2480</span>
<span class="normal">2481</span>
<span class="normal">2482</span>
<span class="normal">2483</span>
<span class="normal">2484</span>
<span class="normal">2485</span>
<span class="normal">2486</span>
<span class="normal">2487</span>
<span class="normal">2488</span>
<span class="normal">2489</span>
<span class="normal">2490</span>
<span class="normal">2491</span>
<span class="normal">2492</span>
<span class="normal">2493</span>
<span class="normal">2494</span>
<span class="normal">2495</span>
<span class="normal">2496</span>
<span class="normal">2497</span>
<span class="normal">2498</span>
<span class="normal">2499</span>
<span class="normal">2500</span>
<span class="normal">2501</span>
<span class="normal">2502</span>
<span class="normal">2503</span>
<span class="normal">2504</span>
<span class="normal">2505</span>
<span class="normal">2506</span>
<span class="normal">2507</span>
<span class="normal">2508</span>
<span class="normal">2509</span>
<span class="normal">2510</span>
<span class="normal">2511</span>
<span class="normal">2512</span>
<span class="normal">2513</span>
<span class="normal">2514</span>
<span class="normal">2515</span>
<span class="normal">2516</span>
<span class="normal">2517</span>
<span class="normal">2518</span>
<span class="normal">2519</span>
<span class="normal">2520</span>
<span class="normal">2521</span>
<span class="normal">2522</span>
<span class="normal">2523</span>
<span class="normal">2524</span>
<span class="normal">2525</span>
<span class="normal">2526</span>
<span class="normal">2527</span>
<span class="normal">2528</span>
<span class="normal">2529</span>
<span class="normal">2530</span>
<span class="normal">2531</span>
<span class="normal">2532</span>
<span class="normal">2533</span>
<span class="normal">2534</span>
<span class="normal">2535</span>
<span class="normal">2536</span>
<span class="normal">2537</span>
<span class="normal">2538</span>
<span class="normal">2539</span>
<span class="normal">2540</span>
<span class="normal">2541</span>
<span class="normal">2542</span>
<span class="normal">2543</span>
<span class="normal">2544</span>
<span class="normal">2545</span>
<span class="normal">2546</span>
<span class="normal">2547</span>
<span class="normal">2548</span>
<span class="normal">2549</span>
<span class="normal">2550</span>
<span class="normal">2551</span>
<span class="normal">2552</span>
<span class="normal">2553</span>
<span class="normal">2554</span>
<span class="normal">2555</span>
<span class="normal">2556</span>
<span class="normal">2557</span>
<span class="normal">2558</span>
<span class="normal">2559</span>
<span class="normal">2560</span>
<span class="normal">2561</span>
<span class="normal">2562</span>
<span class="normal">2563</span>
<span class="normal">2564</span>
<span class="normal">2565</span>
<span class="normal">2566</span>
<span class="normal">2567</span>
<span class="normal">2568</span>
<span class="normal">2569</span>
<span class="normal">2570</span>
<span class="normal">2571</span>
<span class="normal">2572</span>
<span class="normal">2573</span>
<span class="normal">2574</span>
<span class="normal">2575</span>
<span class="normal">2576</span>
<span class="normal">2577</span>
<span class="normal">2578</span>
<span class="normal">2579</span>
<span class="normal">2580</span>
<span class="normal">2581</span>
<span class="normal">2582</span>
<span class="normal">2583</span>
<span class="normal">2584</span>
<span class="normal">2585</span>
<span class="normal">2586</span>
<span class="normal">2587</span>
<span class="normal">2588</span>
<span class="normal">2589</span>
<span class="normal">2590</span>
<span class="normal">2591</span>
<span class="normal">2592</span>
<span class="normal">2593</span>
<span class="normal">2594</span>
<span class="normal">2595</span>
<span class="normal">2596</span>
<span class="normal">2597</span>
<span class="normal">2598</span>
<span class="normal">2599</span>
<span class="normal">2600</span>
<span class="normal">2601</span>
<span class="normal">2602</span>
<span class="normal">2603</span>
<span class="normal">2604</span>
<span class="normal">2605</span>
<span class="normal">2606</span>
<span class="normal">2607</span>
<span class="normal">2608</span>
<span class="normal">2609</span>
<span class="normal">2610</span>
<span class="normal">2611</span>
<span class="normal">2612</span>
<span class="normal">2613</span>
<span class="normal">2614</span>
<span class="normal">2615</span>
<span class="normal">2616</span>
<span class="normal">2617</span>
<span class="normal">2618</span>
<span class="normal">2619</span>
<span class="normal">2620</span>
<span class="normal">2621</span>
<span class="normal">2622</span>
<span class="normal">2623</span>
<span class="normal">2624</span>
<span class="normal">2625</span>
<span class="normal">2626</span>
<span class="normal">2627</span>
<span class="normal">2628</span>
<span class="normal">2629</span>
<span class="normal">2630</span>
<span class="normal">2631</span>
<span class="normal">2632</span>
<span class="normal">2633</span>
<span class="normal">2634</span>
<span class="normal">2635</span>
<span class="normal">2636</span>
<span class="normal">2637</span>
<span class="normal">2638</span>
<span class="normal">2639</span>
<span class="normal">2640</span>
<span class="normal">2641</span>
<span class="normal">2642</span>
<span class="normal">2643</span>
<span class="normal">2644</span>
<span class="normal">2645</span>
<span class="normal">2646</span>
<span class="normal">2647</span>
<span class="normal">2648</span>
<span class="normal">2649</span>
<span class="normal">2650</span>
<span class="normal">2651</span>
<span class="normal">2652</span>
<span class="normal">2653</span>
<span class="normal">2654</span>
<span class="normal">2655</span>
<span class="normal">2656</span>
<span class="normal">2657</span>
<span class="normal">2658</span>
<span class="normal">2659</span>
<span class="normal">2660</span>
<span class="normal">2661</span>
<span class="normal">2662</span>
<span class="normal">2663</span>
<span class="normal">2664</span>
<span class="normal">2665</span>
<span class="normal">2666</span>
<span class="normal">2667</span>
<span class="normal">2668</span>
<span class="normal">2669</span>
<span class="normal">2670</span>
<span class="normal">2671</span>
<span class="normal">2672</span>
<span class="normal">2673</span>
<span class="normal">2674</span>
<span class="normal">2675</span>
<span class="normal">2676</span>
<span class="normal">2677</span>
<span class="normal">2678</span>
<span class="normal">2679</span>
<span class="normal">2680</span>
<span class="normal">2681</span>
<span class="normal">2682</span>
<span class="normal">2683</span>
<span class="normal">2684</span>
<span class="normal">2685</span>
<span class="normal">2686</span>
<span class="normal">2687</span>
<span class="normal">2688</span>
<span class="normal">2689</span>
<span class="normal">2690</span>
<span class="normal">2691</span>
<span class="normal">2692</span>
<span class="normal">2693</span>
<span class="normal">2694</span>
<span class="normal">2695</span>
<span class="normal">2696</span>
<span class="normal">2697</span>
<span class="normal">2698</span>
<span class="normal">2699</span>
<span class="normal">2700</span>
<span class="normal">2701</span>
<span class="normal">2702</span>
<span class="normal">2703</span>
<span class="normal">2704</span>
<span class="normal">2705</span>
<span class="normal">2706</span>
<span class="normal">2707</span>
<span class="normal">2708</span>
<span class="normal">2709</span>
<span class="normal">2710</span>
<span class="normal">2711</span>
<span class="normal">2712</span>
<span class="normal">2713</span>
<span class="normal">2714</span>
<span class="normal">2715</span>
<span class="normal">2716</span>
<span class="normal">2717</span>
<span class="normal">2718</span>
<span class="normal">2719</span>
<span class="normal">2720</span>
<span class="normal">2721</span>
<span class="normal">2722</span>
<span class="normal">2723</span>
<span class="normal">2724</span>
<span class="normal">2725</span>
<span class="normal">2726</span>
<span class="normal">2727</span>
<span class="normal">2728</span>
<span class="normal">2729</span>
<span class="normal">2730</span>
<span class="normal">2731</span>
<span class="normal">2732</span>
<span class="normal">2733</span>
<span class="normal">2734</span>
<span class="normal">2735</span>
<span class="normal">2736</span>
<span class="normal">2737</span>
<span class="normal">2738</span>
<span class="normal">2739</span>
<span class="normal">2740</span>
<span class="normal">2741</span>
<span class="normal">2742</span>
<span class="normal">2743</span>
<span class="normal">2744</span>
<span class="normal">2745</span>
<span class="normal">2746</span>
<span class="normal">2747</span>
<span class="normal">2748</span>
<span class="normal">2749</span>
<span class="normal">2750</span>
<span class="normal">2751</span>
<span class="normal">2752</span>
<span class="normal">2753</span>
<span class="normal">2754</span>
<span class="normal">2755</span>
<span class="normal">2756</span>
<span class="normal">2757</span>
<span class="normal">2758</span>
<span class="normal">2759</span>
<span class="normal">2760</span>
<span class="normal">2761</span>
<span class="normal">2762</span>
<span class="normal">2763</span>
<span class="normal">2764</span>
<span class="normal">2765</span>
<span class="normal">2766</span>
<span class="normal">2767</span>
<span class="normal">2768</span>
<span class="normal">2769</span>
<span class="normal">2770</span>
<span class="normal">2771</span>
<span class="normal">2772</span>
<span class="normal">2773</span>
<span class="normal">2774</span>
<span class="normal">2775</span>
<span class="normal">2776</span>
<span class="normal">2777</span>
<span class="normal">2778</span>
<span class="normal">2779</span>
<span class="normal">2780</span>
<span class="normal">2781</span>
<span class="normal">2782</span>
<span class="normal">2783</span>
<span class="normal">2784</span>
<span class="normal">2785</span>
<span class="normal">2786</span>
<span class="normal">2787</span>
<span class="normal">2788</span>
<span class="normal">2789</span>
<span class="normal">2790</span>
<span class="normal">2791</span>
<span class="normal">2792</span>
<span class="normal">2793</span>
<span class="normal">2794</span>
<span class="normal">2795</span>
<span class="normal">2796</span>
<span class="normal">2797</span>
<span class="normal">2798</span>
<span class="normal">2799</span>
<span class="normal">2800</span>
<span class="normal">2801</span>
<span class="normal">2802</span>
<span class="normal">2803</span>
<span class="normal">2804</span>
<span class="normal">2805</span>
<span class="normal">2806</span>
<span class="normal">2807</span>
<span class="normal">2808</span>
<span class="normal">2809</span>
<span class="normal">2810</span>
<span class="normal">2811</span>
<span class="normal">2812</span>
<span class="normal">2813</span>
<span class="normal">2814</span>
<span class="normal">2815</span>
<span class="normal">2816</span>
<span class="normal">2817</span>
<span class="normal">2818</span>
<span class="normal">2819</span>
<span class="normal">2820</span>
<span class="normal">2821</span>
<span class="normal">2822</span>
<span class="normal">2823</span>
<span class="normal">2824</span>
<span class="normal">2825</span>
<span class="normal">2826</span>
<span class="normal">2827</span>
<span class="normal">2828</span>
<span class="normal">2829</span>
<span class="normal">2830</span>
<span class="normal">2831</span>
<span class="normal">2832</span>
<span class="normal">2833</span>
<span class="normal">2834</span>
<span class="normal">2835</span>
<span class="normal">2836</span>
<span class="normal">2837</span>
<span class="normal">2838</span>
<span class="normal">2839</span>
<span class="normal">2840</span>
<span class="normal">2841</span>
<span class="normal">2842</span>
<span class="normal">2843</span>
<span class="normal">2844</span>
<span class="normal">2845</span>
<span class="normal">2846</span>
<span class="normal">2847</span>
<span class="normal">2848</span>
<span class="normal">2849</span>
<span class="normal">2850</span>
<span class="normal">2851</span>
<span class="normal">2852</span>
<span class="normal">2853</span>
<span class="normal">2854</span>
<span class="normal">2855</span>
<span class="normal">2856</span>
<span class="normal">2857</span>
<span class="normal">2858</span>
<span class="normal">2859</span>
<span class="normal">2860</span>
<span class="normal">2861</span>
<span class="normal">2862</span>
<span class="normal">2863</span>
<span class="normal">2864</span>
<span class="normal">2865</span>
<span class="normal">2866</span>
<span class="normal">2867</span>
<span class="normal">2868</span>
<span class="normal">2869</span>
<span class="normal">2870</span>
<span class="normal">2871</span>
<span class="normal">2872</span>
<span class="normal">2873</span>
<span class="normal">2874</span>
<span class="normal">2875</span>
<span class="normal">2876</span>
<span class="normal">2877</span>
<span class="normal">2878</span>
<span class="normal">2879</span>
<span class="normal">2880</span>
<span class="normal">2881</span>
<span class="normal">2882</span>
<span class="normal">2883</span>
<span class="normal">2884</span>
<span class="normal">2885</span>
<span class="normal">2886</span>
<span class="normal">2887</span>
<span class="normal">2888</span>
<span class="normal">2889</span>
<span class="normal">2890</span>
<span class="normal">2891</span>
<span class="normal">2892</span>
<span class="normal">2893</span>
<span class="normal">2894</span>
<span class="normal">2895</span>
<span class="normal">2896</span>
<span class="normal">2897</span>
<span class="normal">2898</span>
<span class="normal">2899</span>
<span class="normal">2900</span>
<span class="normal">2901</span>
<span class="normal">2902</span>
<span class="normal">2903</span>
<span class="normal">2904</span>
<span class="normal">2905</span>
<span class="normal">2906</span>
<span class="normal">2907</span>
<span class="normal">2908</span>
<span class="normal">2909</span>
<span class="normal">2910</span>
<span class="normal">2911</span>
<span class="normal">2912</span>
<span class="normal">2913</span>
<span class="normal">2914</span>
<span class="normal">2915</span>
<span class="normal">2916</span>
<span class="normal">2917</span>
<span class="normal">2918</span>
<span class="normal">2919</span>
<span class="normal">2920</span>
<span class="normal">2921</span>
<span class="normal">2922</span>
<span class="normal">2923</span>
<span class="normal">2924</span>
<span class="normal">2925</span>
<span class="normal">2926</span>
<span class="normal">2927</span>
<span class="normal">2928</span>
<span class="normal">2929</span>
<span class="normal">2930</span>
<span class="normal">2931</span>
<span class="normal">2932</span>
<span class="normal">2933</span>
<span class="normal">2934</span>
<span class="normal">2935</span>
<span class="normal">2936</span>
<span class="normal">2937</span>
<span class="normal">2938</span>
<span class="normal">2939</span>
<span class="normal">2940</span>
<span class="normal">2941</span>
<span class="normal">2942</span>
<span class="normal">2943</span>
<span class="normal">2944</span>
<span class="normal">2945</span>
<span class="normal">2946</span>
<span class="normal">2947</span>
<span class="normal">2948</span>
<span class="normal">2949</span>
<span class="normal">2950</span>
<span class="normal">2951</span>
<span class="normal">2952</span>
<span class="normal">2953</span>
<span class="normal">2954</span>
<span class="normal">2955</span>
<span class="normal">2956</span>
<span class="normal">2957</span>
<span class="normal">2958</span>
<span class="normal">2959</span>
<span class="normal">2960</span>
<span class="normal">2961</span>
<span class="normal">2962</span>
<span class="normal">2963</span>
<span class="normal">2964</span>
<span class="normal">2965</span>
<span class="normal">2966</span>
<span class="normal">2967</span>
<span class="normal">2968</span>
<span class="normal">2969</span>
<span class="normal">2970</span>
<span class="normal">2971</span>
<span class="normal">2972</span>
<span class="normal">2973</span>
<span class="normal">2974</span>
<span class="normal">2975</span>
<span class="normal">2976</span>
<span class="normal">2977</span>
<span class="normal">2978</span>
<span class="normal">2979</span>
<span class="normal">2980</span>
<span class="normal">2981</span>
<span class="normal">2982</span>
<span class="normal">2983</span>
<span class="normal">2984</span>
<span class="normal">2985</span>
<span class="normal">2986</span>
<span class="normal">2987</span>
<span class="normal">2988</span>
<span class="normal">2989</span>
<span class="normal">2990</span>
<span class="normal">2991</span>
<span class="normal">2992</span>
<span class="normal">2993</span>
<span class="normal">2994</span>
<span class="normal">2995</span>
<span class="normal">2996</span>
<span class="normal">2997</span>
<span class="normal">2998</span>
<span class="normal">2999</span>
<span class="normal">3000</span>
<span class="normal">3001</span>
<span class="normal">3002</span>
<span class="normal">3003</span>
<span class="normal">3004</span>
<span class="normal">3005</span>
<span class="normal">3006</span>
<span class="normal">3007</span>
<span class="normal">3008</span>
<span class="normal">3009</span>
<span class="normal">3010</span>
<span class="normal">3011</span>
<span class="normal">3012</span>
<span class="normal">3013</span>
<span class="normal">3014</span>
<span class="normal">3015</span>
<span class="normal">3016</span>
<span class="normal">3017</span>
<span class="normal">3018</span>
<span class="normal">3019</span>
<span class="normal">3020</span>
<span class="normal">3021</span>
<span class="normal">3022</span>
<span class="normal">3023</span>
<span class="normal">3024</span>
<span class="normal">3025</span>
<span class="normal">3026</span>
<span class="normal">3027</span>
<span class="normal">3028</span>
<span class="normal">3029</span>
<span class="normal">3030</span>
<span class="normal">3031</span>
<span class="normal">3032</span>
<span class="normal">3033</span>
<span class="normal">3034</span>
<span class="normal">3035</span>
<span class="normal">3036</span>
<span class="normal">3037</span>
<span class="normal">3038</span>
<span class="normal">3039</span>
<span class="normal">3040</span>
<span class="normal">3041</span>
<span class="normal">3042</span>
<span class="normal">3043</span>
<span class="normal">3044</span>
<span class="normal">3045</span>
<span class="normal">3046</span>
<span class="normal">3047</span>
<span class="normal">3048</span>
<span class="normal">3049</span>
<span class="normal">3050</span>
<span class="normal">3051</span>
<span class="normal">3052</span>
<span class="normal">3053</span>
<span class="normal">3054</span>
<span class="normal">3055</span>
<span class="normal">3056</span>
<span class="normal">3057</span>
<span class="normal">3058</span>
<span class="normal">3059</span>
<span class="normal">3060</span>
<span class="normal">3061</span>
<span class="normal">3062</span>
<span class="normal">3063</span>
<span class="normal">3064</span>
<span class="normal">3065</span>
<span class="normal">3066</span>
<span class="normal">3067</span>
<span class="normal">3068</span>
<span class="normal">3069</span>
<span class="normal">3070</span>
<span class="normal">3071</span>
<span class="normal">3072</span>
<span class="normal">3073</span>
<span class="normal">3074</span>
<span class="normal">3075</span>
<span class="normal">3076</span>
<span class="normal">3077</span>
<span class="normal">3078</span>
<span class="normal">3079</span>
<span class="normal">3080</span>
<span class="normal">3081</span>
<span class="normal">3082</span>
<span class="normal">3083</span>
<span class="normal">3084</span>
<span class="normal">3085</span>
<span class="normal">3086</span>
<span class="normal">3087</span>
<span class="normal">3088</span>
<span class="normal">3089</span>
<span class="normal">3090</span>
<span class="normal">3091</span>
<span class="normal">3092</span>
<span class="normal">3093</span>
<span class="normal">3094</span>
<span class="normal">3095</span>
<span class="normal">3096</span>
<span class="normal">3097</span>
<span class="normal">3098</span>
<span class="normal">3099</span>
<span class="normal">3100</span>
<span class="normal">3101</span>
<span class="normal">3102</span>
<span class="normal">3103</span>
<span class="normal">3104</span>
<span class="normal">3105</span>
<span class="normal">3106</span>
<span class="normal">3107</span>
<span class="normal">3108</span>
<span class="normal">3109</span>
<span class="normal">3110</span>
<span class="normal">3111</span>
<span class="normal">3112</span>
<span class="normal">3113</span>
<span class="normal">3114</span>
<span class="normal">3115</span>
<span class="normal">3116</span>
<span class="normal">3117</span>
<span class="normal">3118</span>
<span class="normal">3119</span>
<span class="normal">3120</span>
<span class="normal">3121</span>
<span class="normal">3122</span>
<span class="normal">3123</span>
<span class="normal">3124</span>
<span class="normal">3125</span>
<span class="normal">3126</span>
<span class="normal">3127</span>
<span class="normal">3128</span>
<span class="normal">3129</span>
<span class="normal">3130</span>
<span class="normal">3131</span>
<span class="normal">3132</span>
<span class="normal">3133</span>
<span class="normal">3134</span>
<span class="normal">3135</span>
<span class="normal">3136</span>
<span class="normal">3137</span>
<span class="normal">3138</span>
<span class="normal">3139</span>
<span class="normal">3140</span>
<span class="normal">3141</span>
<span class="normal">3142</span>
<span class="normal">3143</span>
<span class="normal">3144</span>
<span class="normal">3145</span>
<span class="normal">3146</span>
<span class="normal">3147</span>
<span class="normal">3148</span>
<span class="normal">3149</span>
<span class="normal">3150</span>
<span class="normal">3151</span>
<span class="normal">3152</span>
<span class="normal">3153</span>
<span class="normal">3154</span>
<span class="normal">3155</span>
<span class="normal">3156</span>
<span class="normal">3157</span>
<span class="normal">3158</span>
<span class="normal">3159</span>
<span class="normal">3160</span>
<span class="normal">3161</span>
<span class="normal">3162</span>
<span class="normal">3163</span>
<span class="normal">3164</span>
<span class="normal">3165</span>
<span class="normal">3166</span>
<span class="normal">3167</span>
<span class="normal">3168</span>
<span class="normal">3169</span>
<span class="normal">3170</span>
<span class="normal">3171</span>
<span class="normal">3172</span>
<span class="normal">3173</span>
<span class="normal">3174</span>
<span class="normal">3175</span>
<span class="normal">3176</span>
<span class="normal">3177</span>
<span class="normal">3178</span>
<span class="normal">3179</span>
<span class="normal">3180</span>
<span class="normal">3181</span>
<span class="normal">3182</span>
<span class="normal">3183</span>
<span class="normal">3184</span>
<span class="normal">3185</span>
<span class="normal">3186</span>
<span class="normal">3187</span>
<span class="normal">3188</span>
<span class="normal">3189</span>
<span class="normal">3190</span>
<span class="normal">3191</span>
<span class="normal">3192</span>
<span class="normal">3193</span>
<span class="normal">3194</span>
<span class="normal">3195</span>
<span class="normal">3196</span>
<span class="normal">3197</span>
<span class="normal">3198</span>
<span class="normal">3199</span>
<span class="normal">3200</span>
<span class="normal">3201</span>
<span class="normal">3202</span>
<span class="normal">3203</span>
<span class="normal">3204</span>
<span class="normal">3205</span>
<span class="normal">3206</span>
<span class="normal">3207</span>
<span class="normal">3208</span>
<span class="normal">3209</span>
<span class="normal">3210</span>
<span class="normal">3211</span>
<span class="normal">3212</span>
<span class="normal">3213</span>
<span class="normal">3214</span>
<span class="normal">3215</span>
<span class="normal">3216</span>
<span class="normal">3217</span>
<span class="normal">3218</span>
<span class="normal">3219</span>
<span class="normal">3220</span>
<span class="normal">3221</span>
<span class="normal">3222</span>
<span class="normal">3223</span>
<span class="normal">3224</span>
<span class="normal">3225</span>
<span class="normal">3226</span>
<span class="normal">3227</span>
<span class="normal">3228</span>
<span class="normal">3229</span>
<span class="normal">3230</span>
<span class="normal">3231</span>
<span class="normal">3232</span>
<span class="normal">3233</span>
<span class="normal">3234</span>
<span class="normal">3235</span>
<span class="normal">3236</span>
<span class="normal">3237</span>
<span class="normal">3238</span>
<span class="normal">3239</span>
<span class="normal">3240</span>
<span class="normal">3241</span>
<span class="normal">3242</span>
<span class="normal">3243</span>
<span class="normal">3244</span>
<span class="normal">3245</span>
<span class="normal">3246</span>
<span class="normal">3247</span>
<span class="normal">3248</span>
<span class="normal">3249</span>
<span class="normal">3250</span>
<span class="normal">3251</span>
<span class="normal">3252</span>
<span class="normal">3253</span>
<span class="normal">3254</span>
<span class="normal">3255</span>
<span class="normal">3256</span>
<span class="normal">3257</span>
<span class="normal">3258</span>
<span class="normal">3259</span>
<span class="normal">3260</span>
<span class="normal">3261</span>
<span class="normal">3262</span>
<span class="normal">3263</span>
<span class="normal">3264</span>
<span class="normal">3265</span>
<span class="normal">3266</span>
<span class="normal">3267</span>
<span class="normal">3268</span>
<span class="normal">3269</span>
<span class="normal">3270</span>
<span class="normal">3271</span>
<span class="normal">3272</span>
<span class="normal">3273</span>
<span class="normal">3274</span>
<span class="normal">3275</span>
<span class="normal">3276</span>
<span class="normal">3277</span>
<span class="normal">3278</span>
<span class="normal">3279</span>
<span class="normal">3280</span>
<span class="normal">3281</span>
<span class="normal">3282</span>
<span class="normal">3283</span>
<span class="normal">3284</span>
<span class="normal">3285</span>
<span class="normal">3286</span>
<span class="normal">3287</span>
<span class="normal">3288</span>
<span class="normal">3289</span>
<span class="normal">3290</span>
<span class="normal">3291</span>
<span class="normal">3292</span>
<span class="normal">3293</span>
<span class="normal">3294</span>
<span class="normal">3295</span>
<span class="normal">3296</span>
<span class="normal">3297</span>
<span class="normal">3298</span>
<span class="normal">3299</span>
<span class="normal">3300</span>
<span class="normal">3301</span>
<span class="normal">3302</span>
<span class="normal">3303</span>
<span class="normal">3304</span>
<span class="normal">3305</span>
<span class="normal">3306</span>
<span class="normal">3307</span>
<span class="normal">3308</span>
<span class="normal">3309</span>
<span class="normal">3310</span>
<span class="normal">3311</span>
<span class="normal">3312</span>
<span class="normal">3313</span>
<span class="normal">3314</span>
<span class="normal">3315</span>
<span class="normal">3316</span>
<span class="normal">3317</span>
<span class="normal">3318</span>
<span class="normal">3319</span>
<span class="normal">3320</span>
<span class="normal">3321</span>
<span class="normal">3322</span>
<span class="normal">3323</span>
<span class="normal">3324</span>
<span class="normal">3325</span>
<span class="normal">3326</span>
<span class="normal">3327</span>
<span class="normal">3328</span>
<span class="normal">3329</span>
<span class="normal">3330</span>
<span class="normal">3331</span>
<span class="normal">3332</span>
<span class="normal">3333</span>
<span class="normal">3334</span>
<span class="normal">3335</span>
<span class="normal">3336</span>
<span class="normal">3337</span>
<span class="normal">3338</span>
<span class="normal">3339</span>
<span class="normal">3340</span>
<span class="normal">3341</span>
<span class="normal">3342</span>
<span class="normal">3343</span>
<span class="normal">3344</span>
<span class="normal">3345</span>
<span class="normal">3346</span>
<span class="normal">3347</span>
<span class="normal">3348</span>
<span class="normal">3349</span>
<span class="normal">3350</span>
<span class="normal">3351</span>
<span class="normal">3352</span>
<span class="normal">3353</span>
<span class="normal">3354</span>
<span class="normal">3355</span>
<span class="normal">3356</span>
<span class="normal">3357</span>
<span class="normal">3358</span>
<span class="normal">3359</span>
<span class="normal">3360</span>
<span class="normal">3361</span>
<span class="normal">3362</span>
<span class="normal">3363</span>
<span class="normal">3364</span>
<span class="normal">3365</span>
<span class="normal">3366</span>
<span class="normal">3367</span>
<span class="normal">3368</span>
<span class="normal">3369</span>
<span class="normal">3370</span>
<span class="normal">3371</span>
<span class="normal">3372</span>
<span class="normal">3373</span>
<span class="normal">3374</span>
<span class="normal">3375</span>
<span class="normal">3376</span>
<span class="normal">3377</span>
<span class="normal">3378</span>
<span class="normal">3379</span>
<span class="normal">3380</span>
<span class="normal">3381</span>
<span class="normal">3382</span>
<span class="normal">3383</span>
<span class="normal">3384</span>
<span class="normal">3385</span>
<span class="normal">3386</span>
<span class="normal">3387</span>
<span class="normal">3388</span>
<span class="normal">3389</span>
<span class="normal">3390</span>
<span class="normal">3391</span>
<span class="normal">3392</span>
<span class="normal">3393</span>
<span class="normal">3394</span>
<span class="normal">3395</span>
<span class="normal">3396</span>
<span class="normal">3397</span>
<span class="normal">3398</span>
<span class="normal">3399</span>
<span class="normal">3400</span>
<span class="normal">3401</span>
<span class="normal">3402</span>
<span class="normal">3403</span>
<span class="normal">3404</span>
<span class="normal">3405</span>
<span class="normal">3406</span>
<span class="normal">3407</span>
<span class="normal">3408</span>
<span class="normal">3409</span>
<span class="normal">3410</span>
<span class="normal">3411</span>
<span class="normal">3412</span>
<span class="normal">3413</span>
<span class="normal">3414</span>
<span class="normal">3415</span>
<span class="normal">3416</span>
<span class="normal">3417</span>
<span class="normal">3418</span>
<span class="normal">3419</span>
<span class="normal">3420</span>
<span class="normal">3421</span>
<span class="normal">3422</span>
<span class="normal">3423</span>
<span class="normal">3424</span>
<span class="normal">3425</span>
<span class="normal">3426</span>
<span class="normal">3427</span>
<span class="normal">3428</span>
<span class="normal">3429</span>
<span class="normal">3430</span>
<span class="normal">3431</span>
<span class="normal">3432</span>
<span class="normal">3433</span>
<span class="normal">3434</span>
<span class="normal">3435</span>
<span class="normal">3436</span>
<span class="normal">3437</span>
<span class="normal">3438</span>
<span class="normal">3439</span>
<span class="normal">3440</span>
<span class="normal">3441</span>
<span class="normal">3442</span>
<span class="normal">3443</span>
<span class="normal">3444</span>
<span class="normal">3445</span>
<span class="normal">3446</span>
<span class="normal">3447</span>
<span class="normal">3448</span>
<span class="normal">3449</span>
<span class="normal">3450</span>
<span class="normal">3451</span>
<span class="normal">3452</span>
<span class="normal">3453</span>
<span class="normal">3454</span>
<span class="normal">3455</span>
<span class="normal">3456</span>
<span class="normal">3457</span>
<span class="normal">3458</span>
<span class="normal">3459</span>
<span class="normal">3460</span>
<span class="normal">3461</span>
<span class="normal">3462</span>
<span class="normal">3463</span>
<span class="normal">3464</span>
<span class="normal">3465</span>
<span class="normal">3466</span>
<span class="normal">3467</span>
<span class="normal">3468</span>
<span class="normal">3469</span>
<span class="normal">3470</span>
<span class="normal">3471</span>
<span class="normal">3472</span>
<span class="normal">3473</span>
<span class="normal">3474</span>
<span class="normal">3475</span>
<span class="normal">3476</span>
<span class="normal">3477</span>
<span class="normal">3478</span>
<span class="normal">3479</span>
<span class="normal">3480</span>
<span class="normal">3481</span>
<span class="normal">3482</span>
<span class="normal">3483</span>
<span class="normal">3484</span>
<span class="normal">3485</span>
<span class="normal">3486</span>
<span class="normal">3487</span>
<span class="normal">3488</span>
<span class="normal">3489</span>
<span class="normal">3490</span>
<span class="normal">3491</span>
<span class="normal">3492</span>
<span class="normal">3493</span>
<span class="normal">3494</span>
<span class="normal">3495</span>
<span class="normal">3496</span>
<span class="normal">3497</span>
<span class="normal">3498</span>
<span class="normal">3499</span>
<span class="normal">3500</span>
<span class="normal">3501</span>
<span class="normal">3502</span>
<span class="normal">3503</span>
<span class="normal">3504</span>
<span class="normal">3505</span>
<span class="normal">3506</span>
<span class="normal">3507</span>
<span class="normal">3508</span>
<span class="normal">3509</span>
<span class="normal">3510</span>
<span class="normal">3511</span>
<span class="normal">3512</span>
<span class="normal">3513</span>
<span class="normal">3514</span>
<span class="normal">3515</span>
<span class="normal">3516</span>
<span class="normal">3517</span>
<span class="normal">3518</span>
<span class="normal">3519</span>
<span class="normal">3520</span>
<span class="normal">3521</span>
<span class="normal">3522</span>
<span class="normal">3523</span>
<span class="normal">3524</span>
<span class="normal">3525</span>
<span class="normal">3526</span>
<span class="normal">3527</span>
<span class="normal">3528</span>
<span class="normal">3529</span>
<span class="normal">3530</span>
<span class="normal">3531</span>
<span class="normal">3532</span>
<span class="normal">3533</span>
<span class="normal">3534</span>
<span class="normal">3535</span>
<span class="normal">3536</span>
<span class="normal">3537</span>
<span class="normal">3538</span>
<span class="normal">3539</span>
<span class="normal">3540</span>
<span class="normal">3541</span>
<span class="normal">3542</span>
<span class="normal">3543</span>
<span class="normal">3544</span>
<span class="normal">3545</span>
<span class="normal">3546</span>
<span class="normal">3547</span>
<span class="normal">3548</span>
<span class="normal">3549</span>
<span class="normal">3550</span>
<span class="normal">3551</span>
<span class="normal">3552</span>
<span class="normal">3553</span>
<span class="normal">3554</span>
<span class="normal">3555</span>
<span class="normal">3556</span>
<span class="normal">3557</span>
<span class="normal">3558</span>
<span class="normal">3559</span>
<span class="normal">3560</span>
<span class="normal">3561</span>
<span class="normal">3562</span>
<span class="normal">3563</span>
<span class="normal">3564</span>
<span class="normal">3565</span>
<span class="normal">3566</span>
<span class="normal">3567</span>
<span class="normal">3568</span>
<span class="normal">3569</span>
<span class="normal">3570</span>
<span class="normal">3571</span>
<span class="normal">3572</span>
<span class="normal">3573</span>
<span class="normal">3574</span>
<span class="normal">3575</span>
<span class="normal">3576</span>
<span class="normal">3577</span>
<span class="normal">3578</span>
<span class="normal">3579</span>
<span class="normal">3580</span>
<span class="normal">3581</span>
<span class="normal">3582</span>
<span class="normal">3583</span>
<span class="normal">3584</span>
<span class="normal">3585</span>
<span class="normal">3586</span>
<span class="normal">3587</span>
<span class="normal">3588</span>
<span class="normal">3589</span>
<span class="normal">3590</span>
<span class="normal">3591</span>
<span class="normal">3592</span>
<span class="normal">3593</span>
<span class="normal">3594</span>
<span class="normal">3595</span>
<span class="normal">3596</span>
<span class="normal">3597</span>
<span class="normal">3598</span>
<span class="normal">3599</span>
<span class="normal">3600</span>
<span class="normal">3601</span>
<span class="normal">3602</span>
<span class="normal">3603</span>
<span class="normal">3604</span>
<span class="normal">3605</span>
<span class="normal">3606</span>
<span class="normal">3607</span>
<span class="normal">3608</span>
<span class="normal">3609</span>
<span class="normal">3610</span>
<span class="normal">3611</span>
<span class="normal">3612</span>
<span class="normal">3613</span>
<span class="normal">3614</span>
<span class="normal">3615</span>
<span class="normal">3616</span>
<span class="normal">3617</span>
<span class="normal">3618</span>
<span class="normal">3619</span>
<span class="normal">3620</span>
<span class="normal">3621</span>
<span class="normal">3622</span>
<span class="normal">3623</span>
<span class="normal">3624</span>
<span class="normal">3625</span>
<span class="normal">3626</span>
<span class="normal">3627</span>
<span class="normal">3628</span>
<span class="normal">3629</span>
<span class="normal">3630</span>
<span class="normal">3631</span>
<span class="normal">3632</span>
<span class="normal">3633</span>
<span class="normal">3634</span>
<span class="normal">3635</span>
<span class="normal">3636</span>
<span class="normal">3637</span>
<span class="normal">3638</span>
<span class="normal">3639</span>
<span class="normal">3640</span>
<span class="normal">3641</span>
<span class="normal">3642</span>
<span class="normal">3643</span>
<span class="normal">3644</span>
<span class="normal">3645</span>
<span class="normal">3646</span>
<span class="normal">3647</span>
<span class="normal">3648</span>
<span class="normal">3649</span>
<span class="normal">3650</span>
<span class="normal">3651</span>
<span class="normal">3652</span>
<span class="normal">3653</span>
<span class="normal">3654</span>
<span class="normal">3655</span>
<span class="normal">3656</span>
<span class="normal">3657</span>
<span class="normal">3658</span>
<span class="normal">3659</span>
<span class="normal">3660</span>
<span class="normal">3661</span>
<span class="normal">3662</span>
<span class="normal">3663</span>
<span class="normal">3664</span>
<span class="normal">3665</span>
<span class="normal">3666</span>
<span class="normal">3667</span>
<span class="normal">3668</span>
<span class="normal">3669</span>
<span class="normal">3670</span>
<span class="normal">3671</span>
<span class="normal">3672</span>
<span class="normal">3673</span>
<span class="normal">3674</span>
<span class="normal">3675</span>
<span class="normal">3676</span>
<span class="normal">3677</span>
<span class="normal">3678</span>
<span class="normal">3679</span>
<span class="normal">3680</span>
<span class="normal">3681</span>
<span class="normal">3682</span>
<span class="normal">3683</span>
<span class="normal">3684</span>
<span class="normal">3685</span>
<span class="normal">3686</span>
<span class="normal">3687</span>
<span class="normal">3688</span>
<span class="normal">3689</span>
<span class="normal">3690</span>
<span class="normal">3691</span>
<span class="normal">3692</span>
<span class="normal">3693</span>
<span class="normal">3694</span>
<span class="normal">3695</span>
<span class="normal">3696</span>
<span class="normal">3697</span>
<span class="normal">3698</span>
<span class="normal">3699</span>
<span class="normal">3700</span>
<span class="normal">3701</span>
<span class="normal">3702</span>
<span class="normal">3703</span>
<span class="normal">3704</span>
<span class="normal">3705</span>
<span class="normal">3706</span>
<span class="normal">3707</span>
<span class="normal">3708</span>
<span class="normal">3709</span>
<span class="normal">3710</span>
<span class="normal">3711</span>
<span class="normal">3712</span>
<span class="normal">3713</span>
<span class="normal">3714</span>
<span class="normal">3715</span>
<span class="normal">3716</span>
<span class="normal">3717</span>
<span class="normal">3718</span>
<span class="normal">3719</span>
<span class="normal">3720</span>
<span class="normal">3721</span>
<span class="normal">3722</span>
<span class="normal">3723</span>
<span class="normal">3724</span>
<span class="normal">3725</span>
<span class="normal">3726</span>
<span class="normal">3727</span>
<span class="normal">3728</span>
<span class="normal">3729</span>
<span class="normal">3730</span>
<span class="normal">3731</span>
<span class="normal">3732</span>
<span class="normal">3733</span>
<span class="normal">3734</span>
<span class="normal">3735</span>
<span class="normal">3736</span>
<span class="normal">3737</span>
<span class="normal">3738</span>
<span class="normal">3739</span>
<span class="normal">3740</span>
<span class="normal">3741</span>
<span class="normal">3742</span>
<span class="normal">3743</span>
<span class="normal">3744</span>
<span class="normal">3745</span>
<span class="normal">3746</span>
<span class="normal">3747</span>
<span class="normal">3748</span>
<span class="normal">3749</span>
<span class="normal">3750</span>
<span class="normal">3751</span>
<span class="normal">3752</span>
<span class="normal">3753</span>
<span class="normal">3754</span>
<span class="normal">3755</span>
<span class="normal">3756</span>
<span class="normal">3757</span>
<span class="normal">3758</span>
<span class="normal">3759</span>
<span class="normal">3760</span>
<span class="normal">3761</span>
<span class="normal">3762</span>
<span class="normal">3763</span>
<span class="normal">3764</span>
<span class="normal">3765</span>
<span class="normal">3766</span>
<span class="normal">3767</span>
<span class="normal">3768</span>
<span class="normal">3769</span>
<span class="normal">3770</span>
<span class="normal">3771</span>
<span class="normal">3772</span>
<span class="normal">3773</span>
<span class="normal">3774</span>
<span class="normal">3775</span>
<span class="normal">3776</span>
<span class="normal">3777</span>
<span class="normal">3778</span>
<span class="normal">3779</span>
<span class="normal">3780</span>
<span class="normal">3781</span>
<span class="normal">3782</span>
<span class="normal">3783</span>
<span class="normal">3784</span>
<span class="normal">3785</span>
<span class="normal">3786</span>
<span class="normal">3787</span>
<span class="normal">3788</span>
<span class="normal">3789</span>
<span class="normal">3790</span>
<span class="normal">3791</span>
<span class="normal">3792</span>
<span class="normal">3793</span>
<span class="normal">3794</span>
<span class="normal">3795</span>
<span class="normal">3796</span>
<span class="normal">3797</span>
<span class="normal">3798</span>
<span class="normal">3799</span>
<span class="normal">3800</span>
<span class="normal">3801</span>
<span class="normal">3802</span>
<span class="normal">3803</span>
<span class="normal">3804</span>
<span class="normal">3805</span>
<span class="normal">3806</span>
<span class="normal">3807</span>
<span class="normal">3808</span>
<span class="normal">3809</span>
<span class="normal">3810</span>
<span class="normal">3811</span>
<span class="normal">3812</span>
<span class="normal">3813</span>
<span class="normal">3814</span>
<span class="normal">3815</span>
<span class="normal">3816</span>
<span class="normal">3817</span>
<span class="normal">3818</span>
<span class="normal">3819</span>
<span class="normal">3820</span>
<span class="normal">3821</span>
<span class="normal">3822</span>
<span class="normal">3823</span>
<span class="normal">3824</span>
<span class="normal">3825</span>
<span class="normal">3826</span>
<span class="normal">3827</span>
<span class="normal">3828</span>
<span class="normal">3829</span>
<span class="normal">3830</span>
<span class="normal">3831</span>
<span class="normal">3832</span>
<span class="normal">3833</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">MFT</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">files</span><span class="p">:</span><span class="nb">list</span><span class="p">,</span> <span class="n">BWS</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Instantiate a Microfading (MFT) class object in order to manipulate and visualize microfading analysis data.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        files : list</span>
<span class="sd">            A list of string, where each string corresponds to the absolute path of text or csv file that contains the data and metadata of a single microfading measurement. The content of the file requires a specific structure, for which an example can be found in &quot;datasets&quot; folder of the microfading package folder (Use the get_datasets function to retrieve the precise location of such example files). If the file structure is not respected, the script will not be able to properly read the file and access its content.</span>

<span class="sd">        BWS : bool, optional</span>
<span class="sd">            When False, it ignores the measurements performed on BWS samples if included. </span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">files</span> <span class="o">=</span> <span class="n">files</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">BWS</span> <span class="o">=</span> <span class="n">BWS</span>        

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">BWS</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span> <span class="k">if</span> <span class="s1">&#39;BW&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>


    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;Microfading data class - Number of files = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>


    <span class="k">def</span> <span class="nf">add_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span><span class="nb">str</span><span class="p">],</span> <span class="n">values</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span><span class="nb">str</span><span class="p">]):</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">parameters</span> <span class="o">=</span> <span class="p">[</span><span class="n">parameters</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">values</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">values</span><span class="p">]</span>


        <span class="n">info_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">parameter</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span><span class="n">values</span><span class="p">):</span>


            <span class="c1"># List available parameters if parameter not found</span>
            <span class="k">if</span> <span class="n">parameter</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">info_df</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parameter &#39;</span><span class="si">{</span><span class="n">parameter</span><span class="si">}</span><span class="s2">&#39; not found in the &#39;info&#39; sheet.</span><span class="se">\n</span><span class="s2">Available parameters: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">info_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">info_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>


        <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">file</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">info_df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">):</span>

            <span class="n">df_cl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;CIELAB&#39;</span><span class="p">)</span> 
            <span class="n">df_sp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;spectra&#39;</span><span class="p">)</span> 
            <span class="n">df_info</span> <span class="o">=</span> <span class="n">info_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>            
            <span class="n">df_info</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;value&#39;</span>

            <span class="c1"># Write all sheets back to the Excel file</span>
            <span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="k">as</span> <span class="n">writer</span><span class="p">:</span>

                <span class="n">df_info</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">df_cl</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;CIELAB&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">df_sp</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;spectra&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">compute_delta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dE00&#39;</span><span class="p">],</span> <span class="n">dose_unit</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">dose_values</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">derivation</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve the CIE delta values for a given set of colorimetric coordinates corresponding to the given microfading analyses.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coordinates : list, optional</span>
<span class="sd">            List of colorimetric coordinates, by default [&#39;dE00&#39;]</span>
<span class="sd">            Any of the following coordinates can be added to the list: &#39;dE76&#39;, &#39;dE00&#39;, &#39;dR_vis&#39; , &#39;L*&#39;, &#39;a*&#39;, &#39;b*&#39;, &#39;C*&#39;, &#39;h&#39;.</span>

<span class="sd">        dose_unit : str, optional</span>
<span class="sd">            Define the light energy dose, by default &#39;He&#39;</span>
<span class="sd">            Any of the following units can be entered: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec)</span>

<span class="sd">        dose_values : Union[int, float, list, tuple], optional</span>
<span class="sd">            Dose values for which the colourimetric values will be returned, by default &#39;all&#39;</span>
<span class="sd">            When &#39;all&#39;, it returns the colourimetric values for all the dose values available in the given input data files.</span>
<span class="sd">            A single dose value (an integer or a float number) can be entered.</span>
<span class="sd">            A list of dose values, as integer or float, can also be entered.</span>
<span class="sd">            A tuple of three values (min, max, step) will be used in a numpy.arange() function to return an array of dose values. </span>

<span class="sd">        derivation : bool, optional</span>
<span class="sd">            Whether to return the first derivative values of the desired coordinates, by default False</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A list of pandas dataframes</span>
<span class="sd">            It returns a a list of pandas dataframes where each column corresponds to a light energy dose or a desired coordinate.</span>
<span class="sd">        &quot;&quot;&quot;</span>          

        <span class="c1"># Retrieve the data        </span>
        <span class="n">cielab_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_files</span><span class="p">(</span><span class="n">sheets</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CIELAB&#39;</span><span class="p">])</span>
        <span class="n">cielab_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cielab_data</span><span class="p">]</span>       

        <span class="c1"># Rename the LabCh coordinates to dL*, da*, db*, dC*, dh</span>
        <span class="n">coordinates</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;d</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span><span class="s1">&#39;b*&#39;</span><span class="p">,</span><span class="s1">&#39;C*&#39;</span><span class="p">,</span><span class="s1">&#39;h&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">coordinates</span><span class="p">]</span>

        <span class="c1"># Compute the delta values</span>
        <span class="n">deltas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cielab</span><span class="p">(</span><span class="n">coordinates</span><span class="o">=</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span> <span class="n">dose_values</span><span class="o">=</span><span class="n">dose_values</span><span class="p">)</span>

        <span class="c1"># Whether to compute the first derivation </span>
        <span class="k">if</span> <span class="n">derivation</span><span class="p">:</span>
            <span class="n">deltas</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">deltas</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">deltas</span>     


    <span class="k">def</span> <span class="nf">compute_fitting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">return_data</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">dose_unit</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Hv&#39;</span><span class="p">,</span> <span class="n">coordinate</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;dE00&#39;</span><span class="p">,</span> <span class="n">equation</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;power_3p&#39;</span><span class="p">,</span> <span class="n">initial_params</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">bounds</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">),</span> <span class="n">x_range</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">5.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),</span> <span class="n">save</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">path_fig</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;cwd&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit the values of a given colourimetric coordinates. </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        plot : bool, optional</span>
<span class="sd">            Whether to show the fitted data, by default True</span>

<span class="sd">        return_data : bool, optional</span>
<span class="sd">            Whether to return the fitted data, by default False</span>

<span class="sd">        dose_unit : string, optional</span>
<span class="sd">            Unit of the light energy dose, by default &#39;He&#39;</span>
<span class="sd">            Any of the following units can be used: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec)</span>

<span class="sd">        coordinate : string, optional</span>
<span class="sd">            Select the desired colourimetric coordinate from the following list: [&#39;L*&#39;, &#39;a*&#39;,&#39;b*&#39;, &#39;C*&#39;, &#39;h&#39;, &#39;dL*&#39;, &#39;da*&#39;,&#39;db*&#39;, &#39;dC*&#39;, &#39;dh&#39;, &#39;dE76&#39;, &#39;dE00&#39;, &#39;dR_vis&#39;], by default &#39;dE00&#39;</span>

<span class="sd">        equation : str, optional</span>
<span class="sd">            Mathematical equation used to fit the coordinate values, by default &#39;c0*(x**c1)&#39;.</span>
<span class="sd">            Any others mathematical can be given. The following equation is often relevant for fitting microfading data: &#39;((x) / (c0 + (c1*x))) + c2&#39;.</span>

<span class="sd">        initial_params : Optional[List[float]], optional</span>
<span class="sd">            Initial guesses of the &#39;c&#39; parameters given in the equation (c0, c1, c2, etc.), by default [0.1, 0.0]</span>

<span class="sd">        x_range : Optional[Tuple[int]], optional</span>
<span class="sd">            Values along which the fitted values should be computed (start, end, step), by default (0, 1001, 1)</span>

<span class="sd">        save : Optional[bool], optional</span>
<span class="sd">            Whether to save the plot, by default False</span>

<span class="sd">        path_fig : Optional[str], optional</span>
<span class="sd">            Absolute path of the figure to be saved, by default &#39;default&#39;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Union[None, Tuple[np.ndarray, np.ndarray]]</span>
<span class="sd">            _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Retrieve the range light dose values</span>
        <span class="n">doses</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;He&#39;</span><span class="p">:</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;Hv&#39;</span><span class="p">:</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="s1">&#39;t_sec&#39;</span><span class="p">}</span>  
        <span class="n">x_model</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">*</span><span class="n">x_range</span><span class="p">)</span>

        <span class="c1"># Retrieve the data        </span>
        <span class="n">all_data</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;cl&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;mean&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">cl_mean_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># the mean colorimetric data</span>
                <span class="n">doses_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>   <span class="c1"># the light energy data</span>

                <span class="n">all_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">doses_data</span><span class="p">,</span> <span class="n">cl_mean_data</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">all_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>                

        <span class="c1"># Added the delta LabCh values to the data dataframes</span>
        <span class="n">coordinates</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span> <span class="s1">&#39;a*&#39;</span><span class="p">,</span> <span class="s1">&#39;b*&#39;</span><span class="p">,</span> <span class="s1">&#39;C*&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="sa">f</span><span class="s1">&#39;d</span><span class="si">{</span><span class="n">coord</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span> <span class="o">-</span> <span class="n">d</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">coordinates</span><span class="p">})</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">all_data</span><span class="p">]</span>

        <span class="c1"># Select the wanted dose_unit and coordinate</span>
        <span class="n">selected_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[[</span><span class="n">doses</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">],</span> <span class="n">coordinate</span><span class="p">]]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
        <span class="n">selected_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">selected_data</span><span class="p">]</span>

        <span class="c1"># Define the fitting equation and bounds</span>
        <span class="n">config_functions</span> <span class="o">=</span> <span class="n">get_DB_config</span><span class="p">()[</span><span class="s1">&#39;functions&#39;</span><span class="p">]</span>
        <span class="n">existing_equations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">config_functions</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">equation</span> <span class="ow">in</span> <span class="n">existing_equations</span><span class="p">:</span>
            <span class="n">bounds</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">config_functions</span><span class="p">[</span><span class="n">equation</span><span class="p">][</span><span class="s1">&#39;bounds&#39;</span><span class="p">])</span>
            <span class="n">equation</span> <span class="o">=</span> <span class="n">config_functions</span><span class="p">[</span><span class="n">equation</span><span class="p">][</span><span class="s1">&#39;expression&#39;</span><span class="p">]</span>           

        <span class="c1"># Define the function to fit</span>
        <span class="k">def</span> <span class="nf">fit_function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">):</span>
            <span class="n">param_dict</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s1">&#39;c</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="n">param</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">params</span><span class="p">)}</span>
            <span class="n">param_dict</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
            <span class="k">return</span> <span class="nb">eval</span><span class="p">(</span><span class="n">equation</span><span class="p">,</span> <span class="nb">globals</span><span class="p">(),</span> <span class="n">param_dict</span><span class="p">)</span>        

        <span class="c1"># Create an empty dataframe for the fitted data</span>
        <span class="n">fitted_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">x_model</span><span class="p">))</span>

        <span class="c1"># Empty list to store the labels</span>
        <span class="n">fitted_labels</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Emtpy list to store the optimized parameters</span>
        <span class="n">fitted_parameters</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">initial_params</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
            <span class="n">initial_params</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;auto&#39;</span><span class="p">]</span>

        <span class="n">initial_params</span> <span class="o">=</span> <span class="n">initial_params</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>


        <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">selected_data</span><span class="p">,</span><span class="n">initial_params</span><span class="p">):</span>

            <span class="c1"># retrieve the x(light dose) and y(coordinate) values</span>
            <span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

            <span class="c1"># estimate the initial parameters</span>
            <span class="k">if</span> <span class="n">p</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>  

                <span class="n">y_diff</span> <span class="o">=</span> <span class="n">y_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">equation</span> <span class="o">==</span> <span class="s2">&quot;c0*x&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">y_diff</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.1</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="n">y_diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="n">y_diff</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">p</span>  <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                <span class="k">elif</span> <span class="n">equation</span> <span class="o">==</span> <span class="s2">&quot;c0*x+c1&quot;</span><span class="p">:</span>                    

                    <span class="k">if</span> <span class="n">y_diff</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">c0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1</span>
                    <span class="k">elif</span> <span class="n">y_diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">c0</span> <span class="o">=</span> <span class="mf">0.1</span>
                    <span class="k">elif</span> <span class="n">y_diff</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">c0</span>  <span class="o">=</span> <span class="mi">0</span>

                    <span class="n">c1</span> <span class="o">=</span> <span class="n">y_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="n">c0</span><span class="p">,</span><span class="n">c1</span><span class="p">]</span>

                <span class="k">elif</span> <span class="n">equation</span> <span class="o">==</span> <span class="s2">&quot;c0*(x**c1)&quot;</span><span class="p">:</span>                    

                    <span class="k">if</span> <span class="n">y_diff</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">c0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1</span>
                    <span class="k">elif</span> <span class="n">y_diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">c0</span> <span class="o">=</span> <span class="mf">0.1</span>
                    <span class="k">elif</span> <span class="n">y_diff</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">c0</span>  <span class="o">=</span> <span class="mi">0</span>

                    <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="n">c0</span><span class="p">,</span><span class="mf">0.1</span><span class="p">]</span>

                <span class="k">elif</span> <span class="n">equation</span> <span class="o">==</span> <span class="s2">&quot;c0*(x**c1)+c2&quot;</span><span class="p">:</span>                    

                    <span class="k">if</span> <span class="n">y_diff</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">c0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1</span>
                    <span class="k">elif</span> <span class="n">y_diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">c0</span> <span class="o">=</span> <span class="mf">0.1</span>
                    <span class="k">elif</span> <span class="n">y_diff</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">c0</span>  <span class="o">=</span> <span class="mi">0</span>

                    <span class="n">c2</span> <span class="o">=</span> <span class="n">y_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="n">c0</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="n">c2</span><span class="p">]</span>


                <span class="k">elif</span> <span class="n">equation</span> <span class="o">==</span> <span class="s2">&quot;(c0/(1+np.exp(c1*x)))&quot;</span><span class="p">:</span>                    

                    <span class="k">if</span> <span class="n">y_diff</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">c0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1</span>
                    <span class="k">elif</span> <span class="n">y_diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">c0</span> <span class="o">=</span> <span class="mf">0.1</span>
                    <span class="k">elif</span> <span class="n">y_diff</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">c0</span>  <span class="o">=</span> <span class="mi">0</span>

                    <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="n">c0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">]</span>


                <span class="k">elif</span> <span class="n">equation</span> <span class="o">==</span> <span class="s2">&quot;(c0/(1+np.exp(c1*x)))+c2&quot;</span><span class="p">:</span>                    

                    <span class="k">if</span> <span class="n">y_diff</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">c0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1</span>
                    <span class="k">elif</span> <span class="n">y_diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">c0</span> <span class="o">=</span> <span class="mf">0.1</span>
                    <span class="k">elif</span> <span class="n">y_diff</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">c0</span>  <span class="o">=</span> <span class="mi">0</span>                    

                    <span class="n">c2</span> <span class="o">=</span> <span class="n">y_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="n">c0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">c2</span><span class="p">]</span>


            <span class="c1"># perform the curve fitting, return the optimized parameters (popt) and the covariance matrix (pcov)</span>
            <span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">fit_function</span><span class="p">,</span> <span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">)</span>

            <span class="c1"># generate fitted y data</span>
            <span class="n">fitted_y</span> <span class="o">=</span> <span class="n">fit_function</span><span class="p">(</span><span class="n">x_model</span><span class="p">,</span> <span class="o">*</span><span class="n">popt</span><span class="p">)</span>

            <span class="c1"># append it to the fitted_data dataframe</span>
            <span class="n">fitted_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">fitted_data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">fitted_y</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">x_model</span><span class="p">))],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

            <span class="c1"># Calculate R-squared value</span>
            <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_data</span> <span class="o">-</span> <span class="n">fit_function</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="o">*</span><span class="n">popt</span><span class="p">)</span>
            <span class="n">ss_res</span><span class="p">,</span> <span class="n">ss_tot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">residuals</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">y_data</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_data</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>        
            <span class="n">r_squared</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">ss_res</span> <span class="o">/</span> <span class="n">ss_tot</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>

            <span class="c1"># Create a string representation of the equation with optimized parameters</span>
            <span class="n">optimized_equation</span> <span class="o">=</span> <span class="n">equation</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">popt</span><span class="p">):</span>
                <span class="n">optimized_equation</span> <span class="o">=</span> <span class="n">optimized_equation</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;c</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">param</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>

            <span class="n">fitted_labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">optimized_equation</span><span class="si">}</span><span class="s1">, $R^2$ = </span><span class="si">{</span><span class="n">r_squared</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fitted_parameters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">popt</span><span class="p">)</span>

        <span class="n">fitted_data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">, $y$ = </span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_meas_ids</span><span class="p">,</span> <span class="n">fitted_labels</span><span class="p">)]</span>         

        <span class="c1"># Plot the data</span>
        <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>            

            <span class="n">labels_H</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;Hv&#39;</span><span class="p">:</span> <span class="s1">&#39;Exposure dose $H_v$ (Mlxh)&#39;</span><span class="p">,</span>
                <span class="s1">&#39;He&#39;</span><span class="p">:</span> <span class="s1">&#39;Radiant Exposure $H_e$ (MJ/m)&#39;</span><span class="p">,</span>
                <span class="s1">&#39;t&#39;</span> <span class="p">:</span> <span class="s1">&#39;Exposure duration (seconds)&#39;</span>
            <span class="p">}</span>

            <span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="s1">&#39;paper&#39;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="s1">&#39;serif&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;colorblind&#39;</span><span class="p">)</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
            <span class="n">fs</span> <span class="o">=</span> <span class="mi">24</span>


            <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">selected_data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.7&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">fitted_data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">labels_H</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">labels_eq</span><span class="p">[</span><span class="n">coordinate</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>    

            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>   

            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>    


            <span class="c1"># Whether to save the figure</span>
            <span class="k">if</span> <span class="n">save</span><span class="p">:</span>

                <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;MFT_</span><span class="si">{</span><span class="n">coordinate</span><span class="si">}</span><span class="s1">-fitted.png&#39;</span>

                <span class="k">if</span> <span class="n">save</span><span class="p">:</span>      

                    <span class="k">if</span> <span class="n">path_fig</span> <span class="o">==</span> <span class="s1">&#39;cwd&#39;</span><span class="p">:</span>
                        <span class="n">path_fig</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">&#39;</span> 

                    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">path_fig</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">return_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">fitted_parameters</span><span class="p">,</span> <span class="n">fitted_data</span><span class="p">,</span> <span class="n">pcov</span><span class="p">,</span> <span class="n">r_squared</span>   


    <span class="k">def</span> <span class="nf">compute_JND</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dose_unit</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Hv&#39;</span><span class="p">,</span> <span class="n">JND_dE</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">light_intensity</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">daily_exposure</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">yearly_exposure</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">365</span><span class="p">,</span> <span class="n">fitting</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the just noticeable difference (JND) corresponding to each input data file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dose_unit : Optional[str], optional</span>
<span class="sd">            Unit of the light dose energy, by default &#39;Hv&#39;</span>
<span class="sd">            Any of the following units can be entered: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec)</span>

<span class="sd">        JND_dE : float, optional</span>
<span class="sd">            The dE00 value corresponding to one JND, by default 1.5</span>

<span class="sd">        light_intensity : int, optional</span>
<span class="sd">            The illuminance or the irradiance value of the intended light source, by default 50</span>

<span class="sd">        daily_exposure : Optional[int], optional</span>
<span class="sd">            Amount of exposure hours per day, by default 10</span>

<span class="sd">        yearly_exposure : Optional[int], optional</span>
<span class="sd">            Amount of exposure days per year, by default 365</span>

<span class="sd">        fitting : bool, optional</span>
<span class="sd">            Whether to fit the microfading data necessary to compute the JND value, by default True</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A list of numerical values as string (uncertainty string with a nominal and standard deviation value)</span>
<span class="sd">            It returns a list of numerical values corresponding to the amount of years necessary to reach one JND. </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">H_step</span> <span class="o">=</span> <span class="mf">0.01</span>
        <span class="n">dE_fitted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_fitting</span><span class="p">(</span><span class="n">dose_unit</span><span class="o">=</span><span class="s1">&#39;Hv&#39;</span><span class="p">,</span> <span class="n">x_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">5.1</span><span class="p">,</span><span class="n">H_step</span><span class="p">),</span> <span class="n">return_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">dE_rate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">dE_fitted</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">H_step</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">dE_rate_mean</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">:])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dE_rate</span><span class="p">]</span>
        <span class="n">dE_rate_std</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">:])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dE_rate</span><span class="p">]</span>

        <span class="n">rates</span> <span class="o">=</span> <span class="p">[</span><span class="n">ufloat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dE_rate_mean</span><span class="p">,</span> <span class="n">dE_rate_std</span><span class="p">)]</span>

        <span class="n">times_years</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">rate</span> <span class="ow">in</span> <span class="n">rates</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">dose_unit</span> <span class="o">==</span> <span class="s1">&#39;Hv&#39;</span><span class="p">:</span>

                <span class="n">JND_dose</span> <span class="o">=</span> <span class="p">(</span><span class="n">JND_dE</span> <span class="o">/</span> <span class="n">rate</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e6</span>                     <span class="c1"># in lxh</span>
                <span class="n">time_hours</span> <span class="o">=</span> <span class="n">JND_dose</span> <span class="o">/</span> <span class="n">light_intensity</span>
                <span class="n">time_years</span> <span class="o">=</span> <span class="n">time_hours</span> <span class="o">/</span> <span class="p">(</span><span class="n">daily_exposure</span> <span class="o">*</span> <span class="n">yearly_exposure</span><span class="p">)</span>            

            <span class="k">if</span> <span class="n">dose_unit</span> <span class="o">==</span> <span class="s1">&#39;He&#39;</span><span class="p">:</span>
                <span class="n">JND_dose</span> <span class="o">=</span> <span class="p">(</span><span class="n">JND_dE</span> <span class="o">/</span> <span class="n">rate</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e6</span>                     <span class="c1"># in J/m</span>
                <span class="n">time_sec</span> <span class="o">=</span> <span class="n">JND_dose</span> <span class="o">/</span> <span class="n">light_intensity</span>
                <span class="n">time_hours</span> <span class="o">=</span> <span class="n">time_sec</span> <span class="o">/</span> <span class="mi">3600</span>
                <span class="n">time_years</span> <span class="o">=</span> <span class="n">time_hours</span> <span class="o">/</span> <span class="p">(</span><span class="n">daily_exposure</span> <span class="o">*</span> <span class="n">yearly_exposure</span><span class="p">)</span>

            <span class="n">times_years</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time_years</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">times_years</span>


    <span class="k">def</span> <span class="nf">compute_mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">return_data</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">criterion</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;spot_group&#39;</span><span class="p">,</span> <span class="n">dose_unit</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">save</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">folder</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute mean and standard deviation values of several microfading measurements.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        return_data : Optional[bool], optional</span>
<span class="sd">            Whether to return the data, by default True        </span>

<span class="sd">        criterion : Optional[str], optional</span>
<span class="sd">            _description_, by default &#39;group&#39;            </span>

<span class="sd">        save : Optional[bool], optional</span>
<span class="sd">            Whether to save the average data as an excel file, by default False</span>

<span class="sd">        folder : Optional[str], optional</span>
<span class="sd">            Folder where the excel file will be saved, by default &#39;default&#39;</span>
<span class="sd">            When &#39;default&#39;, the file will be saved in the same folder as the input files</span>
<span class="sd">            When &#39;.&#39;, the file will be saved in the current working directory</span>
<span class="sd">            One can also enter a valid path as a string.</span>

<span class="sd">        filename : Optional[str], optional</span>
<span class="sd">            Filename of the excel file containing the average values, by default &#39;default&#39;</span>
<span class="sd">            When &#39;default&#39;, it will use the filename of the first input file</span>
<span class="sd">            One can also enter a filename, but without a filename extension.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple, excel file</span>
<span class="sd">            It returns a tuple composed of three elements (info, CIELAB data, spectral data). When &#39;save&#39; is set to True, an excel is created to stored the tuple inside three distinct excel sheet (info, CIELAB, spectra).</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>        
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Not enough files. At least two measurement files are required to compute the average values.&#39;</span><span class="p">)</span>


        <span class="k">def</span> <span class="nf">mean_std_with_nan</span><span class="p">(</span><span class="n">arrays</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&#39;&#39;&#39;Compute the mean of several numpy arrays of different shapes.&#39;&#39;&#39;</span>

            <span class="c1"># Find the maximum shape</span>
            <span class="n">max_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrays</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

            <span class="c1"># Create arrays with NaN values</span>
            <span class="n">nan_arrays</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">max_shape</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">arrays</span><span class="p">))]</span>

            <span class="c1"># Fill NaN arrays with actual values</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">arr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">arrays</span><span class="p">):</span>
                <span class="n">nan_arrays</span><span class="p">[</span><span class="n">i</span><span class="p">][:</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">:</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">arr</span>

            <span class="c1"># Calculate mean</span>
            <span class="n">mean_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">nan_arrays</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

            <span class="c1"># Calculate std</span>
            <span class="n">std_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanstd</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">nan_arrays</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">mean_array</span><span class="p">,</span> <span class="n">std_array</span>


        <span class="k">def</span> <span class="nf">to_float</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">x</span>


        <span class="c1">###### SPECTRAL DATA #######</span>

        <span class="n">data_sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;sp&#39;</span><span class="p">)</span>

        <span class="c1"># Get the energy dose step</span>
        <span class="c1">#H_values = [x.columns.astype(float) for x in data_sp]       </span>
        <span class="n">H_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_doses</span><span class="p">(</span><span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">)]</span>
        <span class="n">step_H</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">H_values</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">highest_He</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">H_values</span><span class="p">])</span>

        <span class="c1"># Average the spectral data</span>
        <span class="n">sp</span> <span class="o">=</span> <span class="n">mean_std_with_nan</span><span class="p">(</span><span class="n">data_sp</span><span class="p">)</span>
        <span class="n">sp_mean</span> <span class="o">=</span> <span class="n">sp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">sp_std</span> <span class="o">=</span> <span class="n">sp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> 


        <span class="c1"># Wanted energy dose values          </span>
        <span class="n">wanted_H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">highest_He</span><span class="o">+</span><span class="n">step_H</span><span class="p">,</span><span class="n">step_H</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>  

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">wanted_H</span><span class="p">)</span> <span class="o">!=</span> <span class="n">sp_mean</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>            
            <span class="n">wanted_H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">highest_He</span><span class="p">,</span><span class="n">sp_mean</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># Retrieve the wavelength range</span>
        <span class="n">wl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_wavelength</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>


        <span class="c1"># Create a multi-index pandas DataFrame</span>
        <span class="n">doses_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;He&#39;</span><span class="p">:</span> <span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;Hv&#39;</span><span class="p">:</span> <span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="s1">&#39;t_sec&#39;</span><span class="p">}</span>
        <span class="n">H_tuples</span> <span class="o">=</span> <span class="p">[(</span><span class="n">dose</span><span class="p">,</span> <span class="n">measurement</span><span class="p">)</span> <span class="k">for</span> <span class="n">dose</span> <span class="ow">in</span> <span class="n">wanted_H</span> <span class="k">for</span> <span class="n">measurement</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">]]</span>
        <span class="n">multiindex_cols</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">H_tuples</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="n">doses_dict</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">],</span> <span class="s1">&#39;Measurement&#39;</span><span class="p">])</span>

        <span class="n">data_df_sp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">wl</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">wanted_H</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">))</span>       
        <span class="n">data_df_sp</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">sp_mean</span>
        <span class="n">data_df_sp</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">sp_std</span>
        <span class="n">df_sp_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_df_sp</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">multiindex_cols</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">wl</span><span class="p">)</span>
        <span class="n">df_sp_final</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;wavelength_nm&#39;</span>



        <span class="c1">###### COLORIMETRIC DATA #######</span>

        <span class="n">data_cl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;cl&#39;</span><span class="p">)</span>
        <span class="n">columns_cl</span> <span class="o">=</span> <span class="n">data_cl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Average the colorimetric data    </span>
        <span class="n">cl</span> <span class="o">=</span> <span class="n">mean_std_with_nan</span><span class="p">(</span><span class="n">data_cl</span><span class="p">)</span>
        <span class="n">cl_mean</span> <span class="o">=</span> <span class="n">cl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">cl_std</span> <span class="o">=</span> <span class="n">cl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># Create a multi-index pandas DataFrame</span>
        <span class="n">cl_tuples</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">measurement</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_cl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">measurement</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">]]</span>
        <span class="n">multiindex_cols</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">cl_tuples</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;coordinates&#39;</span><span class="p">,</span> <span class="s1">&#39;Measurement&#39;</span><span class="p">])</span>

        <span class="n">data_df_cl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">cl_mean</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cl_mean</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">))</span>       
        <span class="n">data_df_cl</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">cl_mean</span>
        <span class="n">data_df_cl</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">cl_std</span>
        <span class="n">df_cl_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_df_cl</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">multiindex_cols</span><span class="p">,</span> <span class="p">)</span>

        <span class="n">df_cl_final</span><span class="o">.</span><span class="n">drop</span><span class="p">([(</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span><span class="s1">&#39;std&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span><span class="s1">&#39;std&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;t_sec&#39;</span><span class="p">,</span><span class="s1">&#39;std&#39;</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">mapper</span> <span class="o">=</span> <span class="p">{(</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">):</span> <span class="p">(</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">):</span> <span class="p">(</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;t_sec&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">):</span> <span class="p">(</span><span class="s1">&#39;t_sec&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)}</span>
        <span class="n">df_cl_final</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([</span><span class="n">mapper</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df_cl_final</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>


        <span class="n">cl_cols</span> <span class="o">=</span> <span class="n">df_cl_final</span><span class="o">.</span><span class="n">columns</span>
        <span class="n">cl_cols_level1</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cl_cols</span><span class="p">]</span>
        <span class="n">cl_cols_level2</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cl_cols</span><span class="p">]</span>
        <span class="n">df_cl_final</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">df_cl_final</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">df_cl_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">cl_cols_level2</span><span class="p">])),</span> <span class="n">df_cl_final</span><span class="p">])</span>
        <span class="n">df_cl_final</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">cl_cols_level1</span>
        <span class="n">df_cl_final</span> <span class="o">=</span> <span class="n">df_cl_final</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">df_cl_final</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>


        <span class="c1">###### INFO #######</span>

        <span class="n">data_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

        <span class="c1"># Select the first column as a template</span>
        <span class="n">df_info</span> <span class="o">=</span> <span class="n">data_info</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>


        <span class="c1"># Rename title file</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;[SINGLE MICROFADING ANALYSIS]&#39;</span><span class="p">:</span> <span class="s1">&#39;[MEAN MICROFADING ANALYSES]&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Date time</span>
        <span class="n">most_recent_dt</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">])</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">most_recent_dt</span>

        <span class="c1"># Project data info</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;project_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;project_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;project_leader&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;project_leader&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;co-researchers&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;co-researchers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;start_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;start_date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;end_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;end_date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;keywords&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;keywords&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>

        <span class="c1"># Object data info</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;institution&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;institution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;institution&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_category&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_technique&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_technique&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_title&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_creator&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_creator&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_material&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_material&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;colorants&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;colorants&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;colorants_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;colorants_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;binding&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;binding&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;ratio&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;thickness_um&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;thickness_um&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>

        <span class="c1"># Device data info</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;measurement_mode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;measurement_mode&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;zoom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;zoom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;iris&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">()</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;iris&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)]))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;distance_ill_mm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">()</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;distance_ill_mm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)]))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;distance_coll_mm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">()</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;distance_coll_mm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)]))</span>


        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_fading&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_fading&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_fading&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_ill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_ill&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_ill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_coll&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_coll&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_coll&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;lamp_fading&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;lamp_fading&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;lamp_fading&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;lamp_ill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;lamp_ill&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;lamp_ill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;filter_fading&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;filter_fading&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;filter_fading&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;filter_ill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;filter_ill&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;filter_ill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;white_standard&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;white_standard&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;white_standard&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>


        <span class="c1"># Analysis data info</span>

        <span class="n">criterion_value</span> <span class="o">=</span> <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">criterion</span><span class="p">]</span>
        <span class="n">object_id</span> <span class="o">=</span> <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_id&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">criterion</span> <span class="o">==</span> <span class="s1">&#39;group&#39;</span><span class="p">:</span>            
            <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;meas_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;MF.</span><span class="si">{</span><span class="n">object_id</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="n">criterion_value</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">elif</span> <span class="n">criterion</span> <span class="o">==</span> <span class="s1">&#39;object&#39;</span> <span class="ow">or</span> <span class="n">criterion</span> <span class="o">==</span> <span class="s1">&#39;project&#39;</span><span class="p">:</span>
             <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;meas_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;MF.</span><span class="si">{</span><span class="n">criterion_value</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Choose one of the following options for the criterion parameter: [&quot;group&quot;, &quot;object&quot;, &quot;project&quot;]&#39;</span><span class="p">)</span>

        <span class="n">meas_nbs</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_meas_ids</span><span class="p">])</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;spot_group&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="s2">&quot;-&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;spot_group&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">meas_nbs</span><span class="si">}</span><span class="s1">&#39;</span>    
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;spot_description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;spot_description&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;background&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;background&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>  

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;specular_component&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;specular_component&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;specular_component&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span> 


        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;integration_time_sample_ms&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;integration_time_sample_ms&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;integration_time_whitestandard_ms&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;integration_time_whitestandard_ms&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;average&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;average&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">))])</span> 
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;duration_min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;duration_min&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;interval_sec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;interval_sec&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))])</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;measurements_N&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;measurements_N&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">))])</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;illuminant&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;illuminant&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;observer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;observer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>


        <span class="c1"># Beam data info</span>

        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;beam_photo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;beam_photo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;resolution_micron/pixel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">()</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;resolution_micron/pixel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)]))</span>

        <span class="n">fwhm</span> <span class="o">=</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;FWHM_micron&#39;</span><span class="p">]</span>
        <span class="n">fwhm_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="n">to_float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fwhm</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))])</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;FWHM_micron&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fwhm_avg</span>

        <span class="n">power_infos</span> <span class="o">=</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;radiantFlux_mW&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">power_values</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">power_info</span> <span class="ow">in</span> <span class="n">power_infos</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;_&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">power_info</span><span class="p">):</span>
                <span class="n">power_value</span> <span class="o">=</span> <span class="n">ufloat_fromstr</span><span class="p">(</span><span class="n">power_info</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">power_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">power_value</span><span class="p">)</span>                            

            <span class="k">else</span><span class="p">:</span> 
                <span class="n">power_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">power_info</span><span class="p">)</span>               

        <span class="n">power_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">power_values</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">power_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">power_values</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;radiantFlux_mW&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ufloat</span><span class="p">(</span><span class="n">power_mean</span><span class="p">,</span><span class="n">power_std</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>    


        <span class="n">irr_values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">ufloat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;irradiance_Ee_W/m^2&#39;</span><span class="p">]</span> <span class="p">]</span> 
        <span class="n">irr_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">unumpy</span><span class="o">.</span><span class="n">nominal_values</span><span class="p">(</span><span class="n">ufloat_fromstr</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">irr_values</span><span class="p">]))</span>
        <span class="n">irr_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">([</span><span class="n">unumpy</span><span class="o">.</span><span class="n">nominal_values</span><span class="p">(</span><span class="n">ufloat_fromstr</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">irr_values</span><span class="p">]))</span>
        <span class="n">irr_avg</span> <span class="o">=</span> <span class="n">ufloat</span><span class="p">(</span><span class="n">irr_mean</span><span class="p">,</span> <span class="n">irr_std</span><span class="p">)</span>    
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;irradiance_Ee_W/m^2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">irr_avg</span>

        <span class="n">lm</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;luminuousFlux_lm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
        <span class="n">lm_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">lm</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;luminuousFlux_lm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lm_avg</span>

        <span class="n">ill</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;illuminance_Ev_Mlx&#39;</span><span class="p">]]</span>
        <span class="n">ill_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ill</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;illuminance_Ev_Mlx&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ill_avg</span>


        <span class="c1"># Results data info</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;radiantExposure_He_MJ/m^2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_cl_final</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;exposureDose_Hv_Mlxh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">df_cl_final</span><span class="p">[</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="mi">4</span><span class="p">)</span>


        <span class="c1"># Rename the column</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;value&#39;</span>


        <span class="c1">###### SAVE THE MEAN DATAFRAMES #######</span>

        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>  

            <span class="c1"># set the folder</span>
            <span class="k">if</span> <span class="n">folder</span> <span class="o">==</span> <span class="s2">&quot;.&quot;</span><span class="p">:</span>
                <span class="n">folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>  

            <span class="k">elif</span> <span class="n">folder</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
                <span class="n">folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">parent</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Path</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                    <span class="n">folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>         

            <span class="c1"># set the filename</span>
            <span class="k">if</span> <span class="n">filename</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s1">_MEAN</span><span class="si">{</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">suffix</span><span class="si">}</span><span class="s1">&#39;</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">.xlsx&#39;</span>


            <span class="c1"># create a excel writer object</span>
            <span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="n">folder</span> <span class="o">/</span> <span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">writer</span><span class="p">:</span>

                <span class="n">df_info</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">df_cl_final</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;CIELAB&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">df_sp_final</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;spectra&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">folder</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">filename</span><span class="si">}</span><span class="s1"> successfully created.&#39;</span><span class="p">)</span>


        <span class="c1">###### RETURN THE MEAN DATAFRAMES #######</span>

        <span class="k">if</span> <span class="n">return_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">df_info</span><span class="p">,</span> <span class="n">df_cl_final</span><span class="p">,</span> <span class="n">df_sp_final</span>


    <span class="k">def</span> <span class="nf">compute_sp_derivate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the first derivative values of reflectance spectra.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        a list of pandas dataframes</span>
<span class="sd">            It returns the first derivative values of the reflectance spectra inside dataframes where each column corresponds to a single spectra.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;sp&#39;</span><span class="p">)</span>                    

        <span class="n">sp_derivation</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sp</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">sp_derivation</span>


    <span class="k">def</span> <span class="nf">get_spectra</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wl_range</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">dose_unit</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">dose_values</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">spectral_mode</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;rfl&#39;</span><span class="p">,</span> <span class="n">smoothing</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve the reflectance spectra related to the input files.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wl_range : Union[int, float, list, tuple], optional</span>
<span class="sd">            Select the wavelengths for which the spectral values should be given with a two-values tuple corresponding to the lowest and highest wavelength values, by default &#39;all&#39;</span>
<span class="sd">            When &#39;all&#39;, it will returned all the available wavelengths contained in the datasets.</span>
<span class="sd">            A single wavelength value (an integer or a float number) can be entered.</span>
<span class="sd">            A list of specific wavelength values as integer or float can also be entered.</span>
<span class="sd">            A tuple of two or three values (min, max, step) will take the range values between these two first values. By default the step is equal to 1.</span>

<span class="sd">        dose_unit : string, optional</span>
<span class="sd">            Unit of the light energy dose, by default &#39;He&#39;</span>
<span class="sd">            Any of the following units can be used: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec).</span>

<span class="sd">        dose_values : Union[int, float, list, tuple], optional</span>
<span class="sd">            Dose values for which the reflectance values will be returned, by default &#39;all&#39;</span>
<span class="sd">            When &#39;all&#39;, it returns the reflectance values for all the dose values available in the given input data files.</span>
<span class="sd">            A single dose value (an integer or a float number) can be entered.</span>
<span class="sd">            A list of dose values, as integer or float, can also be entered.</span>
<span class="sd">            A tuple of three values (min, max, step) will be used in a numpy.arange() function to return an array of dose values. </span>

<span class="sd">        spectral_mode : string, optional</span>
<span class="sd">            When &#39;rfl&#39;, it returns the reflectance spectra</span>
<span class="sd">            When &#39;abs&#39;, it returns the absorption spectra using the following equation: A = -log(R)</span>

<span class="sd">        smoothing : list of two integers, optional</span>
<span class="sd">            Whether to smooth the reflectance data using the Savitzky-Golay filter from the Scipy package, by default [1,0]</span>
<span class="sd">            The first integer corresponds to the window length and should be less than or equal to the size of a reflectance spectrum. The second integer corresponds to the polyorder parameter which is used to fit the samples. The polyorder value must be less than the value of the window length.</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A list of pandas dataframes</span>
<span class="sd">            It returns a list of pandas dataframes where the columns correspond to the dose values and the rows correspond to the wavelengths.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">data_sp</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_files</span><span class="p">(</span><span class="n">sheets</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;spectra&#39;</span><span class="p">,</span> <span class="s1">&#39;CIELAB&#39;</span><span class="p">])</span>   

        <span class="n">dose_units</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;He&#39;</span><span class="p">:</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;Hv&#39;</span><span class="p">:</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span><span class="s1">&#39;t_sec&#39;</span><span class="p">}</span>     

        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="n">df_sp</span> <span class="o">=</span> <span class="n">file</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>            

            <span class="c1"># whether to compute the absorption spectra</span>
            <span class="k">if</span> <span class="n">spectral_mode</span> <span class="o">==</span> <span class="s1">&#39;abs&#39;</span><span class="p">:</span>
                <span class="n">df_sp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">df_sp</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>


            <span class="c1"># Set the dose unit</span>
            <span class="k">if</span> <span class="n">dose_unit</span> <span class="o">==</span> <span class="s1">&#39;Hv&#39;</span><span class="p">:</span>
                <span class="n">Hv</span> <span class="o">=</span> <span class="n">file</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="n">df_sp</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df_sp</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">set_levels</span><span class="p">(</span><span class="n">Hv</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>                
                <span class="c1">#df_sp.index.name = &#39;wl-nm_Hv-Mlxh&#39;</span>

            <span class="k">elif</span> <span class="n">dose_unit</span> <span class="o">==</span><span class="s1">&#39;t&#39;</span><span class="p">:</span>
                <span class="n">t</span> <span class="o">=</span> <span class="n">file</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;t_sec&#39;</span><span class="p">,</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="n">df_sp</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df_sp</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">set_levels</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="c1">#df_sp.index.name = &#39;wl-nm_t-sec&#39;</span>


            <span class="c1"># Set the wavelengths</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wl_range</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">wl_range</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">wl_range</span> <span class="o">=</span> <span class="p">(</span><span class="n">wl_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">wl_range</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>

                <span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">wl_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wl_range</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">wl_range</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>                               

            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wl_range</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">wavelengths</span> <span class="o">=</span> <span class="n">wl_range</span>                               

            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wl_range</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">wl_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">wl_range</span><span class="p">]</span>
                <span class="n">wavelengths</span> <span class="o">=</span> <span class="n">wl_range</span>  

            <span class="k">else</span><span class="p">:</span>
                <span class="n">wavelengths</span> <span class="o">=</span> <span class="n">df_sp</span><span class="o">.</span><span class="n">index</span>          

            <span class="n">df_sp</span> <span class="o">=</span> <span class="n">df_sp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">wavelengths</span><span class="p">]</span>


            <span class="c1"># Smooth the data</span>
            <span class="n">doses</span> <span class="o">=</span> <span class="n">df_sp</span><span class="o">.</span><span class="n">columns</span>
            <span class="n">df_sp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">savgol_filter</span><span class="p">(</span><span class="n">df_sp</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">window_length</span><span class="o">=</span><span class="n">smoothing</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">polyorder</span><span class="o">=</span><span class="n">smoothing</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">doses</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">wavelengths</span><span class="p">)</span>

            <span class="c1"># Set the dose values </span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dose_values</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dose_values</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">dose_values</span> <span class="o">=</span> <span class="p">(</span><span class="n">dose_values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">dose_values</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>

                <span class="n">wanted_doses</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">dose_values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dose_values</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dose_values</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dose_values</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dose_values</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>            
                <span class="n">wanted_doses</span> <span class="o">=</span> <span class="p">[</span><span class="n">dose_values</span><span class="p">]</span>

            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dose_values</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">wanted_doses</span> <span class="o">=</span> <span class="n">dose_values</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">wanted_doses</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">df_sp</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>


            <span class="k">def</span> <span class="nf">multiindex_2Dinterpolation</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">dose_unit</span><span class="p">,</span> <span class="n">wanted_x</span><span class="p">,</span> <span class="n">wanted_y</span><span class="p">,</span> <span class="n">level_name</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">):</span>
                <span class="n">interpolator</span> <span class="o">=</span> <span class="n">RegularGridInterpolator</span><span class="p">((</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span> <span class="n">df</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>

                <span class="c1"># Create a meshgrid of the new points</span>
                <span class="n">new_wv_grid</span><span class="p">,</span> <span class="n">new_ev_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">wanted_y</span><span class="p">,</span> <span class="n">wanted_x</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s1">&#39;ij&#39;</span><span class="p">)</span>

                <span class="c1"># Flatten the grid arrays and combine them into coordinate pairs</span>
                <span class="n">new_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">new_wv_grid</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">new_ev_grid</span><span class="o">.</span><span class="n">ravel</span><span class="p">()])</span><span class="o">.</span><span class="n">T</span>

                <span class="c1"># Interpolate the data at the new points</span>
                <span class="n">interpolated_values</span> <span class="o">=</span> <span class="n">interpolator</span><span class="p">(</span><span class="n">new_points</span><span class="p">)</span>

                <span class="c1"># Reshape the interpolated values to match the new grid shape</span>
                <span class="n">interpolated_values</span> <span class="o">=</span> <span class="n">interpolated_values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wanted_y</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">wanted_x</span><span class="p">))</span>

                <span class="c1"># Create a new DataFrame with the interpolated data</span>
                <span class="n">new_columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([</span><span class="n">wanted_x</span><span class="p">,</span> <span class="p">[</span><span class="n">level_name</span><span class="p">]],</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="n">dose_units</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">],</span> <span class="s1">&#39;value&#39;</span><span class="p">])</span>
                <span class="n">interpolated_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">interpolated_values</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">wanted_y</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">new_columns</span><span class="p">)</span>

                <span class="n">interpolated_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;wavelength_nm&#39;</span>

                <span class="k">return</span> <span class="n">interpolated_df</span>

            <span class="k">if</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">df_sp</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">]:</span>
                <span class="n">df_sp_n</span> <span class="o">=</span> <span class="n">df_sp</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">df_sp_s</span> <span class="o">=</span> <span class="n">df_sp</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

                <span class="n">interpolated_df_sp_n</span> <span class="o">=</span> <span class="n">multiindex_2Dinterpolation</span><span class="p">(</span><span class="n">df_sp_n</span><span class="p">,</span> <span class="n">dose_unit</span><span class="p">,</span> <span class="n">wanted_doses</span><span class="p">,</span> <span class="n">df_sp</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">)</span>   <span class="c1">#.T[::2].T</span>
                <span class="n">interpolated_df_sp_s</span> <span class="o">=</span> <span class="n">multiindex_2Dinterpolation</span><span class="p">(</span><span class="n">df_sp_s</span><span class="p">,</span> <span class="n">dose_unit</span><span class="p">,</span> <span class="n">wanted_doses</span><span class="p">,</span> <span class="n">df_sp</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">)</span>    <span class="c1">#.T[::2].T</span>
                <span class="n">interpolated_df_sp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">interpolated_df_sp_n</span><span class="p">,</span><span class="n">interpolated_df_sp_s</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>                


            <span class="k">else</span><span class="p">:</span>
                <span class="n">interpolated_df_sp</span> <span class="o">=</span> <span class="n">multiindex_2Dinterpolation</span><span class="p">(</span><span class="n">df_sp</span><span class="p">,</span> <span class="n">dose_unit</span><span class="p">,</span> <span class="n">wanted_doses</span><span class="p">,</span> <span class="n">df_sp</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

            <span class="c1"># append the spectral data</span>
            <span class="n">data_sp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">interpolated_df_sp</span><span class="p">)</span> 

        <span class="k">return</span> <span class="n">data_sp</span>


    <span class="k">def</span> <span class="nf">get_cielab</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dE00&#39;</span><span class="p">],</span> <span class="n">dose_unit</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">dose_values</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve the colourimetric values for one or multiple light dose values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coordinates : Optional[list], optional</span>
<span class="sd">            Select the desired colorimetric coordinates from the following list: [&#39;L*&#39;, &#39;a*&#39;,&#39;b*&#39;, &#39;C*&#39;, &#39;h&#39;, &#39;dL*&#39;, &#39;da*&#39;,&#39;db*&#39;, &#39;dC*&#39;, &#39;dh&#39;, &#39;dE76&#39;, &#39;dE00&#39;, &#39;dR_vis&#39;], by default [&#39;dE00&#39;]</span>
<span class="sd">            When &#39;all&#39;, it returns all the colorimetric coordinates.</span>

<span class="sd">        dose_unit : Optional[str], optional</span>
<span class="sd">            Unit of the light dose energy, by default [&#39;He&#39;]</span>
<span class="sd">            Any of the following units can be added to the list: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec)</span>

<span class="sd">        dose_values : Union[int, float, list, tuple], optional</span>
<span class="sd">            Dose values for which the colourimetric values will be returned, by default &#39;all&#39;</span>
<span class="sd">            When &#39;all&#39;, it returns the colourimetric values for all the dose values available in the given input data files.</span>
<span class="sd">            A single dose value (an integer or a float number) can be entered.</span>
<span class="sd">            A list of dose values, as integer or float, can also be entered.</span>
<span class="sd">            A tuple of three values (min, max, step) will be used in a numpy.arange() function to return an array of dose values. </span>

<span class="sd">        index : Optional[bool], optional</span>
<span class="sd">            Whether to set the index of the returned dataframes, by default False</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A list of pandas dataframes</span>
<span class="sd">            It returns the values of the wanted colour coordinates inside dataframes where each coordinate corresponds to a column.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Create a dictionary to store the light dose units</span>
        <span class="n">dose_units</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;He&#39;</span><span class="p">:</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;Hv&#39;</span><span class="p">:</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="s1">&#39;t_sec&#39;</span><span class="p">}</span>


        <span class="c1"># Retrieve the range light dose values</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dose_values</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
            <span class="n">dose_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">dose_values</span><span class="p">]</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dose_values</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">dose_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">dose_values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dose_values</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dose_values</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dose_values</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">dose_values</span> <span class="o">=</span> <span class="n">dose_values</span>        


        <span class="c1"># Retrieve the data        </span>
        <span class="n">cielab_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_files</span><span class="p">(</span><span class="n">sheets</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CIELAB&#39;</span><span class="p">])</span>
        <span class="n">cielab_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cielab_data</span><span class="p">]</span>

        <span class="c1"># Create an empty list with all the colorimetric data</span>
        <span class="n">all_data</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Compute the delta LabCh values and add the data into the list all_data  </span>
        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">cielab_data</span><span class="p">:</span>

            <span class="c1"># for data with std values</span>
            <span class="k">if</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">]:</span>
                <span class="n">data_dLabCh</span> <span class="o">=</span> <span class="n">delta_coord</span> <span class="o">=</span> <span class="p">[</span><span class="n">unumpy</span><span class="o">.</span><span class="n">uarray</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">coord</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="n">coord</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="n">unumpy</span><span class="o">.</span><span class="n">uarray</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">coord</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="n">coord</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span> <span class="s1">&#39;a*&#39;</span><span class="p">,</span> <span class="s1">&#39;b*&#39;</span><span class="p">,</span> <span class="s1">&#39;C*&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data</span><span class="p">]]</span>

                <span class="n">delta_means</span> <span class="o">=</span> <span class="p">[</span><span class="n">unumpy</span><span class="o">.</span><span class="n">nominal_values</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">delta_coord</span><span class="p">]</span>
                <span class="n">delta_stds</span> <span class="o">=</span> <span class="p">[</span><span class="n">unumpy</span><span class="o">.</span><span class="n">std_devs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">delta_coord</span><span class="p">]</span>

                <span class="n">delta_coord_mean</span> <span class="o">=</span> <span class="p">[(</span><span class="sa">f</span><span class="s1">&#39;d</span><span class="si">{</span><span class="n">coord</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span> <span class="s1">&#39;a*&#39;</span><span class="p">,</span> <span class="s1">&#39;b*&#39;</span><span class="p">,</span> <span class="s1">&#39;C*&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">]]</span>
                <span class="n">delta_coord_std</span> <span class="o">=</span> <span class="p">[(</span><span class="sa">f</span><span class="s1">&#39;d</span><span class="si">{</span><span class="n">coord</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span> <span class="s1">&#39;a*&#39;</span><span class="p">,</span> <span class="s1">&#39;b*&#39;</span><span class="p">,</span> <span class="s1">&#39;C*&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">]]</span>

                <span class="k">for</span> <span class="n">coord_mean</span><span class="p">,</span><span class="n">delta_mean</span><span class="p">,</span><span class="n">coord_std</span><span class="p">,</span><span class="n">delta_std</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">delta_coord_mean</span><span class="p">,</span><span class="n">delta_means</span><span class="p">,</span> <span class="n">delta_coord_std</span><span class="p">,</span><span class="n">delta_stds</span><span class="p">):</span>                    
                    <span class="n">data</span><span class="p">[</span><span class="n">coord_mean</span><span class="p">]</span> <span class="o">=</span> <span class="n">delta_mean</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">coord_std</span><span class="p">]</span> <span class="o">=</span> <span class="n">delta_std</span>

                    <span class="n">all_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>          

            <span class="c1"># for data without std values</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">data_LabCh</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span><span class="s1">&#39;b*&#39;</span><span class="p">,</span><span class="s1">&#39;C*&#39;</span><span class="p">,</span><span class="s1">&#39;h&#39;</span><span class="p">]]</span>
                <span class="n">data_dLabCh</span> <span class="o">=</span> <span class="n">data_LabCh</span> <span class="o">-</span> <span class="n">data_LabCh</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
                <span class="n">data_dLabCh</span> <span class="o">=</span> <span class="n">data_dLabCh</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;L*&#39;</span><span class="p">:</span> <span class="s1">&#39;dL*&#39;</span><span class="p">,</span> <span class="s1">&#39;a*&#39;</span><span class="p">:</span> <span class="s1">&#39;da*&#39;</span> <span class="p">,</span><span class="s1">&#39;b*&#39;</span><span class="p">:</span> <span class="s1">&#39;db*&#39;</span><span class="p">,</span><span class="s1">&#39;C*&#39;</span><span class="p">:</span> <span class="s1">&#39;dC*&#39;</span><span class="p">,</span><span class="s1">&#39;h&#39;</span><span class="p">:</span> <span class="s1">&#39;dh&#39;</span><span class="p">},</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">all_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">data</span><span class="p">,</span><span class="n">data_dLabCh</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>


        <span class="c1"># Select the wanted dose_unit and coordinate</span>
        <span class="k">if</span> <span class="n">coordinates</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
            <span class="n">wanted_data</span> <span class="o">=</span> <span class="n">all_data</span>
            <span class="n">wanted_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">set_index</span><span class="p">((</span><span class="n">dose_units</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">],</span><span class="s1">&#39;value&#39;</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">wanted_data</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>       
            <span class="n">wanted_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[[</span><span class="n">dose_units</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">]]</span> <span class="o">+</span> <span class="n">coordinates</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_data</span><span class="p">]</span>       
            <span class="n">wanted_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">wanted_data</span><span class="p">]</span>        

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dose_values</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">dose_values</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
                <span class="n">interpolated_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">wanted_data</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="c1"># Interpolation function, assuming linear interpolation</span>
            <span class="n">interp_functions</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>


            <span class="c1"># Double comprehension list to interpolate each dataframe in wanted_data</span>
            <span class="n">interpolated_data</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
                    <span class="n">col</span><span class="p">:</span> <span class="n">interp_functions</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">])(</span><span class="n">dose_values</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span>
                <span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">dose_values</span><span class="p">)</span>
                <span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="n">dose_units</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">])</span>
                <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">wanted_data</span>
            <span class="p">]</span>


        <span class="c1"># Whether to set the index</span>
        <span class="k">if</span> <span class="n">index</span><span class="p">:</span>
            <span class="n">interpolated_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">interpolated_data</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">interpolated_data</span>       


    <span class="k">def</span> <span class="nf">get_illuminant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">illuminant</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;D65&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;10&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the illuminant values</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        illuminant : Optional[str], optional</span>
<span class="sd">            Select the illuminant, by default &#39;D65&#39;</span>
<span class="sd">            It can be any value within the following list: [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D50&#39;, &#39;D55&#39;, &#39;D60&#39;, &#39;D65&#39;, &#39;D75&#39;, &#39;E&#39;, &#39;FL1&#39;, &#39;FL2&#39;, &#39;FL3&#39;, &#39;FL4&#39;, &#39;FL5&#39;, &#39;FL6&#39;, &#39;FL7&#39;, &#39;FL8&#39;, &#39;FL9&#39;, &#39;FL10&#39;, &#39;FL11&#39;, &#39;FL12&#39;, &#39;FL3.1&#39;, &#39;FL3.2&#39;, &#39;FL3.3&#39;, &#39;FL3.4&#39;, &#39;FL3.5&#39;, &#39;FL3.6&#39;, &#39;FL3.7&#39;, &#39;FL3.8&#39;, &#39;FL3.9&#39;, &#39;FL3.10&#39;, &#39;FL3.11&#39;, &#39;FL3.12&#39;, &#39;FL3.13&#39;, &#39;FL3.14&#39;, &#39;FL3.15&#39;, &#39;HP1&#39;, &#39;HP2&#39;, &#39;HP3&#39;, &#39;HP4&#39;, &#39;HP5&#39;, &#39;LED-B1&#39;, &#39;LED-B2&#39;, &#39;LED-B3&#39;, &#39;LED-B4&#39;, &#39;LED-B5&#39;, &#39;LED-BH1&#39;, &#39;LED-RGB1&#39;, &#39;LED-V1&#39;, &#39;LED-V2&#39;, &#39;ID65&#39;, &#39;ID50&#39;, &#39;ISO 7589 Photographic Daylight&#39;, &#39;ISO 7589 Sensitometric Daylight&#39;, &#39;ISO 7589 Studio Tungsten&#39;, &#39;ISO 7589 Sensitometric Studio Tungsten&#39;, &#39;ISO 7589 Photoflood&#39;, &#39;ISO 7589 Sensitometric Photoflood&#39;, &#39;ISO 7589 Sensitometric Printer&#39;]</span>

<span class="sd">        observer : Optional[str], optional</span>
<span class="sd">            Standard observer in degree, by default &#39;10&#39;</span>
<span class="sd">            It can be either &#39;2&#39; or &#39;10&#39;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple</span>
<span class="sd">            It returns a tuple with two set of values: the chromaticity coordinates of the illuminants (CCS) and the spectral distribution of the illuminants (SDS).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">observers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;10&#39;</span><span class="p">:</span> <span class="s2">&quot;cie_10_1964&quot;</span><span class="p">,</span>
            <span class="s1">&#39;2&#39;</span> <span class="p">:</span> <span class="s2">&quot;cie_2_1931&quot;</span>
        <span class="p">}</span>

        <span class="n">CCS</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">CCS_ILLUMINANTS</span><span class="p">[</span><span class="n">observers</span><span class="p">[</span><span class="n">observer</span><span class="p">]][</span><span class="n">illuminant</span><span class="p">]</span>
        <span class="n">SDS</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">SDS_ILLUMINANTS</span><span class="p">[</span><span class="n">illuminant</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">CCS</span><span class="p">,</span> <span class="n">SDS</span>


    <span class="k">def</span> <span class="nf">get_observer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observer</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;10&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the observer.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        observer : Optional[str], optional</span>
<span class="sd">            Standard observer in degree, by default &#39;10&#39;</span>
<span class="sd">            It can be either &#39;2&#39; or &#39;10&#39;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------        </span>
<span class="sd">            Returns the x_bar,  y_bar, z_bar spectra between 360 and 830 nm.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">observers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;10&#39;</span><span class="p">:</span> <span class="s2">&quot;CIE 1964 10 Degree Standard Observer&quot;</span><span class="p">,</span>
            <span class="s1">&#39;2&#39;</span> <span class="p">:</span> <span class="s2">&quot;CIE 1931 2 Degree Standard Observer&quot;</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="n">observers</span><span class="p">[</span><span class="n">observer</span><span class="p">]]</span>   


    <span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">xarray</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve the microfading data.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data : str|list, optional</span>
<span class="sd">            Possibility to select the type of data, by default &#39;all&#39;.</span>
<span class="sd">            When &#39;all&#39;, it returns all the data (spectral and colorimetric).</span>
<span class="sd">            When &#39;sp&#39;, it only returns the spectral data.</span>
<span class="sd">            When &#39;cl&#39;, it only returns the colorimetric data.  </span>
<span class="sd">            When &#39;Lab&#39;, it returns the CIE L*a*b* values.</span>
<span class="sd">            A list of strings can be entered to select specific colourimetric data among the following: [&#39;dE76,&#39;dE00&#39;,&#39;dR_vis&#39;, &#39;L*&#39;, &#39;a*&#39;, &#39;b*&#39;, &#39;C*&#39;, &#39;h&#39;].</span>

<span class="sd">        xarray : bool, optional</span>
<span class="sd">            When True, the data are returned as an xarray.Dataset object, else as pandas dataframe object, by default False.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        It returns a list of pandas dataframes or xarray.Dataset objects</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">all_files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_files</span><span class="p">(</span><span class="n">sheets</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;spectra&#39;</span><span class="p">,</span><span class="s1">&#39;CIELAB&#39;</span><span class="p">])</span>
        <span class="n">all_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">data_sp</span> <span class="o">=</span> <span class="p">[]</span> 
        <span class="n">data_cl</span> <span class="o">=</span> <span class="p">[]</span> 

        <span class="k">for</span> <span class="n">data_file</span> <span class="ow">in</span> <span class="n">all_files</span><span class="p">:</span>

            <span class="n">df_sp</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">df_cl</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

            <span class="k">if</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">df_sp</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">]:</span>
                <span class="n">sp_n</span> <span class="o">=</span> <span class="n">df_sp</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
                <span class="n">sp_s</span> <span class="o">=</span> <span class="n">df_sp</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

                <span class="n">L_n</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;L*&quot;</span><span class="p">,</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="n">a_n</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;a*&quot;</span><span class="p">,</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="n">b_n</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;b*&quot;</span><span class="p">,</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="n">C_n</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;C*&quot;</span><span class="p">,</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="n">h_n</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;h&quot;</span><span class="p">,</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="n">dE76_n</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;dE76&quot;</span><span class="p">,</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="n">dE00_n</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;dE00&quot;</span><span class="p">,</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="n">dR_vis_n</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;dR_vis&quot;</span><span class="p">,</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

                <span class="n">L_s</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;L*&quot;</span><span class="p">,</span><span class="s2">&quot;std&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="n">a_s</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;a*&quot;</span><span class="p">,</span><span class="s2">&quot;std&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="n">b_s</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;b*&quot;</span><span class="p">,</span><span class="s2">&quot;std&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="n">C_s</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;C*&quot;</span><span class="p">,</span><span class="s2">&quot;std&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="n">h_s</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;h&quot;</span><span class="p">,</span><span class="s2">&quot;std&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="n">dE76_s</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;dE76&quot;</span><span class="p">,</span><span class="s2">&quot;std&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="n">dE00_s</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;dE00&quot;</span><span class="p">,</span><span class="s2">&quot;std&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="n">dR_vis_s</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;dR_vis&quot;</span><span class="p">,</span><span class="s2">&quot;std&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">sp_n</span> <span class="o">=</span> <span class="n">df_sp</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
                <span class="n">sp_s</span> <span class="o">=</span> <span class="n">df_sp</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">sp_s</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,:]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">sp_s</span> <span class="o">=</span> <span class="n">sp_s</span><span class="o">.</span><span class="n">values</span>

                <span class="n">L_n</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;L*&quot;</span><span class="p">,</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="n">a_n</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;a*&quot;</span><span class="p">,</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="n">b_n</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;b*&quot;</span><span class="p">,</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="n">C_n</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;C*&quot;</span><span class="p">,</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="n">h_n</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;h&quot;</span><span class="p">,</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="n">dE76_n</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;dE76&quot;</span><span class="p">,</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="n">dE00_n</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;dE00&quot;</span><span class="p">,</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="n">dR_vis_n</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;dR_vis&quot;</span><span class="p">,</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

                <span class="n">L_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">L_n</span><span class="p">))</span>
                <span class="n">a_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a_n</span><span class="p">))</span>
                <span class="n">b_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">b_n</span><span class="p">))</span>
                <span class="n">C_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">C_n</span><span class="p">))</span>
                <span class="n">h_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h_n</span><span class="p">))</span>
                <span class="n">dE76_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dE76_n</span><span class="p">))</span>
                <span class="n">dE00_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dE00_n</span><span class="p">))</span>
                <span class="n">dR_vis_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dR_vis_n</span><span class="p">))</span>

            <span class="n">wl</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">He</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">Hv</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;t_sec&#39;</span><span class="p">,</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

            <span class="n">spectral_data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s1">&#39;sp&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;wavelength&#39;</span><span class="p">,</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">sp_n</span><span class="p">),</span>
                    <span class="s1">&#39;sp_s&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;wavelength&#39;</span><span class="p">,</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">sp_s</span><span class="p">)</span>                
                <span class="p">},</span>
                <span class="n">coords</span><span class="o">=</span><span class="p">{</span>
                    <span class="s1">&#39;wavelength&#39;</span><span class="p">:</span> <span class="n">wl</span><span class="p">,</span>   
                    <span class="s1">&#39;dose&#39;</span><span class="p">:</span> <span class="n">He</span><span class="p">,</span>
                    <span class="s1">&#39;He&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;dose&#39;</span><span class="p">,</span> <span class="n">He</span><span class="p">),</span>
                    <span class="s1">&#39;Hv&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;dose&#39;</span><span class="p">,</span> <span class="n">Hv</span><span class="p">),</span>  <span class="c1"># Match radiant energy</span>
                    <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;dose&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>  <span class="c1"># Match radiant energy</span>
                <span class="p">}</span>
            <span class="p">)</span>

            <span class="n">color_data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s1">&#39;L*&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">L_n</span><span class="p">),</span>
                    <span class="s1">&#39;a*&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">a_n</span><span class="p">),</span>
                    <span class="s1">&#39;b*&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">b_n</span><span class="p">),</span>
                    <span class="s1">&#39;C*&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">C_n</span><span class="p">),</span>
                    <span class="s1">&#39;h&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">h_n</span><span class="p">),</span>
                    <span class="s1">&#39;dE76&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">dE76_n</span><span class="p">),</span>
                    <span class="s1">&#39;dE00&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">dE00_n</span><span class="p">),</span>
                    <span class="s1">&#39;dR_vis&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">dR_vis_n</span><span class="p">),</span>
                    <span class="s1">&#39;L*_s&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">L_s</span><span class="p">),</span>
                    <span class="s1">&#39;a*_s&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">a_s</span><span class="p">),</span>
                    <span class="s1">&#39;b*_s&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">b_s</span><span class="p">),</span>
                    <span class="s1">&#39;C*_s&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">C_s</span><span class="p">),</span>
                    <span class="s1">&#39;h_s&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">h_s</span><span class="p">),</span>
                    <span class="s1">&#39;dE76_s&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">dE76_s</span><span class="p">),</span>
                    <span class="s1">&#39;dE00_s&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">dE00_s</span><span class="p">),</span>
                    <span class="s1">&#39;dR_vis_s&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">dR_vis_s</span><span class="p">),</span>
                <span class="p">},</span>
                <span class="n">coords</span><span class="o">=</span><span class="p">{</span>                    
                    <span class="s1">&#39;He&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;dose&#39;</span><span class="p">,</span><span class="n">He</span><span class="p">),</span>
                    <span class="s1">&#39;Hv&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;dose&#39;</span><span class="p">,</span><span class="n">Hv</span><span class="p">),</span>
                    <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;dose&#39;</span><span class="p">,</span><span class="n">t</span><span class="p">),</span>
                <span class="p">}</span>
            <span class="p">)</span>                

            <span class="n">sp</span> <span class="o">=</span> <span class="n">spectral_data</span><span class="o">.</span><span class="n">set_xindex</span><span class="p">([</span><span class="s2">&quot;He&quot;</span><span class="p">,</span><span class="s2">&quot;Hv&quot;</span><span class="p">,</span><span class="s2">&quot;t&quot;</span><span class="p">])</span>
            <span class="n">cl</span> <span class="o">=</span> <span class="n">color_data</span><span class="o">.</span><span class="n">set_xindex</span><span class="p">([</span><span class="s2">&quot;He&quot;</span><span class="p">,</span><span class="s2">&quot;Hv&quot;</span><span class="p">,</span><span class="s2">&quot;t&quot;</span><span class="p">])</span>
            <span class="n">combined_data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">sp</span><span class="p">,</span> <span class="n">cl</span><span class="p">])</span>

        <span class="n">all_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">combined_data</span><span class="p">)</span>            


        <span class="k">if</span> <span class="n">data</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">xarray</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>                
                <span class="p">[</span><span class="n">data_sp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_files</span><span class="p">]</span>
                <span class="p">[</span><span class="n">data_cl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_files</span><span class="p">]</span>
                <span class="k">return</span> <span class="n">data_sp</span><span class="p">,</span> <span class="n">data_cl</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">all_data</span>

        <span class="k">elif</span> <span class="n">data</span> <span class="o">==</span> <span class="s1">&#39;sp&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">xarray</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>                
                <span class="p">[</span><span class="n">data_sp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_files</span><span class="p">]</span>                                           
            <span class="k">else</span><span class="p">:</span>                
                <span class="n">data_sp</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">sp</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_data</span><span class="p">]</span>


            <span class="k">return</span> <span class="n">data_sp</span>

        <span class="k">elif</span> <span class="n">data</span> <span class="o">==</span> <span class="s1">&#39;cl&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">xarray</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                <span class="p">[</span><span class="n">data_cl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_files</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">data_cl</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span><span class="s1">&#39;b*&#39;</span><span class="p">,</span><span class="s1">&#39;C*&#39;</span><span class="p">,</span><span class="s1">&#39;h&#39;</span><span class="p">,</span><span class="s1">&#39;dE76&#39;</span><span class="p">,</span><span class="s1">&#39;dE00&#39;</span><span class="p">,</span><span class="s1">&#39;dR_vis&#39;</span><span class="p">]]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_data</span><span class="p">]</span>

            <span class="k">return</span> <span class="n">data_cl</span>

        <span class="k">elif</span> <span class="n">data</span> <span class="o">==</span> <span class="s1">&#39;Lab&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">xarray</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                <span class="p">[</span><span class="n">data_cl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">][[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span><span class="s1">&#39;b*&#39;</span><span class="p">]])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_files</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">data_cl</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span><span class="s1">&#39;b*&#39;</span><span class="p">]]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_data</span><span class="p">]</span>

            <span class="k">return</span> <span class="n">data_cl</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">xarray</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">dic_doses</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;He&#39;</span><span class="p">:</span> <span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;Hv&#39;</span><span class="p">:</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span><span class="s1">&#39;t_sec&#39;</span><span class="p">}</span>
                <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">dic_doses</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dic_doses</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
                <span class="p">[</span><span class="n">data_cl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">data</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_files</span><span class="p">]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">elem</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">if</span> <span class="n">elem</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Hv&#39;</span><span class="p">,</span><span class="s1">&#39;He&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">]]</span>
                <span class="n">data_cl</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">data</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_data</span><span class="p">]</span>

            <span class="k">return</span> <span class="n">data_cl</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Enter a valid data parameter. It can either be a string (&#39;sp&#39;, &#39;cl&#39;, &#39;Lab&#39;, &#39;all&#39;) or a list of strings [&#39;dE00&#39;,&#39;dE76&#39;, &#39;L*&#39;, &#39;a*&#39;, &#39;b*&#39;, &#39;C*&#39;, &#39;h&#39;]&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>


    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve the metadata.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        labels : Optional[list], optional</span>
<span class="sd">            A list of strings corresponding to the wanted metadata labels, by default &#39;all&#39;</span>
<span class="sd">            The metadata labels can be found in the &#39;info&#39; sheet of microfading excel files.</span>
<span class="sd">            When &#39;all&#39;, it returns all the metadata</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas dataframe</span>
<span class="sd">            It returns the metadata inside a pandas dataframe where each column corresponds to a single file.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_files</span><span class="p">()</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df</span><span class="p">]</span>

        <span class="n">df_metadata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;parameter&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">metadata</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;parameter&#39;</span><span class="p">)</span>
            <span class="n">Id</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;meas_id&#39;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>

            <span class="n">df_metadata</span><span class="p">[</span><span class="n">Id</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">labels</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">df_metadata</span>

        <span class="k">else</span><span class="p">:</span>            
            <span class="k">return</span> <span class="n">df_metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">labels</span><span class="p">]</span>     


    <span class="k">def</span> <span class="nf">get_Lab</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">illuminant</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">dose_unit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">dose_values</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve the CIE L*a*b* values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        illuminant : (str, optional)  </span>
<span class="sd">            Reference *illuminant* (&#39;D65&#39;, or &#39;D50&#39;). by default &#39;default&#39;.</span>
<span class="sd">            When &#39;default&#39;, it fetches the illuminant value recorded in the db_config.json file of the package. If no value has been recorded, then it sets the illuminant value to &#39;D65&#39;.</span>

<span class="sd">        observer : (str|int, optional)</span>
<span class="sd">            Reference *observer* in degree (&#39;10&#39; or &#39;2&#39;). by default &#39;default&#39;.</span>
<span class="sd">            When &#39;default&#39;, it fetches the observer value recorded in the db_config.json file of the package. If no value has been recorded, then it sets the observer value to &#39;10&#39;.</span>

<span class="sd">        dose_unit : Optional[str], optional</span>
<span class="sd">            Unit of the light dose energy, by default [&#39;He&#39;]</span>
<span class="sd">            Any of the following units can be entered: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec)</span>

<span class="sd">        dose_values : Union[int, float, list, tuple], optional</span>
<span class="sd">            Dose values for which the colourimetric values will be returned, by default &#39;all&#39;</span>
<span class="sd">            When &#39;all&#39;, it returns the colourimetric values for all the dose values available in the given input data files.</span>
<span class="sd">            A single dose value (an integer or a float number) can be entered.</span>
<span class="sd">            A list of dose values, as integer or float, can also be entered.</span>
<span class="sd">            A tuple of three values (min, max, step) will be used in a numpy.arange() function to return an array of dose values. </span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas dataframe</span>
<span class="sd">            It returns the L*a*b* values inside a dataframe where each column corresponds to a single file.</span>
<span class="sd">        &quot;&quot;&quot;</span>    
        <span class="n">DB</span> <span class="o">=</span> <span class="n">databases</span><span class="o">.</span><span class="n">DB</span><span class="p">()</span>


        <span class="c1"># Set the observer value</span>
        <span class="k">if</span> <span class="n">observer</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">observer</span> <span class="o">=</span> <span class="s1">&#39;10deg&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">observer</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;observer&#39;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">observer</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">observer</span><span class="p">)</span><span class="si">}</span><span class="s1">deg&#39;</span>


        <span class="c1"># Set the illuminant value</span>
        <span class="k">if</span> <span class="n">illuminant</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">illuminant</span> <span class="o">=</span> <span class="s1">&#39;D65&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">illuminant</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;illuminant&#39;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>


        <span class="c1"># Get colorimetric data related to the standard observer</span>
        <span class="n">observers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;10deg&#39;</span><span class="p">:</span> <span class="s1">&#39;cie_10_1964&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2deg&#39;</span> <span class="p">:</span> <span class="s1">&#39;cie_2_1931&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">cmfs_observers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;10deg&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1964 10 Degree Standard Observer&quot;</span><span class="p">],</span>
            <span class="s1">&#39;2deg&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1931 2 Degree Standard Observer&quot;</span><span class="p">]</span> 
            <span class="p">}</span>

        <span class="n">ccs_ill</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">CCS_ILLUMINANTS</span><span class="p">[</span><span class="n">observers</span><span class="p">[</span><span class="n">observer</span><span class="p">]][</span><span class="n">illuminant</span><span class="p">]</span>


        <span class="n">meas_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_meas_ids</span>               
        <span class="n">df_sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_spectra</span><span class="p">(</span><span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span> <span class="n">dose_values</span><span class="o">=</span><span class="n">dose_values</span><span class="p">)</span>   
        <span class="n">df_sp_nominal</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span><span class="p">[:,</span> <span class="s1">&#39;mean&#39;</span><span class="p">]]</span> <span class="k">if</span> <span class="s1">&#39;mean&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span><span class="p">[:,</span> <span class="s1">&#39;value&#39;</span><span class="p">]]</span>
            <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">df_sp</span>
        <span class="p">]</span>

        <span class="n">df_Lab</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">df</span><span class="p">,</span> <span class="n">meas_id</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df_sp_nominal</span><span class="p">,</span> <span class="n">meas_ids</span><span class="p">):</span>   

            <span class="n">Lab_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span><span class="s1">&#39;b*&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>           

            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>

                <span class="n">sp</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
                <span class="n">wl</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>
                <span class="n">sd</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">SpectralDistribution</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">wl</span><span class="p">)</span>                

                <span class="n">XYZ</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">sd_to_XYZ</span><span class="p">(</span><span class="n">sd</span><span class="p">,</span><span class="n">cmfs_observers</span><span class="p">[</span><span class="n">observer</span><span class="p">],</span> <span class="n">illuminant</span><span class="o">=</span><span class="n">colour</span><span class="o">.</span><span class="n">SDS_ILLUMINANTS</span><span class="p">[</span><span class="n">illuminant</span><span class="p">])</span>        
                <span class="n">Lab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">colour</span><span class="o">.</span><span class="n">XYZ_to_Lab</span><span class="p">(</span><span class="n">XYZ</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span><span class="n">ccs_ill</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>               
                <span class="n">Lab_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">Lab_values</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">Lab</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span><span class="s1">&#39;b*&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">Lab_values</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Lab_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="n">Lab_values</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="n">meas_id</span><span class="p">],</span> <span class="n">Lab_values</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>  
            <span class="n">df_Lab</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Lab_values</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_Lab</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>           


    <span class="k">def</span> <span class="nf">get_doses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dose_unit</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">max_doses</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve the light energy doses related to each microfading measurement.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dose_unit : Union[str,list], optional</span>
<span class="sd">            Unit of the light dose energy, by default &#39;all&#39;</span>
<span class="sd">            Any of the following units can be added to the list: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec). When a single unit is requested, it can be given as a string value (&#39;He&#39;, &#39;Hv&#39;, or &#39;t&#39;).</span>

<span class="sd">        max_doses : bool, optional</span>
<span class="sd">            Whether to return the maximum light dose values, by default False.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list of pandas dataframes</span>
<span class="sd">            _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;cl&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">dose_unit</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
            <span class="n">doses</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[[</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;t_sec&#39;</span><span class="p">]]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">doses_dic</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;He&#39;</span><span class="p">:</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;Hv&#39;</span><span class="p">:</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span><span class="s1">&#39;t_sec&#39;</span><span class="p">}</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dose_unit</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">dose_unit</span> <span class="o">=</span> <span class="p">[</span><span class="n">doses_dic</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dose_unit</span><span class="p">]</span> 
                <span class="n">doses</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">doses</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">doses_dic</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">]]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">max_doses</span><span class="p">:</span>
            <span class="n">doses</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">doses</span><span class="p">]</span>


        <span class="k">return</span> <span class="n">doses</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">get_meas_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the measurement id numbers corresponding to the input files.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()</span>        
        <span class="k">return</span> <span class="n">info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;meas_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">get_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the object id numbers corresponding to the input files.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">metadata_parameters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()</span><span class="o">.</span><span class="n">index</span>

        <span class="k">if</span> <span class="s1">&#39;object_id&#39;</span> <span class="ow">in</span> <span class="n">metadata_parameters</span><span class="p">:</span>

            <span class="n">df_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object_id&#39;</span><span class="p">])</span>
            <span class="n">objects</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">df_info</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

            <span class="k">return</span> <span class="n">objects</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The info tab of the microfading interim file(s) </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="si">}</span><span class="s1"> does not contain an object_id parameter.&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>


    <span class="k">def</span> <span class="nf">get_sRGB</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">illuminant</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">dose_unit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">dose_values</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">clip</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the sRGB values. </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        illuminant : (str, optional)  </span>
<span class="sd">            Reference *illuminant* (&#39;D65&#39;, or &#39;D50&#39;). by default &#39;default&#39;.</span>
<span class="sd">            When &#39;default&#39;, it fetches the illuminant value recorded in the db_config.json file of the package. If no value has been recorded, then it sets the illuminant value to &#39;D65&#39;.</span>

<span class="sd">        observer : (str|int, optional)</span>
<span class="sd">            Reference *observer* in degree (&#39;10&#39; or &#39;2&#39;). by default &#39;default&#39;.</span>
<span class="sd">            When &#39;default&#39;, it fetches the observer value recorded in the db_config.json file of the package. If no value has been recorded, then it sets the observer value to &#39;10&#39;.</span>

<span class="sd">        dose_unit : Optional[str], optional</span>
<span class="sd">            Unit of the light dose energy, by default [&#39;He&#39;]</span>
<span class="sd">            Any of the following units can be entered: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec)</span>

<span class="sd">        dose_values : Union[int, float, list, tuple], optional</span>
<span class="sd">            Dose values for which the colourimetric values will be returned, by default &#39;all&#39;</span>
<span class="sd">            When &#39;all&#39;, it returns the colourimetric values for all the dose values available in the given input data files.</span>
<span class="sd">            A single dose value (an integer or a float number) can be entered.</span>
<span class="sd">            A list of dose values, as integer or float, can also be entered.</span>
<span class="sd">            A tuple of three values (min, max, step) will be used in a numpy.arange() function to return an array of dose values. </span>

<span class="sd">        clip : Optional[bool], optional</span>
<span class="sd">            Whether to constraint the srgb values between 0 and 1.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas dataframe</span>
<span class="sd">            It returns the sRGB values inside a dataframe where each column corresponds to a single file.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">DB</span> <span class="o">=</span> <span class="n">databases</span><span class="o">.</span><span class="n">DB</span><span class="p">()</span>


        <span class="c1"># Set the observer value</span>
        <span class="k">if</span> <span class="n">observer</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">observer</span> <span class="o">=</span> <span class="s1">&#39;10deg&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">observer</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;observer&#39;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">observer</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">observer</span><span class="p">)</span><span class="si">}</span><span class="s1">deg&#39;</span>

        <span class="c1"># Set the illuminant value</span>
        <span class="k">if</span> <span class="n">illuminant</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">illuminant</span> <span class="o">=</span> <span class="s1">&#39;D65&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">illuminant</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;illuminant&#39;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>


        <span class="c1"># Get colorimetric data related to the standard observer</span>
        <span class="n">observers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;10deg&#39;</span><span class="p">:</span> <span class="s1">&#39;cie_10_1964&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2deg&#39;</span> <span class="p">:</span> <span class="s1">&#39;cie_2_1931&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">cmfs_observers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;10deg&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1964 10 Degree Standard Observer&quot;</span><span class="p">],</span>
            <span class="s1">&#39;2deg&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1931 2 Degree Standard Observer&quot;</span><span class="p">]</span> 
            <span class="p">}</span>

        <span class="n">ccs_ill</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">CCS_ILLUMINANTS</span><span class="p">[</span><span class="n">observers</span><span class="p">[</span><span class="n">observer</span><span class="p">]][</span><span class="n">illuminant</span><span class="p">]</span>

        <span class="n">meas_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_meas_ids</span> 

        <span class="n">df_sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_spectra</span><span class="p">(</span><span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span> <span class="n">dose_values</span><span class="o">=</span><span class="n">dose_values</span><span class="p">)</span>   
        <span class="n">df_sp_nominal</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span><span class="p">[:,</span> <span class="s1">&#39;mean&#39;</span><span class="p">]]</span> <span class="k">if</span> <span class="s1">&#39;mean&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span><span class="p">[:,</span> <span class="s1">&#39;value&#39;</span><span class="p">]]</span>
            <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">df_sp</span>
        <span class="p">]</span> 

        <span class="n">df_srgb</span> <span class="o">=</span> <span class="p">[]</span>


        <span class="k">for</span> <span class="n">df</span><span class="p">,</span> <span class="n">meas_id</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df_sp_nominal</span><span class="p">,</span> <span class="n">meas_ids</span><span class="p">):</span>

            <span class="n">srgb_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>            

            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>

                <span class="n">sp</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
                <span class="n">wl</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>
                <span class="n">sd</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">SpectralDistribution</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">wl</span><span class="p">)</span>                

                <span class="n">XYZ</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">sd_to_XYZ</span><span class="p">(</span><span class="n">sd</span><span class="p">,</span><span class="n">cmfs_observers</span><span class="p">[</span><span class="n">observer</span><span class="p">],</span> <span class="n">illuminant</span><span class="o">=</span><span class="n">colour</span><span class="o">.</span><span class="n">SDS_ILLUMINANTS</span><span class="p">[</span><span class="n">illuminant</span><span class="p">])</span> 
                <span class="n">srgb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">colour</span><span class="o">.</span><span class="n">XYZ_to_sRGB</span><span class="p">(</span><span class="n">XYZ</span> <span class="o">/</span> <span class="mi">100</span><span class="p">,</span> <span class="n">illuminant</span><span class="o">=</span><span class="n">ccs_ill</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>                        
                <span class="n">srgb_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">srgb_values</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">srgb</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">srgb_values</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">srgb_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="n">srgb_values</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="n">meas_id</span><span class="p">],</span> <span class="n">srgb_values</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">clip</span><span class="p">:</span>
                <span class="n">srgb_values</span> <span class="o">=</span> <span class="n">srgb_values</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">df_srgb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">srgb_values</span><span class="p">)</span>


        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_srgb</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">get_wavelength</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the wavelength range of the microfading measurements.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;sp&#39;</span><span class="p">)</span>

        <span class="n">wavelengths</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">wavelengths</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_meas_ids</span>

        <span class="k">return</span> <span class="n">wavelengths</span>


    <span class="k">def</span> <span class="nf">get_XYZ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">illuminant</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">dose_unit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">dose_values</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the XYZ values. </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        illuminant : (str, optional)  </span>
<span class="sd">            Reference *illuminant* (&#39;D65&#39;, or &#39;D50&#39;). by default &#39;default&#39;.</span>
<span class="sd">            When &#39;default&#39;, it fetches the illuminant value recorded in the db_config.json file of the package. If no value has been recorded, then it sets the illuminant value to &#39;D65&#39;.</span>

<span class="sd">        observer : (str|int, optional)</span>
<span class="sd">            Reference *observer* in degree (&#39;10&#39; or &#39;2&#39;). by default &#39;default&#39;.</span>
<span class="sd">            When &#39;default&#39;, it fetches the observer value recorded in the db_config.json file of the package. If no value has been recorded, then it sets the observer value to &#39;10&#39;.</span>

<span class="sd">        dose_unit : Optional[str], optional</span>
<span class="sd">            Unit of the light dose energy, by default [&#39;He&#39;]</span>
<span class="sd">            Any of the following units can be entered: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec)</span>

<span class="sd">        dose_values : Union[int, float, list, tuple], optional</span>
<span class="sd">            Dose values for which the colourimetric values will be returned, by default &#39;all&#39;</span>
<span class="sd">            When &#39;all&#39;, it returns the colourimetric values for all the dose values available in the given input data files.</span>
<span class="sd">            A single dose value (an integer or a float number) can be entered.</span>
<span class="sd">            A list of dose values, as integer or float, can also be entered.</span>
<span class="sd">            A tuple of three values (min, max, step) will be used in a numpy.arange() function to return an array of dose values. </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas dataframe</span>
<span class="sd">            It returns the XYZ values inside a dataframe where each column corresponds to a single file.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">DB</span> <span class="o">=</span> <span class="n">databases</span><span class="o">.</span><span class="n">DB</span><span class="p">()</span>

        <span class="c1"># Set the observer value</span>
        <span class="k">if</span> <span class="n">observer</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">observer</span> <span class="o">=</span> <span class="s1">&#39;10deg&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">observer</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;observer&#39;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">observer</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">observer</span><span class="p">)</span><span class="si">}</span><span class="s1">deg&#39;</span>


        <span class="c1"># Set the illuminant value</span>
        <span class="k">if</span> <span class="n">illuminant</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">illuminant</span> <span class="o">=</span> <span class="s1">&#39;D65&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">illuminant</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;illuminant&#39;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>               


        <span class="c1"># Get colorimetric data related to the standard observer</span>
        <span class="n">cmfs_observers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;10deg&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1964 10 Degree Standard Observer&quot;</span><span class="p">],</span>
            <span class="s1">&#39;2deg&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1931 2 Degree Standard Observer&quot;</span><span class="p">]</span> 
            <span class="p">}</span> 

        <span class="n">meas_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_meas_ids</span>                
        <span class="n">df_sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_spectra</span><span class="p">(</span><span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span> <span class="n">dose_values</span><span class="o">=</span><span class="n">dose_values</span><span class="p">)</span>   
        <span class="n">df_sp_nominal</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span><span class="p">[:,</span> <span class="s1">&#39;mean&#39;</span><span class="p">]]</span> <span class="k">if</span> <span class="s1">&#39;mean&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span><span class="p">[:,</span> <span class="s1">&#39;value&#39;</span><span class="p">]]</span>
            <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">df_sp</span>
        <span class="p">]</span> 

        <span class="n">df_XYZ</span> <span class="o">=</span> <span class="p">[]</span>


        <span class="k">for</span> <span class="n">df</span><span class="p">,</span> <span class="n">meas_id</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df_sp_nominal</span><span class="p">,</span> <span class="n">meas_ids</span><span class="p">):</span>

            <span class="n">XYZ_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>

            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>

                <span class="n">sp</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
                <span class="n">wl</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>
                <span class="n">sd</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">SpectralDistribution</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">wl</span><span class="p">)</span>                

                <span class="n">XYZ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">colour</span><span class="o">.</span><span class="n">sd_to_XYZ</span><span class="p">(</span><span class="n">sd</span><span class="p">,</span><span class="n">cmfs_observers</span><span class="p">[</span><span class="n">observer</span><span class="p">],</span> <span class="n">illuminant</span><span class="o">=</span><span class="n">colour</span><span class="o">.</span><span class="n">SDS_ILLUMINANTS</span><span class="p">[</span><span class="n">illuminant</span><span class="p">]),</span><span class="mi">3</span><span class="p">)</span>
                <span class="n">XYZ_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">XYZ_values</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">XYZ</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">XYZ_values</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">XYZ_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="n">XYZ_values</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="n">meas_id</span><span class="p">],</span> <span class="n">XYZ_values</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>
            <span class="n">df_XYZ</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XYZ_values</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_XYZ</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">illuminant</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">dose_unit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">dose_values</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the xy values. </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        illuminant : (str, optional)  </span>
<span class="sd">            Reference *illuminant* (&#39;D65&#39;, or &#39;D50&#39;). by default &#39;default&#39;.</span>
<span class="sd">            When &#39;default&#39;, it fetches the illuminant value recorded in the db_config.json file of the package. If no value has been recorded, then it sets the illuminant value to &#39;D65&#39;.</span>

<span class="sd">        observer : (str|int, optional)</span>
<span class="sd">            Reference *observer* in degree (&#39;10&#39; or &#39;2&#39;). by default &#39;default&#39;.</span>
<span class="sd">            When &#39;default&#39;, it fetches the observer value recorded in the db_config.json file of the package. If no value has been recorded, then it sets the observer value to &#39;10&#39;.</span>

<span class="sd">        dose_unit : Optional[str], optional</span>
<span class="sd">            Unit of the light dose energy, by default [&#39;He&#39;]</span>
<span class="sd">            Any of the following units can be entered: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec)</span>

<span class="sd">        dose_values : Union[int, float, list, tuple], optional</span>
<span class="sd">            Dose values for which the colourimetric values will be returned, by default &#39;all&#39;</span>
<span class="sd">            When &#39;all&#39;, it returns the colourimetric values for all the dose values available in the given input data files.</span>
<span class="sd">            A single dose value (an integer or a float number) can be entered.</span>
<span class="sd">            A list of dose values, as integer or float, can also be entered.</span>
<span class="sd">            A tuple of three values (min, max, step) will be used in a numpy.arange() function to return an array of dose values. </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas dataframe</span>
<span class="sd">            It returns the xy values inside a dataframe where each column corresponds to a single file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">DB</span> <span class="o">=</span> <span class="n">databases</span><span class="o">.</span><span class="n">DB</span><span class="p">()</span>

        <span class="c1"># Set the observer value</span>
        <span class="k">if</span> <span class="n">observer</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">observer</span> <span class="o">=</span> <span class="s1">&#39;10deg&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">observer</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;observer&#39;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">observer</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">observer</span><span class="p">)</span><span class="si">}</span><span class="s1">deg&#39;</span>


        <span class="c1"># Set the illuminant value</span>
        <span class="k">if</span> <span class="n">illuminant</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">illuminant</span> <span class="o">=</span> <span class="s1">&#39;D65&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">illuminant</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;illuminant&#39;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>               


        <span class="c1"># Get colorimetric data related to the standard observer</span>
        <span class="n">cmfs_observers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;10deg&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1964 10 Degree Standard Observer&quot;</span><span class="p">],</span>
            <span class="s1">&#39;2deg&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1931 2 Degree Standard Observer&quot;</span><span class="p">]</span> 
            <span class="p">}</span>       


        <span class="n">meas_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_meas_ids</span>                
        <span class="n">df_sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_spectra</span><span class="p">(</span><span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span> <span class="n">dose_values</span><span class="o">=</span><span class="n">dose_values</span><span class="p">)</span>   
        <span class="n">df_sp_nominal</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span><span class="p">[:,</span> <span class="s1">&#39;mean&#39;</span><span class="p">]]</span> <span class="k">if</span> <span class="s1">&#39;mean&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span><span class="p">[:,</span> <span class="s1">&#39;value&#39;</span><span class="p">]]</span>
            <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">df_sp</span>
        <span class="p">]</span>     
        <span class="n">df_xy</span> <span class="o">=</span> <span class="p">[]</span>


        <span class="k">for</span> <span class="n">df</span><span class="p">,</span> <span class="n">meas_id</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df_sp_nominal</span><span class="p">,</span> <span class="n">meas_ids</span><span class="p">):</span>

            <span class="n">xy_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>           

            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>

                <span class="n">sp</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
                <span class="n">wl</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>
                <span class="n">sd</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">SpectralDistribution</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">wl</span><span class="p">)</span>                

                <span class="n">XYZ</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">sd_to_XYZ</span><span class="p">(</span><span class="n">sd</span><span class="p">,</span><span class="n">cmfs_observers</span><span class="p">[</span><span class="n">observer</span><span class="p">],</span> <span class="n">illuminant</span><span class="o">=</span><span class="n">colour</span><span class="o">.</span><span class="n">SDS_ILLUMINANTS</span><span class="p">[</span><span class="n">illuminant</span><span class="p">])</span>
                <span class="n">xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">colour</span><span class="o">.</span><span class="n">XYZ_to_xy</span><span class="p">(</span><span class="n">XYZ</span><span class="p">),</span><span class="mi">4</span><span class="p">)</span>
                <span class="n">xy_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">xy_values</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">xy_values</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">xy_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="n">xy_values</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="n">meas_id</span><span class="p">],</span> <span class="n">xy_values</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>
            <span class="n">df_xy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xy_values</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_xy</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">plots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plots</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CIELAB&#39;</span><span class="p">,</span> <span class="s1">&#39;SP&#39;</span><span class="p">,</span> <span class="s1">&#39;SW&#39;</span><span class="p">,</span> <span class="s1">&#39;dE&#39;</span><span class="p">,</span> <span class="s1">&#39;dLab&#39;</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create plots</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        plots : list, optional</span>
<span class="sd">            _description_, by default [&#39;CIELAB&#39;, &#39;SP&#39;, &#39;SW&#39;, &#39;dE&#39;, &#39;dLab&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">plot</span> <span class="ow">in</span> <span class="n">plots</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">plot</span> <span class="o">==</span> <span class="s1">&#39;CIELAB&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_CIELAB</span><span class="p">(</span><span class="n">legend_labels</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">legend_fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">plot</span> <span class="o">==</span> <span class="s1">&#39;SP&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_sp</span><span class="p">(</span><span class="n">spectra</span><span class="o">=</span><span class="s1">&#39;i+f&#39;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">plot</span> <span class="o">==</span> <span class="s1">&#39;SW&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_swatches_circle</span><span class="p">()</span>

            <span class="k">elif</span> <span class="n">plot</span> <span class="o">==</span> <span class="s1">&#39;dE&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_delta</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">plot_bars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">BWS_lines</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">coordinate</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;dE00&#39;</span><span class="p">,</span> <span class="n">dose_unit</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Hv&#39;</span><span class="p">,</span> <span class="n">dose_value</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">xlabels</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">group_objects</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span> <span class="n">rotate_xlabels</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">position_xlabels</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">position_text</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.03</span><span class="p">,</span><span class="mf">0.92</span><span class="p">),</span> <span class="n">colors</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">float</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">path_fig</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;cwd&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot a bar graph of a given colorimetric coordinate for a given light dose value.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        BWS_lines : Optional[bool], optional</span>
<span class="sd">            Whether to display the blue wool standard values as horizontal lines or as bars, by default True</span>

<span class="sd">        coordinate : Optional[str], optional</span>
<span class="sd">            Colorimetric coordinate to be displayed, by default &#39;dE00&#39;</span>
<span class="sd">            It can be any coordinates among the following list : [&#39;L*&#39;,&#39;a*&#39;,&#39;b*&#39;,&#39;C*&#39;,&#39;h&#39;,&#39;dL*&#39;,&#39;da*&#39;,&#39;db*&#39;,&#39;dC*&#39;,&#39;dh&#39;,&#39;dE76&#39;,&#39;dE00&#39;,&#39;dR_vis&#39;].</span>

<span class="sd">        dose_unit : Optional[str], optional</span>
<span class="sd">            Unit of the light energy dose, by default &#39;Hv&#39;</span>
<span class="sd">            Any of the following units can be used: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec)</span>

<span class="sd">        dose_value : Union[int, float], optional</span>
<span class="sd">            Values of the light dose energy, by default 0.5</span>

<span class="sd">        xlabels : Union[str, list], optional</span>
<span class="sd">            Values of the labels on the x-axis (one label per bar), by default &#39;default&#39;</span>
<span class="sd">            When &#39;default&#39;, it takes the measurement id as label.</span>

<span class="sd">        fontsize : Optional[int], optional</span>
<span class="sd">            Fontsize of the plot (title, ticks, and labels), by default 24</span>

<span class="sd">        rotate_xlabels : Optional[int], optional</span>
<span class="sd">            Whether to rotate the labels on the x-axis, by default 0</span>
<span class="sd">            It can be any integer value between 0 and 360.</span>

<span class="sd">        position_xlabels : Optional[str], optional</span>
<span class="sd">            Position of the labels according to each bar (&#39;center&#39;, &#39;left&#39;, &#39;right&#39;), by default &#39;center&#39;</span>

<span class="sd">        position_text : Optional[tuple], optional</span>
<span class="sd">            Position (x,y) of the text with the exposure dose value, by default (0.03,0.92)</span>

<span class="sd">        colors : Union[str,float,list], optional</span>
<span class="sd">            Colors of the bar, by default None</span>
<span class="sd">            When &#39;sample&#39;, the color of each bar will be based on srgb values computed from the reflectance values. </span>
<span class="sd">            A single string or float value can also be used to define the color of all the bars (see matplotlib colour values). </span>
<span class="sd">            A list string can also be given, in that case, the number of element in the list should be equal to the number of bars. </span>

<span class="sd">        save : bool, optional</span>
<span class="sd">            Whether to save the figure, by default False</span>

<span class="sd">        path_fig : str, optional</span>
<span class="sd">            Absolute path required to save the figure, by default &#39;cwd&#39;</span>
<span class="sd">            When &#39;cwd&#39;, it will save the figure in the current working directory.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># [&#39;L*&#39;,&#39;a*&#39;,&#39;b*&#39;,&#39;C*&#39;,&#39;h&#39;,&#39;dL*&#39;,&#39;da*&#39;,&#39;db*&#39;,&#39;dC*&#39;,&#39;dh&#39;,&#39;dE76&#39;,&#39;dE00&#39;,&#39;dR_vis&#39;]</span>

        <span class="c1"># Define the light dose value      </span>
        <span class="n">doses_dic</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;He&#39;</span><span class="p">:</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;Hv&#39;</span><span class="p">:</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span><span class="s1">&#39;t_sec&#39;</span><span class="p">}</span>
        <span class="n">max_doses</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_doses</span><span class="p">(</span><span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span> <span class="n">max_doses</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>

        <span class="k">if</span> <span class="n">dose_value</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">max_doses</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The choosen dose_value (</span><span class="si">{</span><span class="n">dose_value</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">doses_dic</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">) is bigger than one of the final dose values. Thus the dose_value has been set to </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">max_doses</span><span class="p">)</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">doses_dic</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">, which is the lowest final dose value.&#39;</span><span class="p">)</span>
            <span class="n">dose_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">max_doses</span><span class="p">)</span>


        <span class="c1"># Define the labels on the x-axis</span>
        <span class="k">if</span> <span class="n">xlabels</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
            <span class="n">xlabels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_meas_ids</span>

        <span class="k">elif</span> <span class="n">xlabels</span> <span class="o">==</span> <span class="s1">&#39;meas_nb&#39;</span><span class="p">:</span>
            <span class="n">xlabels</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_meas_ids</span><span class="p">]</span>

        <span class="k">elif</span> <span class="n">xlabels</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()</span><span class="o">.</span><span class="n">index</span> <span class="k">if</span> <span class="s1">&#39;[&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]:</span>
            <span class="n">xlabels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">xlabels</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>


        <span class="c1"># Define the colour of the bars</span>
        <span class="k">if</span> <span class="n">colors</span> <span class="o">==</span> <span class="s1">&#39;sample&#39;</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sRGB</span><span class="p">(</span><span class="n">dose_values</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">colors</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">colors</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>

        <span class="c1"># Define the objects ID</span>
        <span class="n">object_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="s1">&#39;object_id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

        <span class="c1"># Define the object name</span>
        <span class="n">object_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="s1">&#39;object_name&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

        <span class="c1"># Gather the data and relevant info inside a dataframe</span>
        <span class="n">all_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cielab</span><span class="p">(</span><span class="n">coordinates</span><span class="o">=</span><span class="p">[</span><span class="n">coordinate</span><span class="p">],</span> <span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span> <span class="n">dose_values</span><span class="o">=</span><span class="n">dose_value</span><span class="p">)</span>
        <span class="n">cl_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_data</span><span class="p">]</span>
        <span class="n">cl_data_std</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;std&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_data</span><span class="p">]</span>

        <span class="n">plot_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">cl_data</span><span class="p">,</span>
            <span class="s1">&#39;y_std&#39;</span><span class="p">:</span> <span class="n">cl_data_std</span><span class="p">,</span> 
            <span class="s1">&#39;xlabels&#39;</span><span class="p">:</span> <span class="n">xlabels</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="s1">&#39;object_type&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">object_ids</span><span class="p">,</span>
            <span class="s1">&#39;objectID&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">([</span><span class="s1">&#39;object_id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="n">colors</span>
        <span class="p">}</span>

        <span class="n">df_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">plot_data</span><span class="p">)</span>        


        <span class="c1"># Create the plot</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">font</span><span class="o">=</span><span class="s1">&#39;serif&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">BWS_lines</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>         

            <span class="n">df_BWS</span> <span class="o">=</span> <span class="n">df_data</span><span class="p">[</span><span class="n">df_data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;BWS&#39;</span><span class="p">]</span>
            <span class="n">df_data</span> <span class="o">=</span> <span class="n">df_data</span><span class="p">[</span><span class="n">df_data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;BWS&#39;</span><span class="p">]</span>
            <span class="n">object_ids</span> <span class="o">=</span> <span class="n">df_data</span><span class="p">[</span><span class="s1">&#39;objectID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

            <span class="n">ls_dic</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;BW1&#39;</span><span class="p">:</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;BW2&#39;</span><span class="p">:</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="s1">&#39;BW3&#39;</span><span class="p">:</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span><span class="s1">&#39;BW4&#39;</span><span class="p">:</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;BWS0028&#39;</span><span class="p">:</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;BWS0029&#39;</span><span class="p">:</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="s1">&#39;BWS0030&#39;</span><span class="p">:</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span><span class="s1">&#39;BWS0031&#39;</span><span class="p">:</span><span class="s1">&#39;:&#39;</span><span class="p">}</span>

            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_BWS</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">data_BWS</span> <span class="o">=</span> <span class="n">df_BWS</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>

                <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">data_BWS</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span><span class="n">ls_dic</span><span class="p">[</span><span class="n">data_BWS</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]],</span> <span class="n">label</span><span class="o">=</span><span class="n">data_BWS</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">axhspan</span><span class="p">(</span><span class="n">ymin</span><span class="o">=</span><span class="n">data_BWS</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">data_BWS</span><span class="p">[</span><span class="s1">&#39;y_std&#39;</span><span class="p">],</span> <span class="n">ymax</span><span class="o">=</span><span class="n">data_BWS</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">data_BWS</span><span class="p">[</span><span class="s1">&#39;y_std&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.75&#39;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>        


        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">df_data</span><span class="p">))</span>


        <span class="k">if</span> <span class="n">colors</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">df_data</span><span class="p">[</span><span class="s1">&#39;colors&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">group_objects</span><span class="p">:</span> 
            <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">df_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">yerr</span><span class="o">=</span><span class="n">df_data</span><span class="p">[</span><span class="s1">&#39;y_std&#39;</span><span class="p">],</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">x_ticks</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>


            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">object_ids</span><span class="p">)):</span>

                <span class="n">df_obj</span> <span class="o">=</span> <span class="n">df_data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;objectID == &quot;</span><span class="si">{</span><span class="n">obj</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>


                <span class="n">y_values</span> <span class="o">=</span> <span class="n">df_obj</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="n">meas_ids</span> <span class="o">=</span> <span class="n">df_obj</span><span class="p">[</span><span class="s1">&#39;xlabels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="n">srgb_values</span> <span class="o">=</span> <span class="n">df_obj</span><span class="p">[</span><span class="s1">&#39;colors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

                <span class="n">labels_obj</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">meas_ids</span><span class="p">)</span>    
                <span class="n">obj_tick</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="n">N</span><span class="p">))[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">N</span><span class="p">))</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">ID</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">srgb</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">meas_ids</span><span class="p">,</span> <span class="n">y_values</span><span class="p">,</span> <span class="n">srgb_values</span><span class="p">):</span>

                    <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">srgb</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>

                    <span class="n">labels_obj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ID</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]))</span>
                    <span class="n">x_ticks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>


                <span class="n">labels_obj</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">((</span><span class="n">obj_tick</span><span class="p">),</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">obj_tick</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">obj</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span> <span class="n">labels_obj</span><span class="p">))</span>

                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">labels_obj</span><span class="p">)</span>

                <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">])</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>    
                <span class="n">x_ticks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

            <span class="c1"># Define the labels for x-axis ticks</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">xs</span> <span class="ow">in</span> <span class="n">labels</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">]</span>

            <span class="c1"># Set the x-ticks and xlabels</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x_ticks</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>

            <span class="c1"># Display the legend</span>
            <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
            <span class="n">unique</span> <span class="o">=</span> <span class="p">[(</span><span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="p">))</span> <span class="k">if</span> <span class="n">l</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">[:</span><span class="n">i</span><span class="p">]]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="o">*</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">unique</span><span class="p">),</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>




        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span> <span class="c1"># horizontal lines only</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Microfading analyses numbers&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">labels_eq</span><span class="p">[</span><span class="n">coordinate</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>


        <span class="c1">#ax.set_xticks(x)</span>
        <span class="c1">#ax.set_xticklabels(df_data[&#39;xlabels&#39;], rotation=rotate_xlabels, ha=position_xlabels)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">position_text</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">position_text</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Light dose = </span><span class="si">{</span><span class="n">dose_value</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">doses_dic</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">BWS_lines</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">save</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">path_fig</span> <span class="o">==</span> <span class="s1">&#39;cwd&#39;</span><span class="p">:</span>
                <span class="n">path_fig</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">coordinate</span><span class="si">}</span><span class="s1">-bar.png&#39;</span>                    

            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">path_fig</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span> 

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>     


    <span class="k">def</span> <span class="nf">plot_bwse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frequency</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">bins</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">colors</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">float</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">rotate_xlabels</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">position_xlabels</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span> <span class="n">title_fontsize</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">save</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">path_fig</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;cwd&#39;</span><span class="p">):</span>

        <span class="n">bwse_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;BWSE&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;BWSE&#39;</span><span class="p">]</span>
        <span class="n">bwse_values</span> <span class="o">=</span> <span class="n">bwse_df</span><span class="o">.</span><span class="n">values</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">bwse_df</span><span class="o">.</span><span class="n">index</span>

        <span class="n">wanted_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">labels</span><span class="p">,</span><span class="n">bwse_values</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">colors</span> <span class="o">==</span> <span class="s1">&#39;sample&#39;</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sRGB</span><span class="p">(</span><span class="n">dose_values</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>


        <span class="n">plotting</span><span class="o">.</span><span class="n">BWSE</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">wanted_data</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="n">frequency</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">title_fontsize</span><span class="o">=</span><span class="n">title_fontsize</span><span class="p">,</span> <span class="n">rotate_xlabels</span><span class="o">=</span><span class="n">rotate_xlabels</span><span class="p">,</span> <span class="n">position_xlabels</span><span class="o">=</span><span class="n">position_xlabels</span><span class="p">,</span>  <span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span> <span class="n">path_fig</span><span class="o">=</span><span class="n">path_fig</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">plot_CIELAB</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stds</span><span class="o">=</span><span class="p">[],</span> <span class="n">dose_unit</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">dose_values</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">colors</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">legend_labels</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">legend_position</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">legend_fontsize</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">legend_title</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">dE</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">obs_ill</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">save</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">path_fig</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;cwd&#39;</span><span class="p">,</span> <span class="n">report</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the Lab values related to input the microfading files.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        stds : list, optional</span>
<span class="sd">            A list of standard variation values respective to each element given in the data parameter, by default []</span>

<span class="sd">        dose_unit : str, optional</span>
<span class="sd">            Unit of the light energy dose, by default &#39;He&#39;</span>
<span class="sd">            Any of the following units can be used: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec)</span>

<span class="sd">        dose_values : [int, float, list, tuple], optional        </span>
<span class="sd">            Values of the light dose energy, by default &#39;all&#39;</span>
<span class="sd">            A single value (integer or float number), a list of multiple numerical values, or range values with a tuple (start, end, step) can be entered.</span>
<span class="sd">            When &#39;all&#39;, it takes the values found in the data.   </span>

<span class="sd">        colors : [str, list], optional</span>
<span class="sd">            Define the colors of the data points, by default None</span>
<span class="sd">            When &#39;sample&#39;, the color of each points will be based on srgb values computed from the reflectance values. Alternatively, a single string value can be used to define the color (see matplotlib colour values) or a list of matplotlib colour values can be used.     </span>

<span class="sd">        title : str, optional</span>
<span class="sd">            Whether to add a title to the plot, by default None</span>

<span class="sd">        fontsize : int, optional</span>
<span class="sd">            Fontsize of the plot (title, ticks, and labels), by default 24</span>

<span class="sd">        legend_labels : [str, list], optional</span>
<span class="sd">            A list of labels respective to each element given in the data parameter that will be shown in the legend. When the list is empty there is no legend displayed, by default &#39;default&#39;</span>
<span class="sd">            When &#39;default&#39;, each label will composed of the Id number of the number followed by a short description</span>

<span class="sd">        legend_position : str, optional</span>
<span class="sd">            Position of the legend, by default &#39;in&#39;</span>
<span class="sd">            The legend can either be inside the figure (&#39;in&#39;) or outside (&#39;out&#39;)</span>

<span class="sd">        legend_fontsize : int, optional</span>
<span class="sd">            Fontsize of the legend, by default 24</span>

<span class="sd">        legend_title : str, optional</span>
<span class="sd">            Add a title above the legend, by default &#39;&#39;</span>

<span class="sd">        dE : bool, optional</span>
<span class="sd">            Whether to display the dE00 curves in the bottom left suplots instead of the CIELAB 2D space, by default False</span>
<span class="sd">            NOT IMPLEMENTED YET ! LEAVE PARAMETER TO FALSE</span>

<span class="sd">        obs_ill : bool, optional</span>
<span class="sd">            Whether to display the observer and illuminant values, by default True</span>

<span class="sd">        save : bool, optional</span>
<span class="sd">            Whether to save the figure, by default False</span>

<span class="sd">        path_fig : str, optional</span>
<span class="sd">            Absolute path required to save the figure, by default &#39;cwd&#39;</span>
<span class="sd">            When &#39;cwd&#39;, it will save the figure in the current working directory.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        png file</span>
<span class="sd">            It returns a figure with 4 subplots that can be saved as a png file.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">data_Lab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cielab</span><span class="p">(</span><span class="n">coordinates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span> <span class="s1">&#39;a*&#39;</span><span class="p">,</span> <span class="s1">&#39;b*&#39;</span><span class="p">],</span> <span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span> <span class="n">dose_values</span><span class="o">=</span><span class="n">dose_values</span><span class="p">)</span>
        <span class="n">data_Lab</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">values</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_Lab</span><span class="p">]</span>


        <span class="c1"># Retrieve the metadata</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()</span>
        <span class="n">ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_meas_ids</span> <span class="k">if</span> <span class="s1">&#39;BW&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span> 

        <span class="k">if</span> <span class="s1">&#39;group_description&#39;</span> <span class="ow">in</span> <span class="n">info</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>                
            <span class="n">group_descriptions</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;group_description&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">group_descriptions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>



        <span class="c1"># Define the colour of the curves</span>
        <span class="k">if</span> <span class="n">colors</span> <span class="o">==</span> <span class="s1">&#39;sample&#39;</span><span class="p">:</span>
            <span class="k">pass</span>           

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">colors</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">colors</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>

        <span class="c1"># Define the labels</span>
        <span class="k">if</span> <span class="n">legend_labels</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
            <span class="n">legend_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_meas_ids</span><span class="p">,</span><span class="n">group_descriptions</span><span class="p">)]</span>
            <span class="n">legend_title</span> <span class="o">=</span> <span class="s1">&#39;Measurement $n^o$&#39;</span>

        <span class="c1"># Whether to plot the observer and illuminant info</span>
        <span class="k">if</span> <span class="n">obs_ill</span><span class="p">:</span>
            <span class="n">DB</span> <span class="o">=</span> <span class="n">databases</span><span class="o">.</span><span class="n">DB</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">observer</span> <span class="o">=</span> <span class="s1">&#39;10deg&#39;</span>
                <span class="n">illuminant</span> <span class="o">=</span> <span class="s1">&#39;D65&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">observer</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;observer&#39;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
                <span class="n">illuminant</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;illuminant&#39;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>

            <span class="n">dic_obs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;10deg&#39;</span><span class="p">:</span><span class="s1">&#39;$\mathrm{10^o}$&#39;</span><span class="p">,</span> <span class="s1">&#39;2deg&#39;</span><span class="p">:</span><span class="s1">&#39;$\mathrm{2^o}$&#39;</span><span class="p">}</span>            
            <span class="n">obs_ill</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">dic_obs</span><span class="p">[</span><span class="n">observer</span><span class="p">]</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">illuminant</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">obs_ill</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">plotting</span><span class="o">.</span><span class="n">CIELAB</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data_Lab</span><span class="p">,</span> <span class="n">legend_labels</span><span class="o">=</span><span class="n">legend_labels</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">legend_fontsize</span><span class="o">=</span><span class="n">legend_fontsize</span><span class="p">,</span> <span class="n">legend_position</span><span class="o">=</span><span class="n">legend_position</span><span class="p">,</span> <span class="n">legend_title</span><span class="o">=</span><span class="n">legend_title</span><span class="p">,</span> <span class="n">dE</span><span class="o">=</span><span class="n">dE</span><span class="p">,</span> <span class="n">obs_ill</span><span class="o">=</span><span class="n">obs_ill</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span> <span class="n">path_fig</span><span class="o">=</span><span class="n">path_fig</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">plot_swatches_circle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orientation</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">light_doses</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">15</span><span class="p">],</span> <span class="n">JND</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span> <span class="n">dose_unit</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Hv&#39;</span><span class="p">,</span> <span class="n">dE</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span> <span class="n">equation</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;power_3p&#39;</span><span class="p">,</span> <span class="n">initial_params</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">bounds</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">),</span> <span class="n">save</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">path_fig</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;cwd&#39;</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">report</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the microfading data with circular colored patches. </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        light_doses : list, optional</span>
<span class="sd">            Light doses in Mlxh for which a coloured patches will be created, by default [0,0.5,1,2,5,1]</span>
<span class="sd">            There has been at least two numerical values in the list. The first value corresponds to the color background of the plot and is usually set to 0. The other values will be plotted as circular patches.</span>

<span class="sd">        JND : list, optional</span>
<span class="sd">            Whether to plot circular patches of just noticeable differences, by default [1,2,3,5,10]</span>
<span class="sd">            NOT YET IMPLEMENTED</span>

<span class="sd">        dose_unit : [str, tuple], optional</span>
<span class="sd">            Unit of the light energy dose, by default &#39;Hv&#39;</span>
<span class="sd">            Any of the following units can be used: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (hours) (exh,50,10,365)</span>

<span class="sd">        dE : bool, optional</span>
<span class="sd">            Whether to include the dE00 value between the background and each circular patche, by default True</span>

<span class="sd">        fontsize : int, optional</span>
<span class="sd">            Fontsize of the plot (title, ticks, and labels), by default 24        </span>

<span class="sd">        equation : str, optional</span>
<span class="sd">            Mathematical equation used to fit the coordinate values, by default &#39;c0*(x**c1) + c2&#39;.</span>
<span class="sd">            Any others mathematical can be given. The following equation can also be used for fitting microfading data: &#39;((x) / (c0 + (c1*x)))&#39;.</span>

<span class="sd">        initial_params : List[float], optional</span>
<span class="sd">            Initial guesses of the &#39;c&#39; parameters given in the equation (c0, c1, c2, etc.), by default [0.1, 0.0]</span>
<span class="sd">            In the default values, only c0 and c1 are provided ; c2 is retrieved from the initial value of each colorimetric coordinate plot.</span>

<span class="sd">        save : bool, optional</span>
<span class="sd">            Whether to save the figure, by default False</span>

<span class="sd">        path_fig : str, optional</span>
<span class="sd">            Absolute path required to save the figure, by default &#39;cwd&#39;</span>
<span class="sd">            When &#39;cwd&#39;, it will save the figure in the current working directory.</span>

<span class="sd">        title : str, optional</span>
<span class="sd">            Whether to add a title to the plot, by default None, by default None        </span>

<span class="sd">        report : bool, optional</span>
<span class="sd">            _description_, by default False</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        _type_</span>
<span class="sd">            _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Define the title</span>
        <span class="k">if</span> <span class="n">title</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_meas_ids</span><span class="p">)</span>


        <span class="c1"># Compute the extrapolated Lab values</span>
        <span class="n">list_extrapolated_Lab</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span><span class="s1">&#39;b*&#39;</span><span class="p">]:</span>            

            <span class="n">fitted_coord</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_fitting</span><span class="p">(</span><span class="n">coordinate</span><span class="o">=</span><span class="n">coord</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span> <span class="n">equation</span><span class="o">=</span><span class="n">equation</span><span class="p">,</span><span class="n">initial_params</span><span class="o">=</span><span class="n">initial_params</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span><span class="n">x_range</span><span class="o">=</span><span class="p">(</span><span class="n">light_doses</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">light_doses</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">light_doses</span><span class="p">]</span>

            <span class="n">list_extrapolated_Lab</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fitted_coord</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>


        <span class="c1"># Run the plotting function for each filehow to b</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)):</span>
            <span class="n">wanted_Lab</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">list_extrapolated_Lab</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">values</span>

            <span class="n">plotting</span><span class="o">.</span><span class="n">swatches_circle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">wanted_Lab</span><span class="p">],</span> <span class="n">data_type</span><span class="o">=</span><span class="s1">&#39;Lab&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="n">orientation</span><span class="p">,</span> <span class="n">light_doses</span><span class="o">=</span><span class="n">light_doses</span><span class="p">,</span> <span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span> <span class="n">dE</span><span class="o">=</span><span class="n">dE</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">path_fig</span><span class="o">=</span><span class="n">path_fig</span><span class="p">)</span>        


    <span class="k">def</span> <span class="nf">plot_swatches_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">swatches</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">labels</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">bottom_scale</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;JND&#39;</span><span class="p">,</span> <span class="n">top_label</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Hv&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">save</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">path_fig</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;cwd&#39;</span><span class="p">):</span>

        <span class="c1"># Adapt bottom scale for JND</span>
        <span class="k">if</span> <span class="n">bottom_scale</span> <span class="o">==</span> <span class="s1">&#39;JND&#39;</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">swatches</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="nb">float</span><span class="p">)):</span>
            <span class="n">bottom_scale</span> <span class="o">=</span> <span class="s1">&#39;dE00&#39;</span>
            <span class="n">swatches</span> <span class="o">=</span> <span class="p">(</span><span class="n">swatches</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">swatches</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">1.3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

        <span class="c1"># Doses dic</span>
        <span class="n">doses_dic</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;He&#39;</span><span class="p">:</span> <span class="s1">&#39;MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;Hv&#39;</span><span class="p">:</span><span class="s1">&#39;Mlxh&#39;</span><span class="p">}</span>


        <span class="c1"># Define the dose_unit</span>
        <span class="k">if</span> <span class="n">bottom_scale</span> <span class="o">==</span> <span class="s1">&#39;He&#39;</span> <span class="ow">or</span> <span class="n">bottom_scale</span> <span class="o">==</span> <span class="s1">&#39;Hv&#39;</span><span class="p">:</span>
            <span class="n">dose_unit</span> <span class="o">=</span> <span class="n">bottom_scale</span>

        <span class="k">elif</span> <span class="n">top_label</span> <span class="o">==</span> <span class="s1">&#39;He&#39;</span> <span class="ow">or</span> <span class="n">top_label</span> <span class="o">==</span> <span class="s1">&#39;Hv&#39;</span><span class="p">:</span>
            <span class="n">dose_unit</span> <span class="o">=</span> <span class="n">top_label</span>


        <span class="c1"># Retrieve the analyses light dose values</span>
        <span class="n">doses</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_doses</span><span class="p">(</span><span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span> <span class="n">max_doses</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
        <span class="n">dose_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">doses</span><span class="p">)</span>


        <span class="c1"># Define the Lab values for the top colour swatches</span>
        <span class="k">if</span> <span class="n">swatches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;i&#39;</span><span class="p">:</span>
            <span class="n">dose_value_top</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">top_text</span> <span class="o">=</span> <span class="s1">&#39;Initial&#39;</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">swatches</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">swatches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">dose_min</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Please, choose an initial dose value lower or equal to the final experimental light dose (</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">dose_min</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">doses_dic</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">]</span><span class="si">}</span><span class="s1">).&#39;</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dose_value_top</span> <span class="o">=</span> <span class="n">swatches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> 
                <span class="n">top_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">swatches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">doses_dic</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>  
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Enter valid values for the swatches parameter, ie. a tuple of integer or float.&#39;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">Lab_top</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cielab</span><span class="p">(</span><span class="n">coordinates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span> <span class="s1">&#39;b*&#39;</span><span class="p">],</span> <span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span> <span class="n">dose_values</span><span class="o">=</span><span class="n">dose_value_top</span><span class="p">)]</span>


        <span class="c1"># Define the Lab values for the bottom colour swatches</span>

        <span class="k">if</span> <span class="n">swatches</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span>                          <span class="c1"># Select last measured values</span>
            <span class="n">Lab_bottom</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cielab</span><span class="p">(</span><span class="n">coordinates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span> <span class="s1">&#39;b*&#39;</span><span class="p">],</span> <span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">)]</span>
            <span class="n">bottom_text</span> <span class="o">=</span> <span class="s1">&#39;Final&#39;</span>
            <span class="n">wanted_dose</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_doses</span><span class="p">(</span><span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span> <span class="n">max_doses</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">swatches</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="nb">float</span><span class="p">)):</span>      <span class="c1"># Select the values according to a dE or H value</span>

            <span class="n">Lab_bottom</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">if</span> <span class="n">bottom_scale</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;He&#39;</span><span class="p">,</span><span class="s1">&#39;Hv&#39;</span><span class="p">]:</span>             <span class="c1"># According to a dose value (He or Hv)</span>

                <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span> <span class="s1">&#39;b*&#39;</span><span class="p">]:</span>               

                    <span class="n">coord_bottom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_fitting</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">coordinate</span><span class="o">=</span><span class="n">coord</span><span class="p">,</span><span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span> <span class="n">x_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">swatches</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">swatches</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
                    <span class="n">Lab_bottom</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coord_bottom</span><span class="p">)</span> 

                <span class="n">Lab_bottom</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">Lab_bottom</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">values</span>  


            <span class="k">elif</span> <span class="n">bottom_scale</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;dE76&#39;</span><span class="p">,</span><span class="s1">&#39;dE00&#39;</span><span class="p">,</span><span class="s1">&#39;dR_vis&#39;</span><span class="p">]:</span>    <span class="c1"># According to a dE or dR value</span>

                <span class="n">max_doses</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;He&#39;</span><span class="p">:</span><span class="mf">2000.1</span><span class="p">,</span> <span class="s1">&#39;Hv&#39;</span><span class="p">:</span><span class="mf">200.1</span><span class="p">}</span>
                <span class="n">dE_fitted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_fitting</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">coordinate</span><span class="o">=</span><span class="n">bottom_scale</span><span class="p">,</span><span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span> <span class="n">x_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">max_doses</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">],</span><span class="mf">0.1</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span>                

                <span class="n">wanted_doses</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">dE_fitted</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>

                    <span class="n">dE_data</span> <span class="o">=</span> <span class="n">dE_fitted</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>


                    <span class="k">if</span> <span class="n">dE_data</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">swatches</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">wanted_doses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">interp1d</span><span class="p">(</span><span class="n">dE_data</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">dE_data</span><span class="o">.</span><span class="n">index</span><span class="p">)([</span><span class="n">swatches</span><span class="p">[</span><span class="mi">1</span><span class="p">]])[</span><span class="mi">0</span><span class="p">])</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">wanted_doses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dE_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">wanted_dose</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">wanted_doses</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span> <span class="s1">&#39;b*&#39;</span><span class="p">]:</span>
                        <span class="n">coord_bottom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_fitting</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">coordinate</span><span class="o">=</span><span class="n">coord</span><span class="p">,</span><span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span> <span class="n">x_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">wanted_dose</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>


                        <span class="n">Lab_bottom</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coord_bottom</span><span class="p">)</span>

                <span class="n">Lab_bottom</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">Lab_bottom</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">Lab_bottom</span> <span class="o">=</span> <span class="n">Lab_bottom</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wanted_doses</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>


            <span class="n">bottom_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">swatches</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">labels_eq</span><span class="p">[</span><span class="n">bottom_scale</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Enter valid values for the swatches parameter, ie. a tuple of integer or float.&#39;</span><span class="p">)</span>
            <span class="k">return</span>


        <span class="c1"># Pair the top and bottom Lab values</span>
        <span class="n">wanted_data</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">Lab_top</span><span class="p">,</span><span class="n">Lab_bottom</span><span class="p">)]</span>


        <span class="c1"># Define the labels</span>
        <span class="k">if</span> <span class="n">labels</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">(</span><span class="s1">&#39;meas_id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">labels</span> <span class="o">==</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>


        <span class="c1"># Define the top label values</span>
        <span class="k">if</span> <span class="n">top_label</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;He&#39;</span><span class="p">,</span><span class="s1">&#39;Hv&#39;</span><span class="p">]:</span>           

            <span class="n">top_labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">top_label</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">wanted_doses</span><span class="p">,</span><span class="mi">3</span><span class="p">)}</span>

        <span class="k">if</span> <span class="n">top_label</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;dE76&#39;</span><span class="p">,</span><span class="s1">&#39;dE94&#39;</span><span class="p">,</span><span class="s1">&#39;dE00&#39;</span><span class="p">]:</span>
            <span class="n">methods_dE</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dE76&#39;</span><span class="p">:</span> <span class="s1">&#39;CIE 1976&#39;</span><span class="p">,</span> <span class="s1">&#39;dE94&#39;</span><span class="p">:</span> <span class="s1">&#39;CIE 1994&#39;</span><span class="p">,</span> <span class="s1">&#39;dE00&#39;</span><span class="p">:</span> <span class="s1">&#39;CIE 2000&#39;</span><span class="p">}</span>
            <span class="n">top_label_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">colour</span><span class="o">.</span><span class="n">delta_E</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="n">methods_dE</span><span class="p">[</span><span class="n">top_label</span><span class="p">]),</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">wanted_data</span><span class="p">]</span>
            <span class="n">top_labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">top_label</span><span class="p">:</span><span class="n">top_label_values</span><span class="p">}</span>


        <span class="c1"># Define the side annotations</span>
        <span class="n">side_annotations</span> <span class="o">=</span> <span class="p">(</span><span class="n">top_text</span><span class="p">,</span> <span class="n">bottom_text</span><span class="p">)</span>

        <span class="c1"># Whether to save the figure</span>
        <span class="k">if</span> <span class="n">save</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">path_fig</span> <span class="o">==</span> <span class="s1">&#39;cwd&#39;</span><span class="p">:</span>
                <span class="n">path_fig</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span><span class="si">}</span><span class="s1">/MFT_</span><span class="si">{</span><span class="s2">&quot;-&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_meas_ids</span><span class="p">)</span><span class="si">}</span><span class="s1">_SW-rect.png&#39;</span>  


        <span class="c1"># Run the plotting function</span>
        <span class="n">plotting</span><span class="o">.</span><span class="n">swatches_rectangle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">wanted_data</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s1">&#39;Lab&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">bottom_scale</span><span class="o">=</span><span class="n">bottom_scale</span><span class="p">,</span> <span class="n">top_labels</span><span class="o">=</span><span class="n">top_labels</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">side_annotations</span><span class="o">=</span><span class="n">side_annotations</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="n">colorbar</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span> <span class="n">path_fig</span><span class="o">=</span><span class="n">path_fig</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">plot_delta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stds</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dE00&#39;</span><span class="p">],</span> <span class="n">dose_unit</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">legend_labels</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">initial_values</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">figsize</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">9</span><span class="p">),</span> <span class="n">colors</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">lw</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span> <span class="n">legend_fontsize</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span> <span class="n">legend_title</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xlim</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">save</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">path_fig</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;cwd&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the delta values of choosen colorimetric coordinates related to the microfading analyses.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        stds : bool, optional</span>
<span class="sd">            Whether to show the standard deviation values if any, by default True.</span>

<span class="sd">        coordinates : list, optional</span>
<span class="sd">            List of colorimetric coordinates, by default [&#39;dE00&#39;]</span>
<span class="sd">            Any of the following coordinates can be added to the list: &#39;dE76&#39;, &#39;dE00&#39;, &#39;dR_vis&#39; , &#39;L*&#39;, &#39;a*&#39;, &#39;b*&#39;, &#39;C*&#39;, &#39;h&#39;.</span>

<span class="sd">        dose_unit : str, optional</span>
<span class="sd">            Unit of the light energy dose, by default &#39;He&#39;</span>
<span class="sd">            Any of the following units can be used: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec)</span>

<span class="sd">        legend_labels : Union[str, list], optional</span>
<span class="sd">            A list of labels respective to each element given in the data parameter that will be shown in the legend. When the list is empty there is no legend displayed, by default &#39;default&#39;</span>
<span class="sd">            When &#39;default&#39;, each label will composed of the Id number of the number followed by a short description</span>

<span class="sd">        colors : Union[str, list], optional</span>
<span class="sd">            Define the colors of the curves, by default None</span>
<span class="sd">            When &#39;sample&#39;, the color of each line will be based on srgb values computed from the reflectance values. Alternatively, a single string value can be used to define the color (see matplotlib colour values) and will be applied to all the lines. Or a list of matplotlib colour values can be used. With a single coordinate, the list should have the same length as measurement files. With multiple coordinates, the list should have the same length as coordinates.</span>

<span class="sd">        lw : Union[int,list], optional</span>
<span class="sd">            Width of the lines, by default &#39;default&#39;</span>
<span class="sd">            When &#39;default&#39;, it attributes a given a width according to each coordinates, otherwise it gives a value of 2.</span>
<span class="sd">            A single value (an integer) can be entered and applied to all the lines.</span>
<span class="sd">            A list of integers can also be entered. With a single coordinate, the list should have the same length as measurement files. With multiple coordinates, the list should have the same length as coordinates.</span>

<span class="sd">        title : str, optional</span>
<span class="sd">            Whether to add a title to the plot, by default None</span>

<span class="sd">        fontsize : int, optional</span>
<span class="sd">            Fontsize of the plot (title, ticks, and labels), by default 24</span>

<span class="sd">        legend_fontsize : int, optional</span>
<span class="sd">            Fontsize of the legend, by default 24</span>

<span class="sd">        legend_title : str, optional</span>
<span class="sd">            Add a title above the legend, by default &#39;&#39;</span>

<span class="sd">        xlim : tuple, optional</span>
<span class="sd">            A tuple of two integers that define the left and right limits of the x-axis , by default None.</span>

<span class="sd">        save : bool, optional</span>
<span class="sd">            Whether to save the figure, by default False</span>

<span class="sd">        path_fig : str, optional</span>
<span class="sd">            Absolute path required to save the figure, by default &#39;cwd&#39;</span>
<span class="sd">            When &#39;cwd&#39;, it will save the figure in the current working directory.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Retrieve the data</span>
        <span class="k">if</span> <span class="n">xlim</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dose_values</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xlim</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">dose_values</span> <span class="o">=</span> <span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.05</span><span class="p">)</span>

        <span class="n">all_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_delta</span><span class="p">(</span><span class="n">coordinates</span><span class="o">=</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span> <span class="n">dose_values</span><span class="o">=</span><span class="n">dose_values</span><span class="p">)</span>
        <span class="n">nominal_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">stdev_data</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">all_data</span><span class="p">:</span>

            <span class="k">if</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">]:</span>
                <span class="n">nominal</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">stds</span><span class="p">:</span>
                    <span class="n">stdev</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>   
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">stdev</span> <span class="o">=</span> <span class="n">nominal</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>   
                    <span class="n">stdev</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:]</span> <span class="o">=</span> <span class="mi">0</span>         

            <span class="k">else</span><span class="p">:</span>

                <span class="n">nominal</span> <span class="o">=</span> <span class="n">data</span>
                <span class="n">stdev</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">stdev</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:]</span> <span class="o">=</span> <span class="mi">0</span>


            <span class="n">nominal_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nominal</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
            <span class="n">stdev_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stdev</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>



        <span class="c1"># Retrieve the metadata</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()</span>
        <span class="n">ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_meas_ids</span><span class="p">]</span>
        <span class="n">meas_nbs</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">]</span>

        <span class="k">if</span> <span class="s1">&#39;spot_description&#39;</span> <span class="ow">in</span> <span class="n">info</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>                
            <span class="n">group_descriptions</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;spot_description&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">group_descriptions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>


        <span class="c1"># Set the labels values</span>
        <span class="k">if</span> <span class="n">legend_labels</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>                       
            <span class="n">legend_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ids</span><span class="p">,</span> <span class="n">group_descriptions</span><span class="p">)]</span> 

        <span class="k">elif</span> <span class="n">legend_labels</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">legend_labels</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">legend_labels</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">legend_labels</span> <span class="o">=</span> <span class="n">legend_labels</span>
<span class="w">            </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            labels_list = []</span>
<span class="sd">            for i,Id in enumerate(self.get_meas_ids):</span>
<span class="sd">                label = Id.split(&#39;.&#39;)[-1]</span>
<span class="sd">                for el in labels:</span>
<span class="sd">                    label = label + f&#39;-{self.get_metadata().loc[el].values[i]}&#39;</span>
<span class="sd">                labels_list.append(label)</span>

<span class="sd">            labels = labels_list</span>
<span class="sd">            &#39;&#39;&#39;</span>

        <span class="c1"># Add the initial values of the colorimetric coordinates</span>

        <span class="k">if</span> <span class="n">initial_values</span><span class="p">:</span>  
            <span class="n">initial_values</span> <span class="o">=</span> <span class="p">{}</span>          
            <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">coordinates</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">coord</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;dL*&#39;</span><span class="p">,</span> <span class="s1">&#39;da*&#39;</span><span class="p">,</span> <span class="s1">&#39;db*&#39;</span><span class="p">,</span> <span class="s1">&#39;dC*&#39;</span><span class="p">,</span> <span class="s1">&#39;dh&#39;</span><span class="p">]:</span>
                    <span class="n">initial_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cielab</span><span class="p">(</span><span class="n">coordinates</span><span class="o">=</span><span class="p">[</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">:]])[</span><span class="mi">0</span><span class="p">][</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">initial_values</span><span class="p">[</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span> <span class="o">=</span> <span class="n">initial_value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">initial_values</span> <span class="o">=</span> <span class="p">{}</span>  

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">meas_nbs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">initial_values</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># Set the color of the lines according to the sample</span>
        <span class="k">if</span> <span class="n">colors</span> <span class="o">==</span> <span class="s1">&#39;sample&#39;</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_sRGB</span><span class="p">(</span><span class="n">dose_values</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">meas_nbs</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">colors</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>

        <span class="c1"># Whether to add a title or not</span>
        <span class="k">if</span> <span class="n">title</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;MFT&#39;</span>            
        <span class="k">elif</span> <span class="n">title</span> <span class="o">==</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="n">title</span> 

        <span class="c1"># Define the saving folder in case the figure should be saved</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">path_fig</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
                <span class="n">path_fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dir</span><span class="p">(</span><span class="n">folder_type</span><span class="o">=</span><span class="s1">&#39;figures&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">filename</span>                

            <span class="k">if</span> <span class="n">path_fig</span> <span class="o">==</span> <span class="s1">&#39;cwd&#39;</span><span class="p">:</span>
                <span class="n">path_fig</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">&#39;</span> 


        <span class="n">plotting</span><span class="o">.</span><span class="n">delta</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">nominal_data</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">stdev_data</span><span class="p">,</span> <span class="n">dose_unit</span><span class="o">=</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">],</span> <span class="n">coordinates</span><span class="o">=</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">initial_values</span><span class="o">=</span><span class="n">initial_values</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">legend_labels</span><span class="o">=</span><span class="n">legend_labels</span><span class="p">,</span> <span class="n">legend_fontsize</span><span class="o">=</span><span class="n">legend_fontsize</span><span class="p">,</span> <span class="n">legend_title</span><span class="o">=</span><span class="n">legend_title</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span> <span class="n">path_fig</span><span class="o">=</span><span class="n">path_fig</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">plot_sp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stdev</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">spectra</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">dose_unit</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">dose_values</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">spectral_mode</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="n">legend_labels</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span> <span class="n">fontsize_legend</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span> <span class="n">legend_title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">wl_range</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">colors</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">lw</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">text_xy</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.02</span><span class="p">,</span><span class="mf">0.03</span><span class="p">),</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">path_fig</span><span class="o">=</span><span class="s1">&#39;cwd&#39;</span><span class="p">,</span> <span class="n">derivation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">smoothing</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">report</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the reflectance spectra corresponding to the associated microfading analyses.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        stdev : bool, optional</span>
<span class="sd">            Whether to show the standard deviation values, by default False</span>

<span class="sd">        spectra : Optional[str], optional</span>
<span class="sd">            Define which spectra to display, by default &#39;i&#39;</span>
<span class="sd">            &#39;i&#39; for initial spectral, </span>
<span class="sd">            &#39;f&#39; for final spectra,</span>
<span class="sd">            &#39;i+f&#39; for initial and final spectra, </span>
<span class="sd">            &#39;all&#39; for all the spectra, </span>
<span class="sd">            &#39;doses&#39; for spectra at different dose values indicated by the dose_unit and dose_values parameters</span>

<span class="sd">        dose_unit : str, optional</span>
<span class="sd">            Unit of the light energy dose, by default &#39;He&#39;</span>
<span class="sd">            Any of the following units can be used: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec). It only works if the &#39;spectra&#39; parameters has been set to &#39;doses&#39;.</span>

<span class="sd">        dose_values : Union[int, float, list, tuple], optional</span>
<span class="sd">            Values of the light dose energy, by default &#39;all&#39;</span>
<span class="sd">            A single value (integer or float number), a list of multiple numerical values, or range values with a tuple (start, end, step) can be entered.</span>
<span class="sd">            When &#39;all&#39;, it takes the values found in the data. It only works if the &#39;spectra&#39; parameters has been set to &#39;doses&#39;.</span>

<span class="sd">        spectral_mode : string, optional</span>
<span class="sd">            When &#39;R&#39;, it returns the reflectance spectra            </span>
<span class="sd">            When &#39;A&#39;, it returns the absorption spectra using the following equation: A = -log(R)</span>

<span class="sd">        legend_labels : Union[str, list], optional</span>
<span class="sd">            A list of labels respective to each element given in the data parameter that will be shown in the legend. When the list is empty there is no legend displayed, by default &#39;default&#39;</span>
<span class="sd">            When &#39;default&#39;, each label will composed of the Id number of the number followed by a short description</span>

<span class="sd">        title : str, optional</span>
<span class="sd">            Whether to add a title to the plot, by default None</span>

<span class="sd">        fontsize : int, optional</span>
<span class="sd">            Fontsize of the plot (title, ticks, and labels), by default 24</span>

<span class="sd">        fontsize_legend : int, optional</span>
<span class="sd">            Fontsize of the legend, by default 24</span>

<span class="sd">        legend_title : str, optional</span>
<span class="sd">            Add a title above the legend, by default &#39;&#39;</span>

<span class="sd">        wl_range : tuple, optional</span>
<span class="sd">            Define the wavelength range with a two-values tuple corresponding to the lowest and highest wavelength values, by default None</span>

<span class="sd">        colors : Union[str, list], optional</span>
<span class="sd">            Define the colors of the reflectance curves, by default None</span>
<span class="sd">            When &#39;sample&#39;, the color of each line will be based on srgb values computed from the reflectance values. Alternatively, a single string value can be used to define the color (see matplotlib colour values) or a list of matplotlib colour values can be used. </span>

<span class="sd">        lw : Union[int, list], optional</span>
<span class="sd">            Define the width of the plot lines, by default 2</span>
<span class="sd">            It can be a single integer value that will apply to all the curves. Or a list of integers can be used where the number of integer elements should match the number of reflectance curves.</span>

<span class="sd">        ls : Union[str, list], optional</span>
<span class="sd">            Define the line style of the plot lines, by default &#39;-&#39;</span>
<span class="sd">            It can be a string (&#39;-&#39;, &#39;--&#39;, &#39;:&#39;, &#39;-.&#39;) that will apply to all the curves. Or a list of string can be used where the number of string elements should match the number of reflectance curves.</span>

<span class="sd">        save : bool, optional</span>
<span class="sd">            Whether to save the figure, by default False</span>

<span class="sd">        path_fig : str, optional</span>
<span class="sd">            Absolute path required to save the figure, by default &#39;cwd&#39;</span>
<span class="sd">            When &#39;cwd&#39;, it will save the figure in the current working directory.</span>

<span class="sd">        derivation : bool, optional</span>
<span class="sd">            Wether to compute and display the first derivative values of the spectra, by default False</span>

<span class="sd">        smooth : bool, optional</span>
<span class="sd">            Whether to smooth the reflectance curves, by default False</span>

<span class="sd">        smooth_params : list, optional</span>
<span class="sd">            Parameters related to the Savitzky-Golay filter, by default [10,1]</span>
<span class="sd">            Enter a list of two integers where the first value corresponds to the window_length and the second to the polyorder value. </span>

<span class="sd">        report : Optional[bool], optional</span>
<span class="sd">            Configure some aspects of the figure for use in a report, by default False</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        _type_</span>
<span class="sd">            It returns a figure that can be save as a png file.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Apply the report characteristics</span>

        <span class="k">if</span> <span class="n">report</span><span class="p">:</span>
            <span class="n">save</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="s1">&#39;sample&#39;</span>
            <span class="n">spectra</span> <span class="o">=</span> <span class="s1">&#39;i+f&#39;</span>
            <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">30</span>

        <span class="c1"># Retrieve the metadata</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()</span>

        <span class="k">if</span> <span class="s1">&#39;spot_description&#39;</span> <span class="ow">in</span> <span class="n">info</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>                
            <span class="n">spot_descriptions</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;spot_description&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">spot_descriptions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>


        <span class="c1"># Define the colour of the curves</span>
        <span class="k">if</span> <span class="n">colors</span> <span class="o">==</span> <span class="s1">&#39;sample&#39;</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sRGB</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">colors</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">colors</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>

        <span class="c1"># Define the labels</span>
        <span class="k">if</span> <span class="n">legend_labels</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
            <span class="n">legend_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_meas_ids</span><span class="p">,</span><span class="n">spot_descriptions</span><span class="p">)]</span>
            <span class="n">legend_title</span> <span class="o">=</span> <span class="s1">&#39;Measurement $n^o$&#39;</span>

        <span class="c1"># Select the spectral data</span>
        <span class="k">if</span> <span class="n">spectra</span> <span class="o">==</span> <span class="s1">&#39;i&#39;</span><span class="p">:</span>            
            <span class="n">data_sp_all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_spectra</span><span class="p">(</span><span class="n">wl_range</span><span class="o">=</span><span class="n">wl_range</span><span class="p">,</span> <span class="n">smoothing</span><span class="o">=</span><span class="n">smoothing</span><span class="p">)</span>
            <span class="n">data_sp</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_sp_all</span><span class="p">]</span>            

            <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Initial spectra&#39;</span>

        <span class="k">elif</span> <span class="n">spectra</span> <span class="o">==</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span>
            <span class="n">data_sp_all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_spectra</span><span class="p">(</span><span class="n">wl_range</span><span class="o">=</span><span class="n">wl_range</span><span class="p">,</span> <span class="n">smoothing</span><span class="o">=</span><span class="n">smoothing</span><span class="p">)</span>
            <span class="n">data_sp</span> <span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_sp_all</span><span class="p">]</span> 

            <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Final spectra&#39;</span>

        <span class="k">elif</span> <span class="n">spectra</span> <span class="o">==</span> <span class="s1">&#39;i+f&#39;</span><span class="p">:</span>
            <span class="n">data_sp_all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_spectra</span><span class="p">(</span><span class="n">wl_range</span><span class="o">=</span><span class="n">wl_range</span><span class="p">,</span> <span class="n">smoothing</span><span class="o">=</span><span class="n">smoothing</span><span class="p">)</span>
            <span class="n">data_sp</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)[[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_sp_all</span><span class="p">]</span>            

            <span class="n">ls</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_sp</span><span class="p">)</span>
            <span class="n">lw</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_sp</span><span class="p">)</span>
            <span class="n">black_lines</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_sp</span><span class="p">)</span>            
            <span class="n">colors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="n">black_lines</span><span class="p">)))</span>            


            <span class="k">if</span> <span class="n">legend_labels</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
                <span class="n">meas_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_meas_ids</span><span class="p">,</span><span class="n">spot_descriptions</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">meas_labels</span> <span class="o">=</span> <span class="n">legend_labels</span>
            <span class="n">none_labels</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">meas_labels</span><span class="p">)</span>
            <span class="n">legend_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">meas_labels</span><span class="p">,</span> <span class="n">none_labels</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">pair</span><span class="p">]</span>

            <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Initial and final spectra (black dashed lines)&#39;</span>

        <span class="k">elif</span> <span class="n">spectra</span> <span class="o">==</span> <span class="s1">&#39;doses&#39;</span><span class="p">:</span>
            <span class="n">data_sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_spectra</span><span class="p">(</span><span class="n">wl_range</span><span class="o">=</span><span class="n">wl_range</span><span class="p">,</span> <span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span><span class="n">dose_values</span><span class="o">=</span><span class="n">dose_values</span><span class="p">,</span> <span class="n">smoothing</span><span class="o">=</span><span class="n">smoothing</span><span class="p">)</span>


            <span class="n">dose_units</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;He&#39;</span><span class="p">:</span> <span class="s1">&#39;MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;Hv&#39;</span><span class="p">:</span> <span class="s1">&#39;Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="s1">&#39;sec&#39;</span><span class="p">}</span>
            <span class="n">legend_title</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Light dose values&#39;</span>
            <span class="n">legend_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">dose_units</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dose_values</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_sp</span><span class="p">)</span>

            <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

            <span class="n">ls_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span><span class="s1">&#39;:&#39;</span><span class="p">,]</span>
            <span class="n">ls</span> <span class="o">=</span> <span class="n">ls_list</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">dose_values</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_sp</span><span class="p">)</span>        
            <span class="n">srgb_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sRGB</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>            
            <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">srgb_i</span><span class="p">,</span> <span class="n">data_sp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>          

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">spectra</span><span class="si">}</span><span class="s1">&quot; is not an adequate value. Enter a value for the parameter &quot;spectra&quot; among the following list: &quot;i&quot;, &quot;f&quot;, &quot;i+f&quot;, &quot;doses&quot;.&#39;</span><span class="p">)</span>
            <span class="k">return</span>           

        <span class="c1"># whether to compute the absorption spectra</span>
        <span class="k">if</span> <span class="n">spectral_mode</span> <span class="o">==</span> <span class="s1">&#39;abs&#39;</span><span class="p">:</span>
            <span class="n">data_sp</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_sp</span><span class="p">]</span>

        <span class="c1"># Reset the index</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_sp</span><span class="p">]</span>

        <span class="c1"># Whether to compute the first derivative</span>
        <span class="k">if</span> <span class="n">derivation</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>

        <span class="c1"># Compile the spectra to plot inside a list</span>
        <span class="n">wanted_data</span> <span class="o">=</span> <span class="p">[]</span>  
        <span class="n">wanted_std</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Set the wavelength column as index</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>          

        <span class="c1"># Add the std values</span>
        <span class="k">if</span> <span class="n">stdev</span><span class="p">:</span>            
            <span class="k">try</span><span class="p">:</span>     

                <span class="n">values_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
                <span class="n">values_wl</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">el1</span><span class="p">,</span> <span class="n">wl</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">values_data</span><span class="p">,</span> <span class="n">values_wl</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">el2</span> <span class="ow">in</span> <span class="n">el1</span><span class="p">:</span>
                        <span class="n">wanted_data</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">wl</span><span class="p">,</span><span class="n">el2</span><span class="p">))</span>

                <span class="n">values_std</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>                
                <span class="k">for</span> <span class="n">el1</span> <span class="ow">in</span> <span class="n">values_std</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">el2</span> <span class="ow">in</span> <span class="n">el1</span><span class="p">:</span>
                        <span class="n">wanted_std</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">el2</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="n">wanted_std</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>                
                <span class="n">data_values</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="n">el</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">el</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
                <span class="n">wanted_data</span> <span class="o">=</span> <span class="n">wanted_data</span> <span class="o">+</span> <span class="n">data_values</span> 
            <span class="n">wanted_std</span> <span class="o">=</span> <span class="p">[]</span>


        <span class="k">return</span> <span class="n">plotting</span><span class="o">.</span><span class="n">spectra</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">wanted_data</span><span class="p">,</span> <span class="n">stds</span><span class="o">=</span><span class="n">wanted_std</span><span class="p">,</span> <span class="n">spectral_mode</span><span class="o">=</span><span class="n">spectral_mode</span><span class="p">,</span> <span class="n">legend_labels</span><span class="o">=</span><span class="n">legend_labels</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">fontsize_legend</span><span class="o">=</span><span class="n">fontsize_legend</span><span class="p">,</span> <span class="n">legend_title</span><span class="o">=</span><span class="n">legend_title</span><span class="p">,</span> <span class="n">x_range</span><span class="o">=</span><span class="n">wl_range</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="n">ls</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">text_xy</span><span class="o">=</span><span class="n">text_xy</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span> <span class="n">path_fig</span><span class="o">=</span><span class="n">path_fig</span><span class="p">,</span> <span class="n">derivation</span><span class="o">=</span><span class="n">derivation</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">plot_sp_delta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">spectra</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="s1">&#39;f&#39;</span><span class="p">),</span> <span class="n">dose_unit</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Hv&#39;</span><span class="p">,</span> <span class="n">legend_labels</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span> <span class="n">legend_fontsize</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span> <span class="n">legend_title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">wl_range</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="nb">float</span><span class="p">,</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">colors</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">spectral_mode</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;dR&#39;</span><span class="p">,</span> <span class="n">derivation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">smoothing</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">report</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>

        <span class="c1"># Set the wavelength range       </span>
        <span class="k">if</span> <span class="n">wl_range</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>

            <span class="n">device_info</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">(</span><span class="s1">&#39;device&#39;</span><span class="p">)))</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">device_info</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>                
                <span class="n">device_id</span> <span class="o">=</span> <span class="n">device_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">device_id</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">get_DB_config</span><span class="p">()[</span><span class="s1">&#39;devices&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="n">wl_range</span> <span class="o">=</span> <span class="n">get_DB_config</span><span class="p">()[</span><span class="s1">&#39;devices&#39;</span><span class="p">][</span><span class="n">device_id</span><span class="p">]</span> <span class="p">[</span><span class="s1">&#39;wl_range&#39;</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">wl_range</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">wl_range</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">wl_range</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">wl_ranges</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="n">wl_range</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">wl_ranges</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">wl_ranges</span><span class="p">))</span>


        <span class="c1"># Set the report parameters</span>
        <span class="k">if</span> <span class="n">report</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">if</span> <span class="n">spectra</span> <span class="o">==</span> <span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="s1">&#39;f&#39;</span><span class="p">):</span>

            <span class="n">sp_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_spectra</span><span class="p">(</span><span class="n">wl_range</span><span class="o">=</span><span class="n">wl_range</span><span class="p">,</span> <span class="n">spectral_mode</span><span class="o">=</span><span class="n">spectral_mode</span><span class="p">)]</span>
            <span class="n">sp_delta</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sp_data</span><span class="p">]</span>
            <span class="n">wanted_data</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sp_delta</span><span class="p">]</span>

        <span class="k">elif</span> <span class="n">spectra</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;i&#39;</span><span class="p">:</span>

            <span class="n">sp1</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_spectra</span><span class="p">(</span><span class="n">wl_range</span><span class="o">=</span><span class="n">wl_range</span><span class="p">,</span> <span class="n">spectral_mode</span><span class="o">=</span><span class="n">spectral_mode</span><span class="p">)]</span>
            <span class="n">sp2</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_spectra</span><span class="p">(</span><span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span> <span class="n">dose_values</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">spectra</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="n">wl_range</span><span class="o">=</span><span class="n">wl_range</span><span class="p">,</span> <span class="n">spectral_mode</span><span class="o">=</span><span class="n">spectral_mode</span><span class="p">)]</span>

            <span class="n">wanted_data</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sp1</span><span class="p">,</span><span class="n">sp2</span><span class="p">)]</span>

        <span class="k">elif</span> <span class="n">spectra</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span>

            <span class="n">sp1</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_spectra</span><span class="p">(</span><span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span> <span class="n">dose_values</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">spectra</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">wl_range</span><span class="o">=</span><span class="n">wl_range</span><span class="p">,</span> <span class="n">spectral_mode</span><span class="o">=</span><span class="n">spectral_mode</span><span class="p">)]</span>            
            <span class="n">sp2</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_spectra</span><span class="p">(</span><span class="n">wl_range</span><span class="o">=</span><span class="n">wl_range</span><span class="p">,</span> <span class="n">spectral_mode</span><span class="o">=</span><span class="n">spectral_mode</span><span class="p">)]</span>            

            <span class="n">wanted_data</span> <span class="o">=</span> <span class="p">[(</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sp1</span><span class="p">,</span><span class="n">sp2</span><span class="p">)]</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="n">wavelengths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_wavelength</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">values</span>
            <span class="n">sp1</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_spectra</span><span class="p">(</span><span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span> <span class="n">dose_values</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">spectra</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">wl_range</span><span class="o">=</span><span class="n">wl_range</span><span class="p">,</span> <span class="n">spectral_mode</span><span class="o">=</span><span class="n">spectral_mode</span><span class="p">)]</span>
            <span class="n">sp2</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_spectra</span><span class="p">(</span><span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span> <span class="n">dose_values</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">spectra</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="n">wl_range</span><span class="o">=</span><span class="n">wl_range</span><span class="p">,</span> <span class="n">spectral_mode</span><span class="o">=</span><span class="n">spectral_mode</span><span class="p">)]</span>

            <span class="n">wanted_data</span> <span class="o">=</span> <span class="p">[(</span><span class="n">w</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">w</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span><span class="n">sp1</span><span class="p">,</span><span class="n">sp2</span><span class="p">)]</span>   

        <span class="c1"># Retrieve the metadata</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()</span>

        <span class="k">if</span> <span class="s1">&#39;group_description&#39;</span> <span class="ow">in</span> <span class="n">info</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>                
            <span class="n">group_descriptions</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;group_description&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">group_descriptions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>        


        <span class="c1"># Define the colour of the curves</span>
        <span class="k">if</span> <span class="n">colors</span> <span class="o">==</span> <span class="s1">&#39;sample&#39;</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sRGB</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">colors</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">colors</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>

        <span class="c1"># Define the labels</span>
        <span class="k">if</span> <span class="n">legend_labels</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
            <span class="n">legend_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_meas_ids</span><span class="p">,</span><span class="n">group_descriptions</span><span class="p">)]</span>
            <span class="n">legend_title</span> <span class="o">=</span> <span class="s1">&#39;Measurement $n^o$&#39;</span>

        <span class="c1"># Whether to compute the first derivative</span>
        <span class="k">if</span> <span class="n">derivation</span><span class="p">:</span>
            <span class="k">pass</span>  <span class="c1"># to implement in future versions</span>
            <span class="c1">#wanted_data = [x.reset_index() for x in wanted_data]</span>
            <span class="c1">#wanted_data = [pd.concat([x.iloc[:,0], pd.DataFrame(np.gradient(x.iloc[:,1:], axis=0))], axis=1) for x in wanted_data]</span>
            <span class="c1">#wanted_data = [x.set_index(x.columns.get_level_values(0)[0]) for x in wanted_data] </span>


        <span class="c1">#return wanted_data</span>
        <span class="n">plotting</span><span class="o">.</span><span class="n">spectra</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">wanted_data</span><span class="p">,</span> <span class="n">spectral_mode</span><span class="o">=</span><span class="n">spectral_mode</span><span class="p">,</span> <span class="n">x_range</span><span class="o">=</span><span class="n">wl_range</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">fontsize_legend</span><span class="o">=</span><span class="n">legend_fontsize</span><span class="p">,</span> <span class="n">legend_labels</span><span class="o">=</span><span class="n">legend_labels</span><span class="p">,</span> <span class="n">legend_title</span><span class="o">=</span><span class="n">legend_title</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">derivation</span><span class="o">=</span><span class="n">derivation</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">make_report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder_figures</span><span class="p">,</span> <span class="n">folder_report</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;cwd&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="n">authors</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">):</span>


        <span class="n">all_figure_files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">folder_figures</span><span class="p">)</span>   

        <span class="c1"># Define the folder where the report should be saved</span>
        <span class="k">if</span> <span class="n">folder_report</span> <span class="o">==</span> <span class="s1">&#39;cwd&#39;</span><span class="p">:</span>
            <span class="n">folder_report</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>  
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">Path</span><span class="p">(</span><span class="n">folder_report</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The folder report you entered (</span><span class="si">{</span><span class="n">folder_report</span><span class="si">}</span><span class="s1">) is not valid.&#39;</span><span class="p">)</span>
                <span class="k">return</span>  
            <span class="k">else</span><span class="p">:</span>
                <span class="n">folder_report</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">folder_report</span><span class="p">)</span> 

        <span class="c1"># Define some functions</span>
        <span class="k">def</span> <span class="nf">generate_latex_table</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
            <span class="n">table_rows</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
                <span class="n">table_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39; &amp; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; </span><span class="se">\\\\</span><span class="s1"> &#39;</span><span class="p">)</span> 
            <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">table_rows</span><span class="p">)</span>


        <span class="k">def</span> <span class="nf">combine_images</span><span class="p">(</span><span class="n">sp_report_path</span><span class="p">,</span> <span class="n">swv_circles_report_path</span><span class="p">,</span> <span class="n">dlch_report_path</span><span class="p">,</span> <span class="n">output_path</span><span class="p">):</span>

            <span class="c1"># Open the images</span>
            <span class="n">sp_report</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">sp_report_path</span><span class="p">)</span>
            <span class="n">swv_circles_report</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">swv_circles_report_path</span><span class="p">)</span>
            <span class="n">dlch_report</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">dlch_report_path</span><span class="p">)</span>

            <span class="c1"># Define the desired width for the images in the left column</span>
            <span class="n">desired_width_left</span> <span class="o">=</span> <span class="mi">1100</span>  <span class="c1"># Adjust as needed</span>
            <span class="n">desired_width_right</span> <span class="o">=</span> <span class="mi">400</span>  <span class="c1"># Adjust as needed</span>

            <span class="c1"># Calculate the scaling factors</span>
            <span class="n">sp_scaling_factor</span> <span class="o">=</span> <span class="n">desired_width_left</span> <span class="o">/</span> <span class="n">sp_report</span><span class="o">.</span><span class="n">width</span>
            <span class="n">swv_scaling_factor</span> <span class="o">=</span> <span class="n">desired_width_right</span> <span class="o">/</span> <span class="n">swv_circles_report</span><span class="o">.</span><span class="n">width</span>
            <span class="n">dlch_scaling_factor</span> <span class="o">=</span> <span class="n">desired_width_left</span> <span class="o">/</span> <span class="n">dlch_report</span><span class="o">.</span><span class="n">width</span>

            <span class="c1"># Calculate the new sizes while maintaining aspect ratio</span>
            <span class="n">sp_new_size</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sp_report</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="n">sp_scaling_factor</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">sp_report</span><span class="o">.</span><span class="n">height</span> <span class="o">*</span> <span class="n">sp_scaling_factor</span><span class="p">))</span>
            <span class="n">swv_new_size</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">swv_circles_report</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="n">swv_scaling_factor</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">swv_circles_report</span><span class="o">.</span><span class="n">height</span> <span class="o">*</span> <span class="n">swv_scaling_factor</span><span class="p">))</span>
            <span class="n">dlch_new_size</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">dlch_report</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="n">dlch_scaling_factor</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">dlch_report</span><span class="o">.</span><span class="n">height</span> <span class="o">*</span> <span class="n">dlch_scaling_factor</span><span class="p">))</span>

            <span class="c1"># Resize the images</span>
            <span class="n">sp_report_resized</span> <span class="o">=</span> <span class="n">sp_report</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">sp_new_size</span><span class="p">,</span> <span class="n">Image</span><span class="o">.</span><span class="n">LANCZOS</span><span class="p">)</span>
            <span class="n">swv_circles_report_resized</span> <span class="o">=</span> <span class="n">swv_circles_report</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">swv_new_size</span><span class="p">,</span> <span class="n">Image</span><span class="o">.</span><span class="n">LANCZOS</span><span class="p">)</span>
            <span class="n">dlch_report_resized</span> <span class="o">=</span> <span class="n">dlch_report</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">dlch_new_size</span><span class="p">,</span> <span class="n">Image</span><span class="o">.</span><span class="n">LANCZOS</span><span class="p">)</span>

            <span class="c1"># Calculate the total width and height for the combined image</span>
            <span class="n">total_width</span> <span class="o">=</span> <span class="n">desired_width_left</span> <span class="o">+</span> <span class="n">desired_width_right</span>            
            <span class="n">total_height</span> <span class="o">=</span> <span class="n">sp_new_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dlch_new_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>            

            <span class="c1"># Create a new blank image with white background</span>
            <span class="n">combined_image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">total_width</span><span class="p">,</span> <span class="n">total_height</span><span class="p">),</span> <span class="s1">&#39;white&#39;</span><span class="p">)</span>

            <span class="c1"># Paste the resized images into the combined image</span>
            <span class="n">combined_image</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">sp_report_resized</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
            <span class="n">combined_image</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">swv_circles_report_resized</span><span class="p">,</span> <span class="p">(</span><span class="n">desired_width_left</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>            
            <span class="n">combined_image</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">dlch_report_resized</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sp_new_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

            <span class="c1"># Save the combined image</span>
            <span class="n">combined_image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span>




        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;single&#39;</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">file</span><span class="p">,</span> <span class="nb">id</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_meas_ids</span><span class="p">):</span>


                <span class="n">figure1</span> <span class="o">=</span> <span class="p">[</span><span class="n">file</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">all_figure_files</span> <span class="k">if</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">file</span> <span class="ow">and</span> <span class="s1">&#39;CIELAB-report&#39;</span> <span class="ow">in</span> <span class="n">file</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>                
                <span class="n">figure_SP</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">folder_figures</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">all_figure_files</span> <span class="k">if</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s1">&#39;</span> <span class="ow">in</span> <span class="n">file</span> <span class="ow">and</span> <span class="s1">&#39;SP-report&#39;</span> <span class="ow">in</span> <span class="n">file</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">figure_dLCh</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">folder_figures</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">all_figure_files</span> <span class="k">if</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s1">&#39;</span> <span class="ow">in</span> <span class="n">file</span> <span class="ow">and</span> <span class="s1">&#39;dLCh-report&#39;</span> <span class="ow">in</span> <span class="n">file</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">figure_SW</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">folder_figures</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">all_figure_files</span> <span class="k">if</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s1">&#39;</span> <span class="ow">in</span> <span class="n">file</span> <span class="ow">and</span> <span class="s1">&#39;SWVcircles-report&#39;</span> <span class="ow">in</span> <span class="n">file</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">im_combined_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">folder_figures</span><span class="p">)</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s1">_report_SP-dLCh-SW.png&#39;</span>

                <span class="c1"># Combine the images</span>
                <span class="n">combine_images</span><span class="p">(</span><span class="n">figure_SP</span><span class="p">,</span> <span class="n">figure_SW</span><span class="p">,</span> <span class="n">figure_dLCh</span><span class="p">,</span> <span class="n">im_combined_path</span><span class="p">)</span>

                <span class="n">metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="nb">id</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">authors</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
                    <span class="n">authors</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;authors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>

                <span class="n">host_institution</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;host_institution&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="s1">&#39;_&#39;</span> <span class="ow">in</span> <span class="n">host_institution</span><span class="p">:</span>
                    <span class="n">host_institution_name</span> <span class="o">=</span> <span class="n">host_institution</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">host_institution_department</span> <span class="o">=</span> <span class="n">host_institution</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">host_institution_name</span> <span class="o">=</span> <span class="n">host_institution</span>
                    <span class="n">host_institution_department</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>


                <span class="n">BWSE</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;BWSE&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">BWSE</span><span class="p">):</span>
                    <span class="n">BWSE</span> <span class="o">=</span> <span class="s1">&#39;undefined&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">BWSE</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">BWSE</span><span class="p">)</span>

                <span class="n">spot_materials</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;spot_components&#39;</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">spot_materials</span><span class="p">):</span>
                    <span class="n">spot_materials</span> <span class="o">=</span> <span class="s1">&#39;undefined&#39;</span>                    

                <span class="k">elif</span> <span class="s1">&#39;_&#39;</span> <span class="ow">in</span> <span class="n">spot_materials</span><span class="p">:</span>
                    <span class="n">spot_materials</span> <span class="o">=</span> <span class="n">spot_materials</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>


                <span class="n">info_object</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf{Analysis ID} &amp; [analysisId] </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf{Analysis date} &amp; [analysisDate] </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf{Object ID} &amp; [objectId] </span><span class="se">\\\\</span><span class="s2">                </span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf</span><span class="si">{Institution}</span><span class="s2"> &amp; [institution] </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf{Name object} &amp; [objectName] </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf</span><span class="si">{Artist}</span><span class="s2"> &amp; [artist] </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf</span><span class="si">{Date}</span><span class="s2"> &amp; [objectDate] </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf</span><span class="si">{Techniques}</span><span class="s2"> &amp; [techniques] </span><span class="se">\\\\</span><span class="s2">                                    </span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf{MFT group} &amp; [MFTgroup] </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf{MFT spot} &amp; [spot_description] </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf</span><span class="si">{Materials}</span><span class="s2"> &amp; [spot_materials] </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf</span><span class="si">{BWSE}</span><span class="s2"> &amp; [BWSE] </span><span class="se">\\\\</span>
<span class="s2">                    &amp; </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf{MFT device} &amp; [device] </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf{MFT lamp} &amp; [lamp] </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf{MFT spot size} &amp; [spotSize] </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf</span><span class="si">{Illuminance}</span><span class="s2"> &amp; [ill] </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf</span><span class="si">{Irradiance}</span><span class="s2"> &amp; [irr] </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf{Exposure dose} &amp; [Hv] </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf{Radiant energy} &amp; [He] </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf</span><span class="si">{Duration}</span><span class="s2"> &amp; [duration] </span><span class="se">\\\\</span><span class="s2">                 </span>
<span class="s2">                &quot;&quot;&quot;</span>


                <span class="c1"># define the mapping table</span>
                <span class="n">mapping_table_object</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;[analysisId]&#39;</span><span class="p">:</span> <span class="nb">id</span><span class="p">,</span>
                    <span class="s1">&#39;[analysisDate]&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">]),</span>
                    <span class="s1">&#39;[objectId]&#39;</span><span class="p">:</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;object_id&#39;</span><span class="p">],</span>                
                    <span class="s1">&#39;[institution]&#39;</span><span class="p">:</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;institution&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;[objectName]&#39;</span><span class="p">:</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;object_name&#39;</span><span class="p">],</span> 
                    <span class="s1">&#39;[artist]&#39;</span> <span class="p">:</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;object_creator&#39;</span><span class="p">],</span>   
                    <span class="s1">&#39;[objectDate]&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;object_date&#39;</span><span class="p">]),</span>
                    <span class="s1">&#39;[techniques]&#39;</span> <span class="p">:</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;object_technique&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">),</span>
                    <span class="s1">&#39;[spot_materials]&#39;</span><span class="p">:</span> <span class="n">spot_materials</span><span class="p">,</span>
                    <span class="s1">&#39;[NbAnalyses]&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;measurements_N&#39;</span><span class="p">]),</span>  
                    <span class="s1">&#39;[MFTgroup]&#39;</span><span class="p">:</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;spot_group&#39;</span><span class="p">],</span> 
                    <span class="s1">&#39;[ill]&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;illuminance_Ev_Mlx&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> Mlx&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;[irr]&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;irradiance_Ee_W/m^2&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> W/m2&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;[Hv]&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;exposureDose_Hv_Mlxh&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> Mlxh&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;[He]&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;radiantExposure_He_MJ/m^2&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> MJ/m2&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;[duration]&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;duration_min&quot;</span><span class="p">])</span><span class="si">}</span><span class="s1"> min&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;[device]&#39;</span> <span class="p">:</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">),</span>
                    <span class="s1">&#39;[lamp]&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;lamp_fading&#39;</span><span class="p">]),</span>
                    <span class="s1">&#39;[spot_description]&#39;</span><span class="p">:</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;spot_description&#39;</span><span class="p">],</span>      
                    <span class="s1">&#39;[spotSize]&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;FWHM_micron&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> microns&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;[BWSE]&#39;</span><span class="p">:</span> <span class="n">BWSE</span><span class="p">,</span>
                    <span class="p">}</span>
                <span class="c1">#print(mapping_table_object).values()</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">mapping_table_object</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>                                 
                    <span class="n">info_object</span> <span class="o">=</span> <span class="n">info_object</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mapping_table_object</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>            


                <span class="n">table_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;info_object&#39;</span><span class="p">:</span> <span class="n">info_object</span><span class="p">}</span>

                <span class="n">figure_paths</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;figure1&#39;</span><span class="p">:</span> <span class="n">folder_figures</span> <span class="o">/</span> <span class="n">figure1</span><span class="p">,</span>
                    <span class="s1">&#39;figure2&#39;</span><span class="p">:</span> <span class="n">im_combined_path</span><span class="p">,</span>                                 
                <span class="p">}</span>

                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s1">&#39;report_templates&#39;</span> <span class="o">/</span> <span class="s1">&#39;MFT_report_single.tex&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">template_file</span><span class="p">:</span>
                    <span class="n">template</span> <span class="o">=</span> <span class="n">template_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

                <span class="c1"># Fill in placeholders with actual values</span>
                <span class="n">filled_template</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[PROJECTID]&#39;</span><span class="p">,</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;project_id&#39;</span><span class="p">])</span>
                <span class="n">filled_template</span> <span class="o">=</span> <span class="n">filled_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[ANALYSISID]&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>
                <span class="n">filled_template</span> <span class="o">=</span> <span class="n">filled_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[INSTITUTION]&#39;</span><span class="p">,</span> <span class="n">host_institution_name</span><span class="p">)</span>
                <span class="c1">#filled_template = filled_template.replace(&#39;[DEPARTMENT]&#39;, host_institution_department)</span>
                <span class="n">filled_template</span> <span class="o">=</span> <span class="n">filled_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[YOURNAME]&#39;</span><span class="p">,</span> <span class="n">authors</span><span class="p">)</span>
                <span class="n">filled_template</span> <span class="o">=</span> <span class="n">filled_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[TABLE1DATA]&#39;</span><span class="p">,</span> <span class="n">table_data</span><span class="p">[</span><span class="s1">&#39;info_object&#39;</span><span class="p">])</span>            
                <span class="n">filled_template</span> <span class="o">=</span> <span class="n">filled_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[FIGURE1PATH]&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">figure_paths</span><span class="p">[</span><span class="s1">&#39;figure1&#39;</span><span class="p">]))</span>
                <span class="n">filled_template</span> <span class="o">=</span> <span class="n">filled_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[FIGURE2PATH]&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">figure_paths</span><span class="p">[</span><span class="s1">&#39;figure2&#39;</span><span class="p">]))</span>                


                <span class="c1"># Write filled template to .tex file</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;temp_report.tex&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">temp_file</span><span class="p">:</span>
                    <span class="n">temp_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filled_template</span><span class="p">)</span>

                <span class="c1"># Compile .tex file into PDF</span>
                <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;pdflatex&#39;</span><span class="p">,</span> <span class="s1">&#39;temp_report.tex&#39;</span><span class="p">])</span>

                <span class="c1"># Move generated PDF to output file                </span>
                <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;mv&#39;</span><span class="p">,</span> <span class="s1">&#39;temp_report.pdf&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">folder_report</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;project_id&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">_MFT_rapport-analysis_</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s1">.pdf&#39;</span><span class="p">])</span>

                <span class="c1"># Clean up temporary .tex and auxiliary files</span>
                <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;rm&#39;</span><span class="p">,</span> <span class="s1">&#39;temp_report.tex&#39;</span><span class="p">,</span> <span class="s1">&#39;temp_report.aux&#39;</span><span class="p">,</span> <span class="s1">&#39;temp_report.log&#39;</span><span class="p">])</span>


        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;object&#39;</span><span class="p">:</span>

            <span class="n">object_ids</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">(</span><span class="s1">&#39;object_id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
            <span class="n">metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()</span>

            <span class="nb">print</span><span class="p">(</span><span class="n">object_ids</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">object_id</span> <span class="ow">in</span> <span class="n">object_ids</span><span class="p">:</span>


                <span class="n">figure_spots</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">folder_figures</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">all_figure_files</span> <span class="k">if</span> <span class="n">object_id</span> <span class="ow">in</span> <span class="n">file</span> <span class="ow">and</span> <span class="s1">&#39;MFT-spots&#39;</span> <span class="ow">in</span> <span class="n">file</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>                
                <span class="n">figure_dE</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">folder_figures</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">all_figure_files</span> <span class="k">if</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">object_id</span><span class="si">}</span><span class="s1">&#39;</span> <span class="ow">in</span> <span class="n">file</span> <span class="ow">and</span> <span class="s1">&#39;dE-curves-report&#39;</span> <span class="ow">in</span> <span class="n">file</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">figure_SW</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">folder_figures</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">all_figure_files</span> <span class="k">if</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">object_id</span><span class="si">}</span><span class="s1">&#39;</span> <span class="ow">in</span> <span class="n">file</span> <span class="ow">and</span> <span class="s1">&#39;SW-rect-report&#39;</span> <span class="ow">in</span> <span class="n">file</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>


                <span class="n">metadata_object</span> <span class="o">=</span> <span class="n">metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">object_id</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">authors</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
                    <span class="n">authors</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;authors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>

                <span class="n">host_institution</span> <span class="o">=</span> <span class="n">metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;host_institution&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>

                <span class="n">info_object</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf{Object ID} &amp; [objectId] </span><span class="se">\\\\</span><span class="s2">                </span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf</span><span class="si">{Institution}</span><span class="s2"> &amp; [institution] </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf{Object name} &amp; [objectName] </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf</span><span class="si">{Artist}</span><span class="s2"> &amp; [artist] </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf</span><span class="si">{Date}</span><span class="s2"> &amp; [objectDate] </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf</span><span class="si">{Techniques}</span><span class="s2"> &amp; [technique] </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf</span><span class="si">{Materials}</span><span class="s2"> &amp; [objectMaterial] </span><span class="se">\\\\</span>
<span class="s2">                    &amp; </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf{N</span><span class="se">\\</span><span class="s2">textsuperscript</span><span class="si">{o}</span><span class="s2"> MFT analyses} &amp; [NbAnalyses] </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf{N</span><span class="se">\\</span><span class="s2">textsuperscript</span><span class="si">{o}</span><span class="s2"> MFT groups} &amp; [NbGroups] </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf</span><span class="si">{Illuminance}</span><span class="s2"> &amp; [ill] </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf{Exposure dose} &amp; [Hv] </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf</span><span class="si">{Duration}</span><span class="s2"> &amp; [duration] </span><span class="se">\\\\</span><span class="s2">                 </span>
<span class="s2">                &quot;&quot;&quot;</span>


                <span class="n">BWSE</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;                </span>
<span class="s2">                    [nb01] &amp; [BWSE01] </span><span class="se">\\\\</span>
<span class="s2">                    [nb02]  &amp; [BWSE02] </span><span class="se">\\\\</span><span class="s2">  </span>
<span class="s2">                    [nb03] &amp; [BWSE03] </span><span class="se">\\\\</span><span class="s2">                                   </span>
<span class="s2">                &quot;&quot;&quot;</span>




                <span class="c1">#table_data2 = generate_latex_table(df)</span>

                <span class="n">nb_analyses</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">metadata_object</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">nb_groups</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">metadata_object</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;spot_group&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
                <span class="n">ill</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">metadata_object</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;illuminance_Ev_Mlx&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">Hv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">metadata_object</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;exposureDose_Hv_Mlxh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>

                <span class="n">object_materials</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_material&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="s2">&quot;_&quot;</span> <span class="ow">in</span> <span class="n">object_materials</span><span class="p">:</span>
                    <span class="n">object_materials</span> <span class="o">=</span> <span class="n">object_materials</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span><span class="s1">&#39;, &#39;</span><span class="p">)</span>

                <span class="c1"># define the mapping table</span>
                <span class="n">mapping_table_object</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;[objectId]&#39;</span><span class="p">:</span> <span class="n">object_id</span><span class="p">,</span>                
                    <span class="s1">&#39;[institution]&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;institution&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="s1">&#39;[objectName]&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))[</span><span class="mi">0</span><span class="p">],</span> 
                    <span class="s1">&#39;[artist]&#39;</span> <span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_creator&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))[</span><span class="mi">0</span><span class="p">],</span>   
                    <span class="s1">&#39;[objectDate]&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="s1">&#39;[technique]&#39;</span> <span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_technique&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="s1">&#39;[objectMaterial]&#39;</span><span class="p">:</span> <span class="n">object_materials</span><span class="p">,</span>
                    <span class="s1">&#39;[NbAnalyses]&#39;</span><span class="p">:</span> <span class="n">nb_analyses</span><span class="p">,</span>  
                    <span class="s1">&#39;[NbGroups]&#39;</span><span class="p">:</span> <span class="n">nb_groups</span><span class="p">,</span> 
                    <span class="s1">&#39;[ill]&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ill</span><span class="si">}</span><span class="s1"> Mlx (Avg)&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;[Hv]&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Hv</span><span class="si">}</span><span class="s1"> Mlxh (Avg)&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;[duration]&#39;</span><span class="p">:</span> <span class="s1">&#39;15 min&#39;</span> <span class="c1"># f&#39;{(metadata.loc[&quot;duration_min&quot;].values)} min&#39;,            </span>
                    <span class="p">}</span>           
                <span class="c1">#print(mapping_table_object) </span>

                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">mapping_table_object</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">info_object</span> <span class="o">=</span> <span class="n">info_object</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mapping_table_object</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>    


                <span class="n">table_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;info_object&#39;</span><span class="p">:</span> <span class="n">info_object</span><span class="p">,</span> <span class="s1">&#39;BWSE&#39;</span><span class="p">:</span> <span class="n">BWSE</span><span class="p">}</span>


                <span class="n">figure_paths</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;figure1&#39;</span><span class="p">:</span> <span class="n">folder_figures</span> <span class="o">/</span> <span class="n">figure_spots</span><span class="p">,</span>
                    <span class="s1">&#39;figure2&#39;</span><span class="p">:</span> <span class="n">folder_figures</span> <span class="o">/</span> <span class="n">figure_dE</span><span class="p">,</span>
                    <span class="s1">&#39;figure3&#39;</span><span class="p">:</span> <span class="n">folder_figures</span> <span class="o">/</span> <span class="n">figure_SW</span><span class="p">,</span>                                 
                <span class="p">}</span>

                <span class="n">BWSE</span> <span class="o">=</span> <span class="n">metadata_object</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;BWSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">BWSE</span><span class="p">)</span>
                <span class="n">simplified_BWSE</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">BWSE</span><span class="p">:</span>
                    <span class="n">i</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span><span class="mf">0.8</span> <span class="ow">and</span> <span class="n">i</span><span class="o">&lt;=</span><span class="mf">1.2</span><span class="p">:</span>
                        <span class="n">new_i</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span><span class="mf">1.2</span> <span class="ow">and</span> <span class="n">i</span><span class="o">&lt;=</span><span class="mf">1.8</span><span class="p">:</span>
                        <span class="n">new_i</span> <span class="o">=</span> <span class="s1">&#39;1-2&#39;</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span><span class="mf">1.8</span> <span class="ow">and</span> <span class="n">i</span><span class="o">&lt;=</span><span class="mf">2.2</span><span class="p">:</span>
                        <span class="n">new_i</span> <span class="o">=</span> <span class="s1">&#39;2&#39;</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span><span class="mf">2.2</span> <span class="ow">and</span> <span class="n">i</span><span class="o">&lt;=</span><span class="mf">2.8</span><span class="p">:</span>
                        <span class="n">new_i</span> <span class="o">=</span> <span class="s1">&#39;2-3&#39;</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span><span class="mf">2.8</span> <span class="ow">and</span> <span class="n">i</span><span class="o">&lt;=</span><span class="mf">3.2</span><span class="p">:</span>
                        <span class="n">new_i</span> <span class="o">=</span> <span class="s1">&#39;3&#39;</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span><span class="mf">3.2</span> <span class="ow">and</span> <span class="n">i</span><span class="o">&lt;=</span><span class="mf">3.8</span><span class="p">:</span>
                        <span class="n">new_i</span> <span class="o">=</span> <span class="s1">&#39;3&#39;</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span><span class="mf">3.8</span> <span class="ow">and</span> <span class="n">i</span><span class="o">&lt;=</span><span class="mf">4.2</span><span class="p">:</span>
                        <span class="n">new_i</span> <span class="o">=</span> <span class="s1">&#39;4&#39;</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span><span class="mf">4.2</span> <span class="ow">and</span> <span class="n">i</span><span class="o">&lt;=</span><span class="mf">4.8</span><span class="p">:</span>
                        <span class="n">new_i</span> <span class="o">=</span> <span class="s1">&#39;4-5&#39;</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span><span class="mf">0.8</span> <span class="ow">and</span> <span class="n">i</span><span class="o">&lt;=</span><span class="mf">1.2</span><span class="p">:</span>
                        <span class="n">new_i</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span><span class="mf">5.2</span> <span class="ow">and</span> <span class="n">i</span><span class="o">&lt;=</span><span class="mf">5.8</span><span class="p">:</span>
                        <span class="n">new_i</span> <span class="o">=</span> <span class="s1">&#39;5-6&#39;</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span><span class="mf">5.8</span> <span class="ow">and</span> <span class="n">i</span><span class="o">&lt;=</span><span class="mf">6.2</span><span class="p">:</span>
                        <span class="n">new_i</span> <span class="o">=</span> <span class="s1">&#39;6&#39;</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span><span class="mf">6.2</span> <span class="ow">and</span> <span class="n">i</span><span class="o">&lt;=</span><span class="mf">6.8</span><span class="p">:</span>
                        <span class="n">new_i</span> <span class="o">=</span> <span class="s1">&#39;6-7&#39;</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span><span class="mf">6.8</span> <span class="ow">and</span> <span class="n">i</span><span class="o">&lt;=</span><span class="mf">7.2</span><span class="p">:</span>
                        <span class="n">new_i</span> <span class="o">=</span> <span class="s1">&#39;7&#39;</span>

                    <span class="k">if</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
                        <span class="k">pass</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">simplified_BWSE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_i</span><span class="p">)</span>


                <span class="n">nb_MFT</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">metadata_object</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;meas_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>

                <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span>
                    <span class="c1">#&#39;Description&#39;:group_description,</span>
                    <span class="c1">#&#39;Groups&#39;: group,</span>
                    <span class="s1">&#39;MFT&#39;</span><span class="p">:</span> <span class="n">nb_MFT</span><span class="p">,</span>
                    <span class="s1">&#39;BWSE&#39;</span><span class="p">:</span> <span class="n">simplified_BWSE</span><span class="p">,</span>
                <span class="p">})</span>

                <span class="n">table_data2</span> <span class="o">=</span> <span class="n">generate_latex_table</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

                <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">nb_MFT</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">simplified_BWSE</span><span class="p">)</span>



                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s1">&#39;report_templates&#39;</span> <span class="o">/</span> <span class="s1">&#39;MFT_report_object.tex&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">template_file</span><span class="p">:</span>
                    <span class="n">template</span> <span class="o">=</span> <span class="n">template_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

                <span class="c1"># Fill in placeholders with actual values</span>
                <span class="n">filled_template</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[PROJECTID]&#39;</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;project_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">filled_template</span> <span class="o">=</span> <span class="n">filled_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[OBJECTID]&#39;</span><span class="p">,</span> <span class="n">object_id</span><span class="p">)</span>
                <span class="n">filled_template</span> <span class="o">=</span> <span class="n">filled_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[LABORATORY]&#39;</span><span class="p">,</span> <span class="n">host_institution</span><span class="p">)</span>
                <span class="n">filled_template</span> <span class="o">=</span> <span class="n">filled_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[YOURNAME]&#39;</span><span class="p">,</span> <span class="n">authors</span><span class="p">)</span>
                <span class="n">filled_template</span> <span class="o">=</span> <span class="n">filled_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[TABLE1DATA]&#39;</span><span class="p">,</span> <span class="n">table_data</span><span class="p">[</span><span class="s1">&#39;info_object&#39;</span><span class="p">])</span>  
                <span class="c1">#filled_template = filled_template.replace(&#39;[TABLE_DATA2]&#39;, table_data[&#39;BWSE&#39;])            </span>
                <span class="n">filled_template</span> <span class="o">=</span> <span class="n">filled_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[FIGURE1PATH]&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">figure_paths</span><span class="p">[</span><span class="s1">&#39;figure1&#39;</span><span class="p">]))</span>
                <span class="n">filled_template</span> <span class="o">=</span> <span class="n">filled_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[FIGURE2PATH]&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">figure_paths</span><span class="p">[</span><span class="s1">&#39;figure2&#39;</span><span class="p">]))</span> 
                <span class="n">filled_template</span> <span class="o">=</span> <span class="n">filled_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[FIGURE3PATH]&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">figure_paths</span><span class="p">[</span><span class="s1">&#39;figure3&#39;</span><span class="p">]))</span> 
                <span class="n">filled_template</span> <span class="o">=</span> <span class="n">filled_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;% TABLE_DATA2&#39;</span><span class="p">,</span> <span class="n">table_data2</span><span class="p">)</span>


                <span class="c1"># Write filled template to .tex file</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;temp_report.tex&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">temp_file</span><span class="p">:</span>
                    <span class="n">temp_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filled_template</span><span class="p">)</span>

                <span class="c1"># Compile .tex file into PDF</span>
                <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;pdflatex&#39;</span><span class="p">,</span> <span class="s1">&#39;temp_report.tex&#39;</span><span class="p">])</span>

                <span class="c1"># Move generated PDF to output file                </span>
                <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;mv&#39;</span><span class="p">,</span> <span class="s1">&#39;temp_report.pdf&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">folder_report</span><span class="si">}</span><span class="s1">/MFT_rapport-object_</span><span class="si">{</span><span class="n">object_id</span><span class="si">}</span><span class="s1">.pdf&#39;</span><span class="p">])</span>

                <span class="c1"># Clean up temporary .tex and auxiliary files</span>
                <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;rm&#39;</span><span class="p">,</span> <span class="s1">&#39;temp_report.tex&#39;</span><span class="p">,</span> <span class="s1">&#39;temp_report.aux&#39;</span><span class="p">,</span> <span class="s1">&#39;temp_report.log&#39;</span><span class="p">])</span>



        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;project&#39;</span><span class="p">:</span>

            <span class="n">all_metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()</span>
            <span class="n">project_ids</span> <span class="o">=</span> <span class="n">all_metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;project_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">db_projects</span> <span class="o">=</span> <span class="n">get_DB</span><span class="p">(</span><span class="s1">&#39;projects&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;project_id&#39;</span><span class="p">)</span>
            <span class="n">db_users</span> <span class="o">=</span> <span class="n">get_persons</span><span class="p">()</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;initials&#39;</span><span class="p">)</span>



            <span class="k">for</span> <span class="n">project_id</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">project_ids</span><span class="p">)):</span>

                <span class="n">metadata</span> <span class="o">=</span> <span class="n">all_metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">all_metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;project_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">project_id</span><span class="p">]</span>
                <span class="n">project_info</span> <span class="o">=</span> <span class="n">db_projects</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">project_id</span><span class="p">]</span>

                <span class="n">project_leader_initials</span> <span class="o">=</span> <span class="n">project_info</span><span class="p">[</span><span class="s1">&#39;project_leader&#39;</span><span class="p">]</span>
                <span class="n">project_leader_info</span> <span class="o">=</span> <span class="n">db_users</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">project_leader_initials</span><span class="p">]</span>
                <span class="n">project_leader_name</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">project_leader_info</span><span class="p">[[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;surname&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

                <span class="n">start_date</span> <span class="o">=</span> <span class="n">project_info</span><span class="p">[</span><span class="s1">&#39;start_date&#39;</span><span class="p">]</span>

                <span class="n">institution</span> <span class="o">=</span> <span class="n">project_info</span><span class="p">[</span><span class="s1">&#39;institution&#39;</span><span class="p">]</span>

                <span class="n">host_institution</span> <span class="o">=</span> <span class="n">metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;host_institution&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>


                <span class="n">keywords</span> <span class="o">=</span> <span class="n">project_info</span><span class="p">[</span><span class="s1">&#39;keywords&#39;</span><span class="p">]</span>

                <span class="n">methods</span> <span class="o">=</span> <span class="n">project_info</span><span class="p">[</span><span class="s1">&#39;methods&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="s2">&quot;_&quot;</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
                    <span class="n">methods</span> <span class="o">=</span> <span class="n">methods</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>

                <span class="n">device</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="s2">&quot;_&quot;</span> <span class="ow">in</span> <span class="n">device</span><span class="p">:</span>
                    <span class="n">device</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>

                <span class="n">lamp</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;lamp_fading&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">nb_analyses</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">metadata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">nb_objects</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))))</span>



                <span class="n">figure_BWSE_hist</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">folder_figures</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">all_figure_files</span> <span class="k">if</span> <span class="n">project_id</span> <span class="ow">in</span> <span class="n">file</span> <span class="ow">and</span> <span class="s1">&#39;BWSE-hist-report&#39;</span> <span class="ow">in</span> <span class="n">file</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>                
                <span class="n">figure_BWSE_bars</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">folder_figures</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">all_figure_files</span> <span class="k">if</span> <span class="n">project_id</span> <span class="ow">in</span> <span class="n">file</span> <span class="ow">and</span> <span class="s1">&#39;BWSE-bars-report&#39;</span> <span class="ow">in</span> <span class="n">file</span><span class="p">]</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">figure_BWSE_hist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The BWSE histogram figure cannot be found in the folder </span><span class="si">{</span><span class="n">folder_figures</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Make sure that the filename of the BWSE histogram figure contains the project ID (</span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s1">) and the expression &quot;BWSE-hist-report&quot;.&#39;</span><span class="p">)</span>
                    <span class="k">return</span>


                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">figure_BWSE_bars</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The BWSE bars figure cannot be found in the folder </span><span class="si">{</span><span class="n">folder_figures</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Make sure that the filename of the BWSE bars figures contain the project ID (</span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s1">) and the expression &quot;BWSE-bars-report&quot;.&#39;</span><span class="p">)</span>
                    <span class="k">return</span>

                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">figure_BWSE_bars</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">figure_BWSE_bars_01</span> <span class="o">=</span> <span class="n">figure_BWSE_bars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">figure_BWSE_bars</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">figure_BWSE_bars_01</span> <span class="o">=</span> <span class="n">figure_BWSE_bars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">figure_BWSE_bars_02</span> <span class="o">=</span> <span class="n">figure_BWSE_bars</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>



                <span class="n">info_project</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf{Project id} &amp; [projectId] </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf{Project leader} &amp; [projectLeader] </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf</span><span class="si">{Institution}</span><span class="s2"> &amp; [institution] </span><span class="se">\\\\</span><span class="s2">   </span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf{Start date} &amp; [startDate] </span><span class="se">\\\\</span><span class="s2">             </span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf</span><span class="si">{Keywords}</span><span class="s2"> &amp; [keywords] </span><span class="se">\\\\</span>
<span class="s2">                    &amp; </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf{MFT device} &amp; [MFTdevice] </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf{MFT lamp} &amp; [MFTlamp] </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf{N</span><span class="se">\\</span><span class="s2">textsuperscript</span><span class="si">{o}</span><span class="s2"> of analyses} &amp; [NbAnalyses] </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf{N</span><span class="se">\\</span><span class="s2">textsuperscript</span><span class="si">{o}</span><span class="s2"> of objects} &amp; [NbObjects] </span><span class="se">\\\\</span><span class="s2"> </span>
<span class="s2">                &quot;&quot;&quot;</span>
                <span class="n">info_analysis</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf{MFT device} &amp; [MFTdevice] </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf{N</span><span class="se">\\</span><span class="s2">textsuperscript</span><span class="si">{o}</span><span class="s2"> of analyses} &amp; [NbAnalyses] </span><span class="se">\\\\</span>
<span class="s2">                    </span><span class="se">\\</span><span class="s2">textbf{N</span><span class="se">\\</span><span class="s2">textsuperscript</span><span class="si">{o}</span><span class="s2"> of objects} &amp; [NbObjects] </span><span class="se">\\\\</span><span class="s2">                </span>
<span class="s2">                &quot;&quot;&quot;</span>

                <span class="c1"># define the mapping table</span>
                <span class="n">mapping_table_project</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;[projectId]&#39;</span><span class="p">:</span> <span class="n">project_id</span><span class="p">,</span>
                    <span class="s1">&#39;[projectLeader]&#39;</span><span class="p">:</span> <span class="n">project_leader_name</span><span class="p">,</span>
                    <span class="s1">&#39;[institution]&#39;</span><span class="p">:</span> <span class="n">institution</span><span class="p">,</span>                
                    <span class="s1">&#39;[keywords]&#39;</span> <span class="p">:</span> <span class="n">keywords</span><span class="p">,</span>  
                    <span class="s1">&#39;[methods]&#39;</span> <span class="p">:</span> <span class="n">methods</span><span class="p">,</span> 
                    <span class="s1">&#39;[startDate]&#39;</span> <span class="p">:</span> <span class="n">start_date</span><span class="p">,</span>
                    <span class="s1">&#39;[MFTdevice]&#39;</span><span class="p">:</span> <span class="n">device</span><span class="p">,</span>
                    <span class="s1">&#39;[MFTlamp]&#39;</span> <span class="p">:</span> <span class="n">lamp</span><span class="p">,</span>
                    <span class="s1">&#39;[NbAnalyses]&#39;</span><span class="p">:</span> <span class="n">nb_analyses</span><span class="p">,</span>
                    <span class="s1">&#39;[NbObjects]&#39;</span><span class="p">:</span> <span class="n">nb_objects</span><span class="p">,</span>             
                    <span class="p">}</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">mapping_table_project</span><span class="p">)</span>

                <span class="n">mapping_table_analyses</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;[MFTdevice]&#39;</span><span class="p">:</span> <span class="n">device</span><span class="p">,</span>
                    <span class="s1">&#39;[NbAnalyses]&#39;</span><span class="p">:</span> <span class="n">nb_analyses</span><span class="p">,</span>
                    <span class="s1">&#39;[NbObjects]&#39;</span><span class="p">:</span> <span class="n">nb_objects</span><span class="p">,</span>                                
                    <span class="p">}</span>



                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">mapping_table_project</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">info_project</span> <span class="o">=</span> <span class="n">info_project</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mapping_table_project</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>    

                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">mapping_table_analyses</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">info_analysis</span> <span class="o">=</span> <span class="n">info_analysis</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mapping_table_analyses</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>         


                <span class="n">table_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;info_project&#39;</span><span class="p">:</span> <span class="n">info_project</span><span class="p">,</span> <span class="s1">&#39;info_analysis&#39;</span><span class="p">:</span> <span class="n">info_analysis</span><span class="p">}</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">figure_BWSE_bars</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>                
                    <span class="n">figure_paths</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s1">&#39;figure1&#39;</span><span class="p">:</span> <span class="n">figure_BWSE_hist</span><span class="p">,</span>
                        <span class="s1">&#39;figure2&#39;</span><span class="p">:</span> <span class="n">figure_BWSE_bars_01</span><span class="p">,</span>
                        <span class="s1">&#39;figure3&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span>                    
                    <span class="p">}</span>

                <span class="k">else</span><span class="p">:</span> 
                    <span class="n">figure_paths</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s1">&#39;figure1&#39;</span><span class="p">:</span> <span class="n">figure_BWSE_hist</span><span class="p">,</span>
                        <span class="s1">&#39;figure2&#39;</span><span class="p">:</span> <span class="n">figure_BWSE_bars_01</span><span class="p">,</span>  
                        <span class="s1">&#39;figure3&#39;</span><span class="p">:</span> <span class="n">figure_BWSE_bars_02</span><span class="p">,</span>                  
                    <span class="p">}</span>


                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s1">&#39;report_templates&#39;</span> <span class="o">/</span> <span class="s1">&#39;MFT_report_project.tex&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">template_file</span><span class="p">:</span>
                    <span class="n">template</span> <span class="o">=</span> <span class="n">template_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

                <span class="c1"># Fill in placeholders with actual values</span>
                <span class="n">filled_template</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[PROJECTID]&#39;</span><span class="p">,</span> <span class="n">project_id</span><span class="p">)</span>
                <span class="n">filled_template</span> <span class="o">=</span> <span class="n">filled_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[INSTITUTION]&#39;</span><span class="p">,</span> <span class="n">host_institution</span><span class="p">)</span>
                <span class="n">filled_template</span> <span class="o">=</span> <span class="n">filled_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[YOURNAME]&#39;</span><span class="p">,</span> <span class="n">authors</span><span class="p">)</span>
                <span class="n">filled_template</span> <span class="o">=</span> <span class="n">filled_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[TABLE1DATA]&#39;</span><span class="p">,</span> <span class="n">table_data</span><span class="p">[</span><span class="s1">&#39;info_project&#39;</span><span class="p">])</span>
                <span class="c1">#filled_template = filled_template.replace(&#39;[TABLE2DATA]&#39;, table_data[&#39;info_analysis&#39;])</span>
                <span class="n">filled_template</span> <span class="o">=</span> <span class="n">filled_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[FIGURE1PATH]&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">figure_paths</span><span class="p">[</span><span class="s1">&#39;figure1&#39;</span><span class="p">]))</span>
                <span class="n">filled_template</span> <span class="o">=</span> <span class="n">filled_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[FIGURE2PATH]&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">figure_paths</span><span class="p">[</span><span class="s1">&#39;figure2&#39;</span><span class="p">]))</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">figure_BWSE_bars</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>                
                    <span class="n">filled_template</span> <span class="o">=</span> <span class="n">filled_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[FIGURE3PATH]&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">figure_paths</span><span class="p">[</span><span class="s1">&#39;figure3&#39;</span><span class="p">]))</span>

                <span class="c1"># Write filled template to .tex file</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;temp_report.tex&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">temp_file</span><span class="p">:</span>
                    <span class="n">temp_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filled_template</span><span class="p">)</span>

                <span class="c1"># Compile .tex file into PDF</span>
                <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;pdflatex&#39;</span><span class="p">,</span> <span class="s1">&#39;temp_report.tex&#39;</span><span class="p">])</span>

                <span class="c1"># Move generated PDF to output file                </span>
                <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;mv&#39;</span><span class="p">,</span> <span class="s1">&#39;temp_report.pdf&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">folder_report</span><span class="si">}</span><span class="s1">/MFT_rapport-project_</span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s1">.pdf&#39;</span><span class="p">])</span>                

                <span class="c1"># Clean up temporary .tex and auxiliary files</span>
                <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;rm&#39;</span><span class="p">,</span> <span class="s1">&#39;temp_report.tex&#39;</span><span class="p">,</span> <span class="s1">&#39;temp_report.aux&#39;</span><span class="p">,</span> <span class="s1">&#39;temp_report.log&#39;</span><span class="p">])</span>






    <span class="k">def</span> <span class="nf">make_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;BWSE&#39;</span><span class="p">],</span> <span class="n">sort_by</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;meas_id&#39;</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">subtitle</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>

        <span class="n">wanted_parameters</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;meas_id&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">parameters</span>

        <span class="n">df_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">(</span><span class="n">wanted_parameters</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="n">sort_by</span><span class="p">])</span>

        <span class="n">my_table</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">GT</span><span class="p">(</span><span class="n">df_info</span><span class="p">)</span>
        <span class="o">.</span><span class="n">tab_header</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
            <span class="n">subtitle</span><span class="o">=</span><span class="n">subtitle</span><span class="p">,</span>            
        <span class="p">)</span>
        <span class="o">.</span><span class="n">tab_style</span><span class="p">(</span>
            <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;18px&#39;</span><span class="p">),</span>
            <span class="n">locations</span><span class="o">=</span><span class="n">loc</span><span class="o">.</span><span class="n">column_header</span><span class="p">(),</span>
        <span class="p">)</span> 
        <span class="o">.</span><span class="n">cols_align</span><span class="p">(</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>      
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">my_table</span>


    <span class="k">def</span> <span class="nf">read_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheets</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="s1">&#39;CIELAB&#39;</span><span class="p">,</span> <span class="s1">&#39;spectra&#39;</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Read the data files given as argument when defining the instance of the MFT class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sheets : Optional[list], optional</span>
<span class="sd">            Name of the excel sheets to be selected, by default [&#39;info&#39;, &#39;CIELAB&#39;, &#39;spectra&#39;]</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A list of list of pandas dataframes</span>
<span class="sd">            The content of each input data file is returned as a list pandas dataframes (3 dataframes maximum, one dataframe per sheet). Ultimately, the function returns a list of list, so that when there are several input data files, each list - related a single file - corresponds to a single element of a list.            </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">files</span> <span class="o">=</span> <span class="p">[]</span>        

        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">:</span>

            <span class="n">df_info</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
            <span class="n">df_sp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;spectra&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">df_cl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;CIELAB&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>                      


            <span class="k">if</span> <span class="n">sheets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="s1">&#39;CIELAB&#39;</span><span class="p">,</span> <span class="s1">&#39;spectra&#39;</span><span class="p">]:</span>
                <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_info</span><span class="p">,</span> <span class="n">df_cl</span><span class="p">,</span> <span class="n">df_sp</span><span class="p">])</span>

            <span class="k">elif</span> <span class="n">sheets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">]:</span>
                <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_info</span><span class="p">])</span>

            <span class="k">elif</span> <span class="n">sheets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;CIELAB&#39;</span><span class="p">]:</span>
                <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_cl</span><span class="p">])</span>

            <span class="k">elif</span> <span class="n">sheets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;spectra&#39;</span><span class="p">]:</span>
                <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_sp</span><span class="p">])</span>

            <span class="k">elif</span> <span class="n">sheets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;spectra&#39;</span><span class="p">,</span> <span class="s1">&#39;CIELAB&#39;</span><span class="p">]:</span>
                <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_sp</span><span class="p">,</span> <span class="n">df_cl</span><span class="p">])</span>

            <span class="k">elif</span> <span class="n">sheets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;CIELAB&#39;</span><span class="p">,</span><span class="s1">&#39;spectra&#39;</span><span class="p">]:</span>
                <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_cl</span><span class="p">,</span> <span class="n">df_sp</span><span class="p">])</span>

            <span class="k">elif</span> <span class="n">sheets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">,</span><span class="s1">&#39;CIELAB&#39;</span><span class="p">]:</span>
                <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_info</span><span class="p">,</span> <span class="n">df_cl</span><span class="p">])</span>

            <span class="k">elif</span> <span class="n">sheets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">,</span><span class="s1">&#39;spectra&#39;</span><span class="p">]:</span>
                <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_info</span><span class="p">,</span> <span class="n">df_sp</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">files</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="microfading.microfading.MFT.get_meas_ids" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_meas_ids</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#microfading.microfading.MFT.get_meas_ids" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return the measurement id numbers corresponding to the input files.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="microfading.microfading.MFT.get_objects" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_objects</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#microfading.microfading.MFT.get_objects" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return the object id numbers corresponding to the input files.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="microfading.microfading.MFT.get_wavelength" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_wavelength</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#microfading.microfading.MFT.get_wavelength" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return the wavelength range of the microfading measurements.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.__init__" class="doc doc-heading">
            <code class=" language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">BWS</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Instantiate a Microfading (MFT) class object in order to manipulate and visualize microfading analysis data.</p>
<h5 id="microfading.microfading.MFT.__init__--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.__init__--parameters" title="Permanent link">&para;</a></h5>
<p>files : list
    A list of string, where each string corresponds to the absolute path of text or csv file that contains the data and metadata of a single microfading measurement. The content of the file requires a specific structure, for which an example can be found in "datasets" folder of the microfading package folder (Use the get_datasets function to retrieve the precise location of such example files). If the file structure is not respected, the script will not be able to properly read the file and access its content.</p>


<details class="bws-" open>
  <summary>bool, optional</summary>
  <p>When False, it ignores the measurements performed on BWS samples if included.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">files</span><span class="p">:</span><span class="nb">list</span><span class="p">,</span> <span class="n">BWS</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Instantiate a Microfading (MFT) class object in order to manipulate and visualize microfading analysis data.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    files : list</span>
<span class="sd">        A list of string, where each string corresponds to the absolute path of text or csv file that contains the data and metadata of a single microfading measurement. The content of the file requires a specific structure, for which an example can be found in &quot;datasets&quot; folder of the microfading package folder (Use the get_datasets function to retrieve the precise location of such example files). If the file structure is not respected, the script will not be able to properly read the file and access its content.</span>

<span class="sd">    BWS : bool, optional</span>
<span class="sd">        When False, it ignores the measurements performed on BWS samples if included. </span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">files</span> <span class="o">=</span> <span class="n">files</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">BWS</span> <span class="o">=</span> <span class="n">BWS</span>        

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">BWS</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span> <span class="k">if</span> <span class="s1">&#39;BW&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.compute_JND" class="doc doc-heading">
            <code class=" language-python"><span class="n">compute_JND</span><span class="p">(</span><span class="n">dose_unit</span><span class="o">=</span><span class="s1">&#39;Hv&#39;</span><span class="p">,</span> <span class="n">JND_dE</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">light_intensity</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">daily_exposure</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">yearly_exposure</span><span class="o">=</span><span class="mi">365</span><span class="p">,</span> <span class="n">fitting</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.compute_JND" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute the just noticeable difference (JND) corresponding to each input data file.</p>
<h5 id="microfading.microfading.MFT.compute_JND--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.compute_JND--parameters" title="Permanent link">&para;</a></h5>
<p>dose_unit : Optional[str], optional
    Unit of the light dose energy, by default 'Hv'
    Any of the following units can be entered: 'He', 'Hv', 't'. Where 'He' corresponds to radiant energy (MJ/m2), 'Hv' to exposure dose (Mlxh), and 't' to times (sec)</p>


<details class="jnd_de-" open>
  <summary>float, optional</summary>
  <p>The dE00 value corresponding to one JND, by default 1.5</p>
</details>

<details class="light_intensity-" open>
  <summary>int, optional</summary>
  <p>The illuminance or the irradiance value of the intended light source, by default 50</p>
</details>

<details class="daily_exposure-" open>
  <summary>Optional[int], optional</summary>
  <p>Amount of exposure hours per day, by default 10</p>
</details>

<details class="yearly_exposure-" open>
  <summary>Optional[int], optional</summary>
  <p>Amount of exposure days per year, by default 365</p>
</details>

<details class="fitting-" open>
  <summary>bool, optional</summary>
  <p>Whether to fit the microfading data necessary to compute the JND value, by default True</p>
</details>        <h5 id="microfading.microfading.MFT.compute_JND--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.compute_JND--returns" title="Permanent link">&para;</a></h5>
<p>A list of numerical values as string (uncertainty string with a nominal and standard deviation value)
    It returns a list of numerical values corresponding to the amount of years necessary to reach one JND.</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_JND</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dose_unit</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Hv&#39;</span><span class="p">,</span> <span class="n">JND_dE</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">light_intensity</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">daily_exposure</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">yearly_exposure</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">365</span><span class="p">,</span> <span class="n">fitting</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the just noticeable difference (JND) corresponding to each input data file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dose_unit : Optional[str], optional</span>
<span class="sd">        Unit of the light dose energy, by default &#39;Hv&#39;</span>
<span class="sd">        Any of the following units can be entered: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec)</span>

<span class="sd">    JND_dE : float, optional</span>
<span class="sd">        The dE00 value corresponding to one JND, by default 1.5</span>

<span class="sd">    light_intensity : int, optional</span>
<span class="sd">        The illuminance or the irradiance value of the intended light source, by default 50</span>

<span class="sd">    daily_exposure : Optional[int], optional</span>
<span class="sd">        Amount of exposure hours per day, by default 10</span>

<span class="sd">    yearly_exposure : Optional[int], optional</span>
<span class="sd">        Amount of exposure days per year, by default 365</span>

<span class="sd">    fitting : bool, optional</span>
<span class="sd">        Whether to fit the microfading data necessary to compute the JND value, by default True</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A list of numerical values as string (uncertainty string with a nominal and standard deviation value)</span>
<span class="sd">        It returns a list of numerical values corresponding to the amount of years necessary to reach one JND. </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">H_step</span> <span class="o">=</span> <span class="mf">0.01</span>
    <span class="n">dE_fitted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_fitting</span><span class="p">(</span><span class="n">dose_unit</span><span class="o">=</span><span class="s1">&#39;Hv&#39;</span><span class="p">,</span> <span class="n">x_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">5.1</span><span class="p">,</span><span class="n">H_step</span><span class="p">),</span> <span class="n">return_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">dE_rate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">dE_fitted</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">H_step</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">dE_rate_mean</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">:])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dE_rate</span><span class="p">]</span>
    <span class="n">dE_rate_std</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">:])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dE_rate</span><span class="p">]</span>

    <span class="n">rates</span> <span class="o">=</span> <span class="p">[</span><span class="n">ufloat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dE_rate_mean</span><span class="p">,</span> <span class="n">dE_rate_std</span><span class="p">)]</span>

    <span class="n">times_years</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">rate</span> <span class="ow">in</span> <span class="n">rates</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">dose_unit</span> <span class="o">==</span> <span class="s1">&#39;Hv&#39;</span><span class="p">:</span>

            <span class="n">JND_dose</span> <span class="o">=</span> <span class="p">(</span><span class="n">JND_dE</span> <span class="o">/</span> <span class="n">rate</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e6</span>                     <span class="c1"># in lxh</span>
            <span class="n">time_hours</span> <span class="o">=</span> <span class="n">JND_dose</span> <span class="o">/</span> <span class="n">light_intensity</span>
            <span class="n">time_years</span> <span class="o">=</span> <span class="n">time_hours</span> <span class="o">/</span> <span class="p">(</span><span class="n">daily_exposure</span> <span class="o">*</span> <span class="n">yearly_exposure</span><span class="p">)</span>            

        <span class="k">if</span> <span class="n">dose_unit</span> <span class="o">==</span> <span class="s1">&#39;He&#39;</span><span class="p">:</span>
            <span class="n">JND_dose</span> <span class="o">=</span> <span class="p">(</span><span class="n">JND_dE</span> <span class="o">/</span> <span class="n">rate</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e6</span>                     <span class="c1"># in J/m</span>
            <span class="n">time_sec</span> <span class="o">=</span> <span class="n">JND_dose</span> <span class="o">/</span> <span class="n">light_intensity</span>
            <span class="n">time_hours</span> <span class="o">=</span> <span class="n">time_sec</span> <span class="o">/</span> <span class="mi">3600</span>
            <span class="n">time_years</span> <span class="o">=</span> <span class="n">time_hours</span> <span class="o">/</span> <span class="p">(</span><span class="n">daily_exposure</span> <span class="o">*</span> <span class="n">yearly_exposure</span><span class="p">)</span>

        <span class="n">times_years</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time_years</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">times_years</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.compute_delta" class="doc doc-heading">
            <code class=" language-python"><span class="n">compute_delta</span><span class="p">(</span><span class="n">coordinates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dE00&#39;</span><span class="p">],</span> <span class="n">dose_unit</span><span class="o">=</span><span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">dose_values</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">derivation</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.compute_delta" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Retrieve the CIE delta values for a given set of colorimetric coordinates corresponding to the given microfading analyses.</p>
<h5 id="microfading.microfading.MFT.compute_delta--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.compute_delta--parameters" title="Permanent link">&para;</a></h5>
<p>coordinates : list, optional
    List of colorimetric coordinates, by default ['dE00']
    Any of the following coordinates can be added to the list: 'dE76', 'dE00', 'dR_vis' , 'L<em>', 'a</em>', 'b<em>', 'C</em>', 'h'.</p>


<details class="dose_unit-" open>
  <summary>str, optional</summary>
  <p>Define the light energy dose, by default 'He'
Any of the following units can be entered: 'He', 'Hv', 't'. Where 'He' corresponds to radiant energy (MJ/m2), 'Hv' to exposure dose (Mlxh), and 't' to times (sec)</p>
</details>

<details class="dose_values-" open>
  <summary>Union[int, float, list, tuple], optional</summary>
  <p>Dose values for which the colourimetric values will be returned, by default 'all'
When 'all', it returns the colourimetric values for all the dose values available in the given input data files.
A single dose value (an integer or a float number) can be entered.
A list of dose values, as integer or float, can also be entered.
A tuple of three values (min, max, step) will be used in a numpy.arange() function to return an array of dose values. </p>
</details>

<details class="derivation-" open>
  <summary>bool, optional</summary>
  <p>Whether to return the first derivative values of the desired coordinates, by default False</p>
</details>        <h5 id="microfading.microfading.MFT.compute_delta--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.compute_delta--returns" title="Permanent link">&para;</a></h5>
<p>A list of pandas dataframes
    It returns a a list of pandas dataframes where each column corresponds to a light energy dose or a desired coordinate.</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_delta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dE00&#39;</span><span class="p">],</span> <span class="n">dose_unit</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">dose_values</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">derivation</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve the CIE delta values for a given set of colorimetric coordinates corresponding to the given microfading analyses.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    coordinates : list, optional</span>
<span class="sd">        List of colorimetric coordinates, by default [&#39;dE00&#39;]</span>
<span class="sd">        Any of the following coordinates can be added to the list: &#39;dE76&#39;, &#39;dE00&#39;, &#39;dR_vis&#39; , &#39;L*&#39;, &#39;a*&#39;, &#39;b*&#39;, &#39;C*&#39;, &#39;h&#39;.</span>

<span class="sd">    dose_unit : str, optional</span>
<span class="sd">        Define the light energy dose, by default &#39;He&#39;</span>
<span class="sd">        Any of the following units can be entered: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec)</span>

<span class="sd">    dose_values : Union[int, float, list, tuple], optional</span>
<span class="sd">        Dose values for which the colourimetric values will be returned, by default &#39;all&#39;</span>
<span class="sd">        When &#39;all&#39;, it returns the colourimetric values for all the dose values available in the given input data files.</span>
<span class="sd">        A single dose value (an integer or a float number) can be entered.</span>
<span class="sd">        A list of dose values, as integer or float, can also be entered.</span>
<span class="sd">        A tuple of three values (min, max, step) will be used in a numpy.arange() function to return an array of dose values. </span>

<span class="sd">    derivation : bool, optional</span>
<span class="sd">        Whether to return the first derivative values of the desired coordinates, by default False</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A list of pandas dataframes</span>
<span class="sd">        It returns a a list of pandas dataframes where each column corresponds to a light energy dose or a desired coordinate.</span>
<span class="sd">    &quot;&quot;&quot;</span>          

    <span class="c1"># Retrieve the data        </span>
    <span class="n">cielab_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_files</span><span class="p">(</span><span class="n">sheets</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CIELAB&#39;</span><span class="p">])</span>
    <span class="n">cielab_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cielab_data</span><span class="p">]</span>       

    <span class="c1"># Rename the LabCh coordinates to dL*, da*, db*, dC*, dh</span>
    <span class="n">coordinates</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;d</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span><span class="s1">&#39;b*&#39;</span><span class="p">,</span><span class="s1">&#39;C*&#39;</span><span class="p">,</span><span class="s1">&#39;h&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">coordinates</span><span class="p">]</span>

    <span class="c1"># Compute the delta values</span>
    <span class="n">deltas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cielab</span><span class="p">(</span><span class="n">coordinates</span><span class="o">=</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span> <span class="n">dose_values</span><span class="o">=</span><span class="n">dose_values</span><span class="p">)</span>

    <span class="c1"># Whether to compute the first derivation </span>
    <span class="k">if</span> <span class="n">derivation</span><span class="p">:</span>
        <span class="n">deltas</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">deltas</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">deltas</span>     
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.compute_fitting" class="doc doc-heading">
            <code class=" language-python"><span class="n">compute_fitting</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dose_unit</span><span class="o">=</span><span class="s1">&#39;Hv&#39;</span><span class="p">,</span> <span class="n">coordinate</span><span class="o">=</span><span class="s1">&#39;dE00&#39;</span><span class="p">,</span> <span class="n">equation</span><span class="o">=</span><span class="s1">&#39;power_3p&#39;</span><span class="p">,</span> <span class="n">initial_params</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">),</span> <span class="n">x_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">5.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">path_fig</span><span class="o">=</span><span class="s1">&#39;cwd&#39;</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.compute_fitting" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Fit the values of a given colourimetric coordinates. </p>
<h5 id="microfading.microfading.MFT.compute_fitting--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.compute_fitting--parameters" title="Permanent link">&para;</a></h5>
<p>plot : bool, optional
    Whether to show the fitted data, by default True</p>


<details class="return_data-" open>
  <summary>bool, optional</summary>
  <p>Whether to return the fitted data, by default False</p>
</details>

<details class="dose_unit-" open>
  <summary>string, optional</summary>
  <p>Unit of the light energy dose, by default 'He'
Any of the following units can be used: 'He', 'Hv', 't'. Where 'He' corresponds to radiant energy (MJ/m2), 'Hv' to exposure dose (Mlxh), and 't' to times (sec)</p>
</details>

<details class="coordinate-" open>
  <summary>string, optional</summary>
  <p>Select the desired colourimetric coordinate from the following list: ['L<em>', 'a</em>','b<em>', 'C</em>', 'h', 'dL<em>', 'da</em>','db<em>', 'dC</em>', 'dh', 'dE76', 'dE00', 'dR_vis'], by default 'dE00'</p>
</details>

<details class="equation-" open>
  <summary>str, optional</summary>
  <p>Mathematical equation used to fit the coordinate values, by default 'c0<em>(x</em><em>c1)'.
Any others mathematical can be given. The following equation is often relevant for fitting microfading data: '((x) / (c0 + (c1</em>x))) + c2'.</p>
</details>

<details class="initial_params-" open>
  <summary>Optional[List[float]], optional</summary>
  <p>Initial guesses of the 'c' parameters given in the equation (c0, c1, c2, etc.), by default [0.1, 0.0]</p>
</details>

<details class="x_range-" open>
  <summary>Optional[Tuple[int]], optional</summary>
  <p>Values along which the fitted values should be computed (start, end, step), by default (0, 1001, 1)</p>
</details>

<details class="save-" open>
  <summary>Optional[bool], optional</summary>
  <p>Whether to save the plot, by default False</p>
</details>

<details class="path_fig-" open>
  <summary>Optional[str], optional</summary>
  <p>Absolute path of the figure to be saved, by default 'default'</p>
</details>        <h5 id="microfading.microfading.MFT.compute_fitting--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.compute_fitting--returns" title="Permanent link">&para;</a></h5>
<p>Union[None, Tuple[np.ndarray, np.ndarray]]
    <em>description</em></p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_fitting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">return_data</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">dose_unit</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Hv&#39;</span><span class="p">,</span> <span class="n">coordinate</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;dE00&#39;</span><span class="p">,</span> <span class="n">equation</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;power_3p&#39;</span><span class="p">,</span> <span class="n">initial_params</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">bounds</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">),</span> <span class="n">x_range</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">5.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),</span> <span class="n">save</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">path_fig</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;cwd&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fit the values of a given colourimetric coordinates. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    plot : bool, optional</span>
<span class="sd">        Whether to show the fitted data, by default True</span>

<span class="sd">    return_data : bool, optional</span>
<span class="sd">        Whether to return the fitted data, by default False</span>

<span class="sd">    dose_unit : string, optional</span>
<span class="sd">        Unit of the light energy dose, by default &#39;He&#39;</span>
<span class="sd">        Any of the following units can be used: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec)</span>

<span class="sd">    coordinate : string, optional</span>
<span class="sd">        Select the desired colourimetric coordinate from the following list: [&#39;L*&#39;, &#39;a*&#39;,&#39;b*&#39;, &#39;C*&#39;, &#39;h&#39;, &#39;dL*&#39;, &#39;da*&#39;,&#39;db*&#39;, &#39;dC*&#39;, &#39;dh&#39;, &#39;dE76&#39;, &#39;dE00&#39;, &#39;dR_vis&#39;], by default &#39;dE00&#39;</span>

<span class="sd">    equation : str, optional</span>
<span class="sd">        Mathematical equation used to fit the coordinate values, by default &#39;c0*(x**c1)&#39;.</span>
<span class="sd">        Any others mathematical can be given. The following equation is often relevant for fitting microfading data: &#39;((x) / (c0 + (c1*x))) + c2&#39;.</span>

<span class="sd">    initial_params : Optional[List[float]], optional</span>
<span class="sd">        Initial guesses of the &#39;c&#39; parameters given in the equation (c0, c1, c2, etc.), by default [0.1, 0.0]</span>

<span class="sd">    x_range : Optional[Tuple[int]], optional</span>
<span class="sd">        Values along which the fitted values should be computed (start, end, step), by default (0, 1001, 1)</span>

<span class="sd">    save : Optional[bool], optional</span>
<span class="sd">        Whether to save the plot, by default False</span>

<span class="sd">    path_fig : Optional[str], optional</span>
<span class="sd">        Absolute path of the figure to be saved, by default &#39;default&#39;</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Union[None, Tuple[np.ndarray, np.ndarray]]</span>
<span class="sd">        _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Retrieve the range light dose values</span>
    <span class="n">doses</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;He&#39;</span><span class="p">:</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;Hv&#39;</span><span class="p">:</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="s1">&#39;t_sec&#39;</span><span class="p">}</span>  
    <span class="n">x_model</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">*</span><span class="n">x_range</span><span class="p">)</span>

    <span class="c1"># Retrieve the data        </span>
    <span class="n">all_data</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;cl&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;mean&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">cl_mean_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># the mean colorimetric data</span>
            <span class="n">doses_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>   <span class="c1"># the light energy data</span>

            <span class="n">all_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">doses_data</span><span class="p">,</span> <span class="n">cl_mean_data</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">all_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>                

    <span class="c1"># Added the delta LabCh values to the data dataframes</span>
    <span class="n">coordinates</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span> <span class="s1">&#39;a*&#39;</span><span class="p">,</span> <span class="s1">&#39;b*&#39;</span><span class="p">,</span> <span class="s1">&#39;C*&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">]</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="sa">f</span><span class="s1">&#39;d</span><span class="si">{</span><span class="n">coord</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span> <span class="o">-</span> <span class="n">d</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">coordinates</span><span class="p">})</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">all_data</span><span class="p">]</span>

    <span class="c1"># Select the wanted dose_unit and coordinate</span>
    <span class="n">selected_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[[</span><span class="n">doses</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">],</span> <span class="n">coordinate</span><span class="p">]]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
    <span class="n">selected_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">selected_data</span><span class="p">]</span>

    <span class="c1"># Define the fitting equation and bounds</span>
    <span class="n">config_functions</span> <span class="o">=</span> <span class="n">get_DB_config</span><span class="p">()[</span><span class="s1">&#39;functions&#39;</span><span class="p">]</span>
    <span class="n">existing_equations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">config_functions</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="k">if</span> <span class="n">equation</span> <span class="ow">in</span> <span class="n">existing_equations</span><span class="p">:</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">config_functions</span><span class="p">[</span><span class="n">equation</span><span class="p">][</span><span class="s1">&#39;bounds&#39;</span><span class="p">])</span>
        <span class="n">equation</span> <span class="o">=</span> <span class="n">config_functions</span><span class="p">[</span><span class="n">equation</span><span class="p">][</span><span class="s1">&#39;expression&#39;</span><span class="p">]</span>           

    <span class="c1"># Define the function to fit</span>
    <span class="k">def</span> <span class="nf">fit_function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">):</span>
        <span class="n">param_dict</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s1">&#39;c</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="n">param</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">params</span><span class="p">)}</span>
        <span class="n">param_dict</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
        <span class="k">return</span> <span class="nb">eval</span><span class="p">(</span><span class="n">equation</span><span class="p">,</span> <span class="nb">globals</span><span class="p">(),</span> <span class="n">param_dict</span><span class="p">)</span>        

    <span class="c1"># Create an empty dataframe for the fitted data</span>
    <span class="n">fitted_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">x_model</span><span class="p">))</span>

    <span class="c1"># Empty list to store the labels</span>
    <span class="n">fitted_labels</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Emtpy list to store the optimized parameters</span>
    <span class="n">fitted_parameters</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">initial_params</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
        <span class="n">initial_params</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;auto&#39;</span><span class="p">]</span>

    <span class="n">initial_params</span> <span class="o">=</span> <span class="n">initial_params</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>


    <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">selected_data</span><span class="p">,</span><span class="n">initial_params</span><span class="p">):</span>

        <span class="c1"># retrieve the x(light dose) and y(coordinate) values</span>
        <span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

        <span class="c1"># estimate the initial parameters</span>
        <span class="k">if</span> <span class="n">p</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>  

            <span class="n">y_diff</span> <span class="o">=</span> <span class="n">y_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">equation</span> <span class="o">==</span> <span class="s2">&quot;c0*x&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">y_diff</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.1</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">y_diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">y_diff</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">p</span>  <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">elif</span> <span class="n">equation</span> <span class="o">==</span> <span class="s2">&quot;c0*x+c1&quot;</span><span class="p">:</span>                    

                <span class="k">if</span> <span class="n">y_diff</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">c0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1</span>
                <span class="k">elif</span> <span class="n">y_diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">c0</span> <span class="o">=</span> <span class="mf">0.1</span>
                <span class="k">elif</span> <span class="n">y_diff</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">c0</span>  <span class="o">=</span> <span class="mi">0</span>

                <span class="n">c1</span> <span class="o">=</span> <span class="n">y_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="n">c0</span><span class="p">,</span><span class="n">c1</span><span class="p">]</span>

            <span class="k">elif</span> <span class="n">equation</span> <span class="o">==</span> <span class="s2">&quot;c0*(x**c1)&quot;</span><span class="p">:</span>                    

                <span class="k">if</span> <span class="n">y_diff</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">c0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1</span>
                <span class="k">elif</span> <span class="n">y_diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">c0</span> <span class="o">=</span> <span class="mf">0.1</span>
                <span class="k">elif</span> <span class="n">y_diff</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">c0</span>  <span class="o">=</span> <span class="mi">0</span>

                <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="n">c0</span><span class="p">,</span><span class="mf">0.1</span><span class="p">]</span>

            <span class="k">elif</span> <span class="n">equation</span> <span class="o">==</span> <span class="s2">&quot;c0*(x**c1)+c2&quot;</span><span class="p">:</span>                    

                <span class="k">if</span> <span class="n">y_diff</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">c0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1</span>
                <span class="k">elif</span> <span class="n">y_diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">c0</span> <span class="o">=</span> <span class="mf">0.1</span>
                <span class="k">elif</span> <span class="n">y_diff</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">c0</span>  <span class="o">=</span> <span class="mi">0</span>

                <span class="n">c2</span> <span class="o">=</span> <span class="n">y_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="n">c0</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="n">c2</span><span class="p">]</span>


            <span class="k">elif</span> <span class="n">equation</span> <span class="o">==</span> <span class="s2">&quot;(c0/(1+np.exp(c1*x)))&quot;</span><span class="p">:</span>                    

                <span class="k">if</span> <span class="n">y_diff</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">c0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1</span>
                <span class="k">elif</span> <span class="n">y_diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">c0</span> <span class="o">=</span> <span class="mf">0.1</span>
                <span class="k">elif</span> <span class="n">y_diff</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">c0</span>  <span class="o">=</span> <span class="mi">0</span>

                <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="n">c0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">]</span>


            <span class="k">elif</span> <span class="n">equation</span> <span class="o">==</span> <span class="s2">&quot;(c0/(1+np.exp(c1*x)))+c2&quot;</span><span class="p">:</span>                    

                <span class="k">if</span> <span class="n">y_diff</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">c0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1</span>
                <span class="k">elif</span> <span class="n">y_diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">c0</span> <span class="o">=</span> <span class="mf">0.1</span>
                <span class="k">elif</span> <span class="n">y_diff</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">c0</span>  <span class="o">=</span> <span class="mi">0</span>                    

                <span class="n">c2</span> <span class="o">=</span> <span class="n">y_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="n">c0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">c2</span><span class="p">]</span>


        <span class="c1"># perform the curve fitting, return the optimized parameters (popt) and the covariance matrix (pcov)</span>
        <span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">fit_function</span><span class="p">,</span> <span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">)</span>

        <span class="c1"># generate fitted y data</span>
        <span class="n">fitted_y</span> <span class="o">=</span> <span class="n">fit_function</span><span class="p">(</span><span class="n">x_model</span><span class="p">,</span> <span class="o">*</span><span class="n">popt</span><span class="p">)</span>

        <span class="c1"># append it to the fitted_data dataframe</span>
        <span class="n">fitted_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">fitted_data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">fitted_y</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">x_model</span><span class="p">))],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Calculate R-squared value</span>
        <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_data</span> <span class="o">-</span> <span class="n">fit_function</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="o">*</span><span class="n">popt</span><span class="p">)</span>
        <span class="n">ss_res</span><span class="p">,</span> <span class="n">ss_tot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">residuals</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">y_data</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_data</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>        
        <span class="n">r_squared</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">ss_res</span> <span class="o">/</span> <span class="n">ss_tot</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>

        <span class="c1"># Create a string representation of the equation with optimized parameters</span>
        <span class="n">optimized_equation</span> <span class="o">=</span> <span class="n">equation</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">popt</span><span class="p">):</span>
            <span class="n">optimized_equation</span> <span class="o">=</span> <span class="n">optimized_equation</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;c</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">param</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>

        <span class="n">fitted_labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">optimized_equation</span><span class="si">}</span><span class="s1">, $R^2$ = </span><span class="si">{</span><span class="n">r_squared</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fitted_parameters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">popt</span><span class="p">)</span>

    <span class="n">fitted_data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">, $y$ = </span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_meas_ids</span><span class="p">,</span> <span class="n">fitted_labels</span><span class="p">)]</span>         

    <span class="c1"># Plot the data</span>
    <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>            

        <span class="n">labels_H</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;Hv&#39;</span><span class="p">:</span> <span class="s1">&#39;Exposure dose $H_v$ (Mlxh)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;He&#39;</span><span class="p">:</span> <span class="s1">&#39;Radiant Exposure $H_e$ (MJ/m)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;t&#39;</span> <span class="p">:</span> <span class="s1">&#39;Exposure duration (seconds)&#39;</span>
        <span class="p">}</span>

        <span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="s1">&#39;paper&#39;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="s1">&#39;serif&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;colorblind&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
        <span class="n">fs</span> <span class="o">=</span> <span class="mi">24</span>


        <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">selected_data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.7&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">fitted_data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">labels_H</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">labels_eq</span><span class="p">[</span><span class="n">coordinate</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>    

        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>   

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>    


        <span class="c1"># Whether to save the figure</span>
        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>

            <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;MFT_</span><span class="si">{</span><span class="n">coordinate</span><span class="si">}</span><span class="s1">-fitted.png&#39;</span>

            <span class="k">if</span> <span class="n">save</span><span class="p">:</span>      

                <span class="k">if</span> <span class="n">path_fig</span> <span class="o">==</span> <span class="s1">&#39;cwd&#39;</span><span class="p">:</span>
                    <span class="n">path_fig</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">&#39;</span> 

                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">path_fig</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">return_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fitted_parameters</span><span class="p">,</span> <span class="n">fitted_data</span><span class="p">,</span> <span class="n">pcov</span><span class="p">,</span> <span class="n">r_squared</span>   
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.compute_mean" class="doc doc-heading">
            <code class=" language-python"><span class="n">compute_mean</span><span class="p">(</span><span class="n">return_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;spot_group&#39;</span><span class="p">,</span> <span class="n">dose_unit</span><span class="o">=</span><span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">folder</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.compute_mean" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute mean and standard deviation values of several microfading measurements.</p>
<h5 id="microfading.microfading.MFT.compute_mean--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.compute_mean--parameters" title="Permanent link">&para;</a></h5>
<p>return_data : Optional[bool], optional
    Whether to return the data, by default True        </p>


<details class="criterion-" open>
  <summary>Optional[str], optional</summary>
  <p><em>description</em>, by default 'group'            </p>
</details>

<details class="save-" open>
  <summary>Optional[bool], optional</summary>
  <p>Whether to save the average data as an excel file, by default False</p>
</details>

<details class="folder-" open>
  <summary>Optional[str], optional</summary>
  <p>Folder where the excel file will be saved, by default 'default'
When 'default', the file will be saved in the same folder as the input files
When '.', the file will be saved in the current working directory
One can also enter a valid path as a string.</p>
</details>

<details class="filename-" open>
  <summary>Optional[str], optional</summary>
  <p>Filename of the excel file containing the average values, by default 'default'
When 'default', it will use the filename of the first input file
One can also enter a filename, but without a filename extension.</p>
</details>        <h5 id="microfading.microfading.MFT.compute_mean--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.compute_mean--returns" title="Permanent link">&para;</a></h5>
<p>tuple, excel file
    It returns a tuple composed of three elements (info, CIELAB data, spectral data). When 'save' is set to True, an excel is created to stored the tuple inside three distinct excel sheet (info, CIELAB, spectra).</p>
<h5 id="microfading.microfading.MFT.compute_mean--raises">Raises<a class="headerlink" href="#microfading.microfading.MFT.compute_mean--raises" title="Permanent link">&para;</a></h5>
<p>RuntimeError
    <em>description</em></p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">return_data</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">criterion</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;spot_group&#39;</span><span class="p">,</span> <span class="n">dose_unit</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">save</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">folder</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute mean and standard deviation values of several microfading measurements.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    return_data : Optional[bool], optional</span>
<span class="sd">        Whether to return the data, by default True        </span>

<span class="sd">    criterion : Optional[str], optional</span>
<span class="sd">        _description_, by default &#39;group&#39;            </span>

<span class="sd">    save : Optional[bool], optional</span>
<span class="sd">        Whether to save the average data as an excel file, by default False</span>

<span class="sd">    folder : Optional[str], optional</span>
<span class="sd">        Folder where the excel file will be saved, by default &#39;default&#39;</span>
<span class="sd">        When &#39;default&#39;, the file will be saved in the same folder as the input files</span>
<span class="sd">        When &#39;.&#39;, the file will be saved in the current working directory</span>
<span class="sd">        One can also enter a valid path as a string.</span>

<span class="sd">    filename : Optional[str], optional</span>
<span class="sd">        Filename of the excel file containing the average values, by default &#39;default&#39;</span>
<span class="sd">        When &#39;default&#39;, it will use the filename of the first input file</span>
<span class="sd">        One can also enter a filename, but without a filename extension.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tuple, excel file</span>
<span class="sd">        It returns a tuple composed of three elements (info, CIELAB data, spectral data). When &#39;save&#39; is set to True, an excel is created to stored the tuple inside three distinct excel sheet (info, CIELAB, spectra).</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    RuntimeError</span>
<span class="sd">        _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>        
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Not enough files. At least two measurement files are required to compute the average values.&#39;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">mean_std_with_nan</span><span class="p">(</span><span class="n">arrays</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Compute the mean of several numpy arrays of different shapes.&#39;&#39;&#39;</span>

        <span class="c1"># Find the maximum shape</span>
        <span class="n">max_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrays</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Create arrays with NaN values</span>
        <span class="n">nan_arrays</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">max_shape</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">arrays</span><span class="p">))]</span>

        <span class="c1"># Fill NaN arrays with actual values</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">arr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">arrays</span><span class="p">):</span>
            <span class="n">nan_arrays</span><span class="p">[</span><span class="n">i</span><span class="p">][:</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">:</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">arr</span>

        <span class="c1"># Calculate mean</span>
        <span class="n">mean_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">nan_arrays</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Calculate std</span>
        <span class="n">std_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanstd</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">nan_arrays</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">mean_array</span><span class="p">,</span> <span class="n">std_array</span>


    <span class="k">def</span> <span class="nf">to_float</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x</span>


    <span class="c1">###### SPECTRAL DATA #######</span>

    <span class="n">data_sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;sp&#39;</span><span class="p">)</span>

    <span class="c1"># Get the energy dose step</span>
    <span class="c1">#H_values = [x.columns.astype(float) for x in data_sp]       </span>
    <span class="n">H_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_doses</span><span class="p">(</span><span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">)]</span>
    <span class="n">step_H</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">H_values</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">highest_He</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">H_values</span><span class="p">])</span>

    <span class="c1"># Average the spectral data</span>
    <span class="n">sp</span> <span class="o">=</span> <span class="n">mean_std_with_nan</span><span class="p">(</span><span class="n">data_sp</span><span class="p">)</span>
    <span class="n">sp_mean</span> <span class="o">=</span> <span class="n">sp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sp_std</span> <span class="o">=</span> <span class="n">sp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> 


    <span class="c1"># Wanted energy dose values          </span>
    <span class="n">wanted_H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">highest_He</span><span class="o">+</span><span class="n">step_H</span><span class="p">,</span><span class="n">step_H</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>  

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">wanted_H</span><span class="p">)</span> <span class="o">!=</span> <span class="n">sp_mean</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>            
        <span class="n">wanted_H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">highest_He</span><span class="p">,</span><span class="n">sp_mean</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># Retrieve the wavelength range</span>
    <span class="n">wl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_wavelength</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>


    <span class="c1"># Create a multi-index pandas DataFrame</span>
    <span class="n">doses_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;He&#39;</span><span class="p">:</span> <span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;Hv&#39;</span><span class="p">:</span> <span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="s1">&#39;t_sec&#39;</span><span class="p">}</span>
    <span class="n">H_tuples</span> <span class="o">=</span> <span class="p">[(</span><span class="n">dose</span><span class="p">,</span> <span class="n">measurement</span><span class="p">)</span> <span class="k">for</span> <span class="n">dose</span> <span class="ow">in</span> <span class="n">wanted_H</span> <span class="k">for</span> <span class="n">measurement</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">]]</span>
    <span class="n">multiindex_cols</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">H_tuples</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="n">doses_dict</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">],</span> <span class="s1">&#39;Measurement&#39;</span><span class="p">])</span>

    <span class="n">data_df_sp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">wl</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">wanted_H</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">))</span>       
    <span class="n">data_df_sp</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">sp_mean</span>
    <span class="n">data_df_sp</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">sp_std</span>
    <span class="n">df_sp_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_df_sp</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">multiindex_cols</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">wl</span><span class="p">)</span>
    <span class="n">df_sp_final</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;wavelength_nm&#39;</span>



    <span class="c1">###### COLORIMETRIC DATA #######</span>

    <span class="n">data_cl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;cl&#39;</span><span class="p">)</span>
    <span class="n">columns_cl</span> <span class="o">=</span> <span class="n">data_cl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Average the colorimetric data    </span>
    <span class="n">cl</span> <span class="o">=</span> <span class="n">mean_std_with_nan</span><span class="p">(</span><span class="n">data_cl</span><span class="p">)</span>
    <span class="n">cl_mean</span> <span class="o">=</span> <span class="n">cl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">cl_std</span> <span class="o">=</span> <span class="n">cl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Create a multi-index pandas DataFrame</span>
    <span class="n">cl_tuples</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">measurement</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_cl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">measurement</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">]]</span>
    <span class="n">multiindex_cols</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">cl_tuples</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;coordinates&#39;</span><span class="p">,</span> <span class="s1">&#39;Measurement&#39;</span><span class="p">])</span>

    <span class="n">data_df_cl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">cl_mean</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cl_mean</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">))</span>       
    <span class="n">data_df_cl</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">cl_mean</span>
    <span class="n">data_df_cl</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">cl_std</span>
    <span class="n">df_cl_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_df_cl</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">multiindex_cols</span><span class="p">,</span> <span class="p">)</span>

    <span class="n">df_cl_final</span><span class="o">.</span><span class="n">drop</span><span class="p">([(</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span><span class="s1">&#39;std&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span><span class="s1">&#39;std&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;t_sec&#39;</span><span class="p">,</span><span class="s1">&#39;std&#39;</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">mapper</span> <span class="o">=</span> <span class="p">{(</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">):</span> <span class="p">(</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">):</span> <span class="p">(</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;t_sec&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">):</span> <span class="p">(</span><span class="s1">&#39;t_sec&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)}</span>
    <span class="n">df_cl_final</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([</span><span class="n">mapper</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df_cl_final</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>


    <span class="n">cl_cols</span> <span class="o">=</span> <span class="n">df_cl_final</span><span class="o">.</span><span class="n">columns</span>
    <span class="n">cl_cols_level1</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cl_cols</span><span class="p">]</span>
    <span class="n">cl_cols_level2</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cl_cols</span><span class="p">]</span>
    <span class="n">df_cl_final</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">df_cl_final</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">df_cl_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">cl_cols_level2</span><span class="p">])),</span> <span class="n">df_cl_final</span><span class="p">])</span>
    <span class="n">df_cl_final</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">cl_cols_level1</span>
    <span class="n">df_cl_final</span> <span class="o">=</span> <span class="n">df_cl_final</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">df_cl_final</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>


    <span class="c1">###### INFO #######</span>

    <span class="n">data_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

    <span class="c1"># Select the first column as a template</span>
    <span class="n">df_info</span> <span class="o">=</span> <span class="n">data_info</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>


    <span class="c1"># Rename title file</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;[SINGLE MICROFADING ANALYSIS]&#39;</span><span class="p">:</span> <span class="s1">&#39;[MEAN MICROFADING ANALYSES]&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Date time</span>
    <span class="n">most_recent_dt</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">])</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">most_recent_dt</span>

    <span class="c1"># Project data info</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;project_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;project_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;project_leader&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;project_leader&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;co-researchers&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;co-researchers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;start_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;start_date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;end_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;end_date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;keywords&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;keywords&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>

    <span class="c1"># Object data info</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;institution&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;institution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;institution&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_category&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_technique&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_technique&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_title&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_creator&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_creator&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_material&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_material&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;colorants&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;colorants&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;colorants_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;colorants_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;binding&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;binding&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;ratio&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;thickness_um&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;thickness_um&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>

    <span class="c1"># Device data info</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;measurement_mode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;measurement_mode&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;zoom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;zoom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;iris&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">()</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;iris&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)]))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;distance_ill_mm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">()</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;distance_ill_mm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)]))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;distance_coll_mm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">()</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;distance_coll_mm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)]))</span>


    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_fading&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_fading&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_fading&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_ill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_ill&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_ill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_coll&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_coll&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_coll&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;lamp_fading&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;lamp_fading&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;lamp_fading&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;lamp_ill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;lamp_ill&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;lamp_ill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;filter_fading&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;filter_fading&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;filter_fading&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;filter_ill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;filter_ill&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;filter_ill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;white_standard&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;white_standard&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;white_standard&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>


    <span class="c1"># Analysis data info</span>

    <span class="n">criterion_value</span> <span class="o">=</span> <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">criterion</span><span class="p">]</span>
    <span class="n">object_id</span> <span class="o">=</span> <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_id&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">criterion</span> <span class="o">==</span> <span class="s1">&#39;group&#39;</span><span class="p">:</span>            
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;meas_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;MF.</span><span class="si">{</span><span class="n">object_id</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="n">criterion_value</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="k">elif</span> <span class="n">criterion</span> <span class="o">==</span> <span class="s1">&#39;object&#39;</span> <span class="ow">or</span> <span class="n">criterion</span> <span class="o">==</span> <span class="s1">&#39;project&#39;</span><span class="p">:</span>
         <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;meas_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;MF.</span><span class="si">{</span><span class="n">criterion_value</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Choose one of the following options for the criterion parameter: [&quot;group&quot;, &quot;object&quot;, &quot;project&quot;]&#39;</span><span class="p">)</span>

    <span class="n">meas_nbs</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_meas_ids</span><span class="p">])</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;spot_group&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="s2">&quot;-&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;spot_group&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">meas_nbs</span><span class="si">}</span><span class="s1">&#39;</span>    
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;spot_description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;spot_description&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;background&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;background&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>  

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;specular_component&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;specular_component&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;specular_component&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span> 


    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;integration_time_sample_ms&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;integration_time_sample_ms&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;integration_time_whitestandard_ms&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;integration_time_whitestandard_ms&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;average&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;average&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">))])</span> 
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;duration_min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;duration_min&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;interval_sec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;interval_sec&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))])</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;measurements_N&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;measurements_N&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">))])</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;illuminant&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;illuminant&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;observer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;observer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>


    <span class="c1"># Beam data info</span>

    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;beam_photo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;beam_photo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;resolution_micron/pixel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">()</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;resolution_micron/pixel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)]))</span>

    <span class="n">fwhm</span> <span class="o">=</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;FWHM_micron&#39;</span><span class="p">]</span>
    <span class="n">fwhm_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="n">to_float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fwhm</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))])</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;FWHM_micron&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fwhm_avg</span>

    <span class="n">power_infos</span> <span class="o">=</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;radiantFlux_mW&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">power_values</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">power_info</span> <span class="ow">in</span> <span class="n">power_infos</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;_&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">power_info</span><span class="p">):</span>
            <span class="n">power_value</span> <span class="o">=</span> <span class="n">ufloat_fromstr</span><span class="p">(</span><span class="n">power_info</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">power_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">power_value</span><span class="p">)</span>                            

        <span class="k">else</span><span class="p">:</span> 
            <span class="n">power_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">power_info</span><span class="p">)</span>               

    <span class="n">power_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">power_values</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">power_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">power_values</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;radiantFlux_mW&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ufloat</span><span class="p">(</span><span class="n">power_mean</span><span class="p">,</span><span class="n">power_std</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>    


    <span class="n">irr_values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">ufloat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;irradiance_Ee_W/m^2&#39;</span><span class="p">]</span> <span class="p">]</span> 
    <span class="n">irr_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">unumpy</span><span class="o">.</span><span class="n">nominal_values</span><span class="p">(</span><span class="n">ufloat_fromstr</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">irr_values</span><span class="p">]))</span>
    <span class="n">irr_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">([</span><span class="n">unumpy</span><span class="o">.</span><span class="n">nominal_values</span><span class="p">(</span><span class="n">ufloat_fromstr</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">irr_values</span><span class="p">]))</span>
    <span class="n">irr_avg</span> <span class="o">=</span> <span class="n">ufloat</span><span class="p">(</span><span class="n">irr_mean</span><span class="p">,</span> <span class="n">irr_std</span><span class="p">)</span>    
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;irradiance_Ee_W/m^2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">irr_avg</span>

    <span class="n">lm</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;luminuousFlux_lm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
    <span class="n">lm_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">lm</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;luminuousFlux_lm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lm_avg</span>

    <span class="n">ill</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;illuminance_Ev_Mlx&#39;</span><span class="p">]]</span>
    <span class="n">ill_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ill</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;illuminance_Ev_Mlx&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ill_avg</span>


    <span class="c1"># Results data info</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;radiantExposure_He_MJ/m^2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_cl_final</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;exposureDose_Hv_Mlxh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">df_cl_final</span><span class="p">[</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="mi">4</span><span class="p">)</span>


    <span class="c1"># Rename the column</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;value&#39;</span>


    <span class="c1">###### SAVE THE MEAN DATAFRAMES #######</span>

    <span class="k">if</span> <span class="n">save</span><span class="p">:</span>  

        <span class="c1"># set the folder</span>
        <span class="k">if</span> <span class="n">folder</span> <span class="o">==</span> <span class="s2">&quot;.&quot;</span><span class="p">:</span>
            <span class="n">folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>  

        <span class="k">elif</span> <span class="n">folder</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
            <span class="n">folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">parent</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Path</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                <span class="n">folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>         

        <span class="c1"># set the filename</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s1">_MEAN</span><span class="si">{</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">suffix</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">.xlsx&#39;</span>


        <span class="c1"># create a excel writer object</span>
        <span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="n">folder</span> <span class="o">/</span> <span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">writer</span><span class="p">:</span>

            <span class="n">df_info</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">df_cl_final</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;CIELAB&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">df_sp_final</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;spectra&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">folder</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">filename</span><span class="si">}</span><span class="s1"> successfully created.&#39;</span><span class="p">)</span>


    <span class="c1">###### RETURN THE MEAN DATAFRAMES #######</span>

    <span class="k">if</span> <span class="n">return_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">df_info</span><span class="p">,</span> <span class="n">df_cl_final</span><span class="p">,</span> <span class="n">df_sp_final</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.compute_sp_derivate" class="doc doc-heading">
            <code class=" language-python"><span class="n">compute_sp_derivate</span><span class="p">()</span></code>

<a href="#microfading.microfading.MFT.compute_sp_derivate" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute the first derivative values of reflectance spectra.</p>
<h5 id="microfading.microfading.MFT.compute_sp_derivate--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.compute_sp_derivate--returns" title="Permanent link">&para;</a></h5>
<p>a list of pandas dataframes
    It returns the first derivative values of the reflectance spectra inside dataframes where each column corresponds to a single spectra.</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_sp_derivate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the first derivative values of reflectance spectra.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    a list of pandas dataframes</span>
<span class="sd">        It returns the first derivative values of the reflectance spectra inside dataframes where each column corresponds to a single spectra.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;sp&#39;</span><span class="p">)</span>                    

    <span class="n">sp_derivation</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sp</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">sp_derivation</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.get_Lab" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_Lab</span><span class="p">(</span><span class="n">illuminant</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">dose_unit</span><span class="o">=</span><span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">dose_values</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.get_Lab" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Retrieve the CIE L<em>a</em>b* values.</p>
<h5 id="microfading.microfading.MFT.get_Lab--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.get_Lab--parameters" title="Permanent link">&para;</a></h5>
<p>illuminant : (str, optional)<br />
    Reference <em>illuminant</em> ('D65', or 'D50'). by default 'default'.
    When 'default', it fetches the illuminant value recorded in the db_config.json file of the package. If no value has been recorded, then it sets the illuminant value to 'D65'.</p>


<details class="observer-" open>
  <summary>(str|int, optional)</summary>
  <p>Reference <em>observer</em> in degree ('10' or '2'). by default 'default'.
When 'default', it fetches the observer value recorded in the db_config.json file of the package. If no value has been recorded, then it sets the observer value to '10'.</p>
</details>

<details class="dose_unit-" open>
  <summary>Optional[str], optional</summary>
  <p>Unit of the light dose energy, by default ['He']
Any of the following units can be entered: 'He', 'Hv', 't'. Where 'He' corresponds to radiant energy (MJ/m2), 'Hv' to exposure dose (Mlxh), and 't' to times (sec)</p>
</details>

<details class="dose_values-" open>
  <summary>Union[int, float, list, tuple], optional</summary>
  <p>Dose values for which the colourimetric values will be returned, by default 'all'
When 'all', it returns the colourimetric values for all the dose values available in the given input data files.
A single dose value (an integer or a float number) can be entered.
A list of dose values, as integer or float, can also be entered.
A tuple of three values (min, max, step) will be used in a numpy.arange() function to return an array of dose values. </p>
</details>        <h5 id="microfading.microfading.MFT.get_Lab--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.get_Lab--returns" title="Permanent link">&para;</a></h5>
<p>pandas dataframe
    It returns the L<em>a</em>b* values inside a dataframe where each column corresponds to a single file.</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_Lab</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">illuminant</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">dose_unit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">dose_values</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve the CIE L*a*b* values.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    illuminant : (str, optional)  </span>
<span class="sd">        Reference *illuminant* (&#39;D65&#39;, or &#39;D50&#39;). by default &#39;default&#39;.</span>
<span class="sd">        When &#39;default&#39;, it fetches the illuminant value recorded in the db_config.json file of the package. If no value has been recorded, then it sets the illuminant value to &#39;D65&#39;.</span>

<span class="sd">    observer : (str|int, optional)</span>
<span class="sd">        Reference *observer* in degree (&#39;10&#39; or &#39;2&#39;). by default &#39;default&#39;.</span>
<span class="sd">        When &#39;default&#39;, it fetches the observer value recorded in the db_config.json file of the package. If no value has been recorded, then it sets the observer value to &#39;10&#39;.</span>

<span class="sd">    dose_unit : Optional[str], optional</span>
<span class="sd">        Unit of the light dose energy, by default [&#39;He&#39;]</span>
<span class="sd">        Any of the following units can be entered: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec)</span>

<span class="sd">    dose_values : Union[int, float, list, tuple], optional</span>
<span class="sd">        Dose values for which the colourimetric values will be returned, by default &#39;all&#39;</span>
<span class="sd">        When &#39;all&#39;, it returns the colourimetric values for all the dose values available in the given input data files.</span>
<span class="sd">        A single dose value (an integer or a float number) can be entered.</span>
<span class="sd">        A list of dose values, as integer or float, can also be entered.</span>
<span class="sd">        A tuple of three values (min, max, step) will be used in a numpy.arange() function to return an array of dose values. </span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pandas dataframe</span>
<span class="sd">        It returns the L*a*b* values inside a dataframe where each column corresponds to a single file.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">DB</span> <span class="o">=</span> <span class="n">databases</span><span class="o">.</span><span class="n">DB</span><span class="p">()</span>


    <span class="c1"># Set the observer value</span>
    <span class="k">if</span> <span class="n">observer</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">observer</span> <span class="o">=</span> <span class="s1">&#39;10deg&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">observer</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;observer&#39;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">observer</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">observer</span><span class="p">)</span><span class="si">}</span><span class="s1">deg&#39;</span>


    <span class="c1"># Set the illuminant value</span>
    <span class="k">if</span> <span class="n">illuminant</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">illuminant</span> <span class="o">=</span> <span class="s1">&#39;D65&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">illuminant</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;illuminant&#39;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>


    <span class="c1"># Get colorimetric data related to the standard observer</span>
    <span class="n">observers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;10deg&#39;</span><span class="p">:</span> <span class="s1">&#39;cie_10_1964&#39;</span><span class="p">,</span>
        <span class="s1">&#39;2deg&#39;</span> <span class="p">:</span> <span class="s1">&#39;cie_2_1931&#39;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">cmfs_observers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;10deg&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1964 10 Degree Standard Observer&quot;</span><span class="p">],</span>
        <span class="s1">&#39;2deg&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1931 2 Degree Standard Observer&quot;</span><span class="p">]</span> 
        <span class="p">}</span>

    <span class="n">ccs_ill</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">CCS_ILLUMINANTS</span><span class="p">[</span><span class="n">observers</span><span class="p">[</span><span class="n">observer</span><span class="p">]][</span><span class="n">illuminant</span><span class="p">]</span>


    <span class="n">meas_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_meas_ids</span>               
    <span class="n">df_sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_spectra</span><span class="p">(</span><span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span> <span class="n">dose_values</span><span class="o">=</span><span class="n">dose_values</span><span class="p">)</span>   
    <span class="n">df_sp_nominal</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span><span class="p">[:,</span> <span class="s1">&#39;mean&#39;</span><span class="p">]]</span> <span class="k">if</span> <span class="s1">&#39;mean&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span><span class="p">[:,</span> <span class="s1">&#39;value&#39;</span><span class="p">]]</span>
        <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">df_sp</span>
    <span class="p">]</span>

    <span class="n">df_Lab</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">df</span><span class="p">,</span> <span class="n">meas_id</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df_sp_nominal</span><span class="p">,</span> <span class="n">meas_ids</span><span class="p">):</span>   

        <span class="n">Lab_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span><span class="s1">&#39;b*&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>           

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>

            <span class="n">sp</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
            <span class="n">wl</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>
            <span class="n">sd</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">SpectralDistribution</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">wl</span><span class="p">)</span>                

            <span class="n">XYZ</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">sd_to_XYZ</span><span class="p">(</span><span class="n">sd</span><span class="p">,</span><span class="n">cmfs_observers</span><span class="p">[</span><span class="n">observer</span><span class="p">],</span> <span class="n">illuminant</span><span class="o">=</span><span class="n">colour</span><span class="o">.</span><span class="n">SDS_ILLUMINANTS</span><span class="p">[</span><span class="n">illuminant</span><span class="p">])</span>        
            <span class="n">Lab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">colour</span><span class="o">.</span><span class="n">XYZ_to_Lab</span><span class="p">(</span><span class="n">XYZ</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span><span class="n">ccs_ill</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>               
            <span class="n">Lab_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">Lab_values</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">Lab</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span><span class="s1">&#39;b*&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">Lab_values</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Lab_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">Lab_values</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="n">meas_id</span><span class="p">],</span> <span class="n">Lab_values</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>  
        <span class="n">df_Lab</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Lab_values</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_Lab</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>           
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.get_XYZ" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_XYZ</span><span class="p">(</span><span class="n">illuminant</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">dose_unit</span><span class="o">=</span><span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">dose_values</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.get_XYZ" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute the XYZ values. </p>
<h5 id="microfading.microfading.MFT.get_XYZ--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.get_XYZ--parameters" title="Permanent link">&para;</a></h5>
<p>illuminant : (str, optional)<br />
    Reference <em>illuminant</em> ('D65', or 'D50'). by default 'default'.
    When 'default', it fetches the illuminant value recorded in the db_config.json file of the package. If no value has been recorded, then it sets the illuminant value to 'D65'.</p>


<details class="observer-" open>
  <summary>(str|int, optional)</summary>
  <p>Reference <em>observer</em> in degree ('10' or '2'). by default 'default'.
When 'default', it fetches the observer value recorded in the db_config.json file of the package. If no value has been recorded, then it sets the observer value to '10'.</p>
</details>

<details class="dose_unit-" open>
  <summary>Optional[str], optional</summary>
  <p>Unit of the light dose energy, by default ['He']
Any of the following units can be entered: 'He', 'Hv', 't'. Where 'He' corresponds to radiant energy (MJ/m2), 'Hv' to exposure dose (Mlxh), and 't' to times (sec)</p>
</details>

<details class="dose_values-" open>
  <summary>Union[int, float, list, tuple], optional</summary>
  <p>Dose values for which the colourimetric values will be returned, by default 'all'
When 'all', it returns the colourimetric values for all the dose values available in the given input data files.
A single dose value (an integer or a float number) can be entered.
A list of dose values, as integer or float, can also be entered.
A tuple of three values (min, max, step) will be used in a numpy.arange() function to return an array of dose values. </p>
</details>        <h5 id="microfading.microfading.MFT.get_XYZ--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.get_XYZ--returns" title="Permanent link">&para;</a></h5>
<p>pandas dataframe
    It returns the XYZ values inside a dataframe where each column corresponds to a single file.</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span>
<span class="normal">2082</span>
<span class="normal">2083</span>
<span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span>
<span class="normal">2088</span>
<span class="normal">2089</span>
<span class="normal">2090</span>
<span class="normal">2091</span>
<span class="normal">2092</span>
<span class="normal">2093</span>
<span class="normal">2094</span>
<span class="normal">2095</span>
<span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_XYZ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">illuminant</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">dose_unit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">dose_values</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the XYZ values. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    illuminant : (str, optional)  </span>
<span class="sd">        Reference *illuminant* (&#39;D65&#39;, or &#39;D50&#39;). by default &#39;default&#39;.</span>
<span class="sd">        When &#39;default&#39;, it fetches the illuminant value recorded in the db_config.json file of the package. If no value has been recorded, then it sets the illuminant value to &#39;D65&#39;.</span>

<span class="sd">    observer : (str|int, optional)</span>
<span class="sd">        Reference *observer* in degree (&#39;10&#39; or &#39;2&#39;). by default &#39;default&#39;.</span>
<span class="sd">        When &#39;default&#39;, it fetches the observer value recorded in the db_config.json file of the package. If no value has been recorded, then it sets the observer value to &#39;10&#39;.</span>

<span class="sd">    dose_unit : Optional[str], optional</span>
<span class="sd">        Unit of the light dose energy, by default [&#39;He&#39;]</span>
<span class="sd">        Any of the following units can be entered: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec)</span>

<span class="sd">    dose_values : Union[int, float, list, tuple], optional</span>
<span class="sd">        Dose values for which the colourimetric values will be returned, by default &#39;all&#39;</span>
<span class="sd">        When &#39;all&#39;, it returns the colourimetric values for all the dose values available in the given input data files.</span>
<span class="sd">        A single dose value (an integer or a float number) can be entered.</span>
<span class="sd">        A list of dose values, as integer or float, can also be entered.</span>
<span class="sd">        A tuple of three values (min, max, step) will be used in a numpy.arange() function to return an array of dose values. </span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pandas dataframe</span>
<span class="sd">        It returns the XYZ values inside a dataframe where each column corresponds to a single file.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">DB</span> <span class="o">=</span> <span class="n">databases</span><span class="o">.</span><span class="n">DB</span><span class="p">()</span>

    <span class="c1"># Set the observer value</span>
    <span class="k">if</span> <span class="n">observer</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">observer</span> <span class="o">=</span> <span class="s1">&#39;10deg&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">observer</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;observer&#39;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">observer</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">observer</span><span class="p">)</span><span class="si">}</span><span class="s1">deg&#39;</span>


    <span class="c1"># Set the illuminant value</span>
    <span class="k">if</span> <span class="n">illuminant</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">illuminant</span> <span class="o">=</span> <span class="s1">&#39;D65&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">illuminant</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;illuminant&#39;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>               


    <span class="c1"># Get colorimetric data related to the standard observer</span>
    <span class="n">cmfs_observers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;10deg&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1964 10 Degree Standard Observer&quot;</span><span class="p">],</span>
        <span class="s1">&#39;2deg&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1931 2 Degree Standard Observer&quot;</span><span class="p">]</span> 
        <span class="p">}</span> 

    <span class="n">meas_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_meas_ids</span>                
    <span class="n">df_sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_spectra</span><span class="p">(</span><span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span> <span class="n">dose_values</span><span class="o">=</span><span class="n">dose_values</span><span class="p">)</span>   
    <span class="n">df_sp_nominal</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span><span class="p">[:,</span> <span class="s1">&#39;mean&#39;</span><span class="p">]]</span> <span class="k">if</span> <span class="s1">&#39;mean&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span><span class="p">[:,</span> <span class="s1">&#39;value&#39;</span><span class="p">]]</span>
        <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">df_sp</span>
    <span class="p">]</span> 

    <span class="n">df_XYZ</span> <span class="o">=</span> <span class="p">[]</span>


    <span class="k">for</span> <span class="n">df</span><span class="p">,</span> <span class="n">meas_id</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df_sp_nominal</span><span class="p">,</span> <span class="n">meas_ids</span><span class="p">):</span>

        <span class="n">XYZ_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>

            <span class="n">sp</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
            <span class="n">wl</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>
            <span class="n">sd</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">SpectralDistribution</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">wl</span><span class="p">)</span>                

            <span class="n">XYZ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">colour</span><span class="o">.</span><span class="n">sd_to_XYZ</span><span class="p">(</span><span class="n">sd</span><span class="p">,</span><span class="n">cmfs_observers</span><span class="p">[</span><span class="n">observer</span><span class="p">],</span> <span class="n">illuminant</span><span class="o">=</span><span class="n">colour</span><span class="o">.</span><span class="n">SDS_ILLUMINANTS</span><span class="p">[</span><span class="n">illuminant</span><span class="p">]),</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">XYZ_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">XYZ_values</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">XYZ</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">XYZ_values</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">XYZ_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">XYZ_values</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="n">meas_id</span><span class="p">],</span> <span class="n">XYZ_values</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>
        <span class="n">df_XYZ</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XYZ_values</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_XYZ</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.get_cielab" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_cielab</span><span class="p">(</span><span class="n">coordinates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dE00&#39;</span><span class="p">],</span> <span class="n">dose_unit</span><span class="o">=</span><span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">dose_values</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.get_cielab" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Retrieve the colourimetric values for one or multiple light dose values.</p>
<h5 id="microfading.microfading.MFT.get_cielab--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.get_cielab--parameters" title="Permanent link">&para;</a></h5>
<p>coordinates : Optional[list], optional
    Select the desired colorimetric coordinates from the following list: ['L<em>', 'a</em>','b<em>', 'C</em>', 'h', 'dL<em>', 'da</em>','db<em>', 'dC</em>', 'dh', 'dE76', 'dE00', 'dR_vis'], by default ['dE00']
    When 'all', it returns all the colorimetric coordinates.</p>


<details class="dose_unit-" open>
  <summary>Optional[str], optional</summary>
  <p>Unit of the light dose energy, by default ['He']
Any of the following units can be added to the list: 'He', 'Hv', 't'. Where 'He' corresponds to radiant energy (MJ/m2), 'Hv' to exposure dose (Mlxh), and 't' to times (sec)</p>
</details>

<details class="dose_values-" open>
  <summary>Union[int, float, list, tuple], optional</summary>
  <p>Dose values for which the colourimetric values will be returned, by default 'all'
When 'all', it returns the colourimetric values for all the dose values available in the given input data files.
A single dose value (an integer or a float number) can be entered.
A list of dose values, as integer or float, can also be entered.
A tuple of three values (min, max, step) will be used in a numpy.arange() function to return an array of dose values. </p>
</details>

<details class="index-" open>
  <summary>Optional[bool], optional</summary>
  <p>Whether to set the index of the returned dataframes, by default False</p>
</details>        <h5 id="microfading.microfading.MFT.get_cielab--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.get_cielab--returns" title="Permanent link">&para;</a></h5>
<p>A list of pandas dataframes
    It returns the values of the wanted colour coordinates inside dataframes where each coordinate corresponds to a column.</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_cielab</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dE00&#39;</span><span class="p">],</span> <span class="n">dose_unit</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">dose_values</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve the colourimetric values for one or multiple light dose values.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    coordinates : Optional[list], optional</span>
<span class="sd">        Select the desired colorimetric coordinates from the following list: [&#39;L*&#39;, &#39;a*&#39;,&#39;b*&#39;, &#39;C*&#39;, &#39;h&#39;, &#39;dL*&#39;, &#39;da*&#39;,&#39;db*&#39;, &#39;dC*&#39;, &#39;dh&#39;, &#39;dE76&#39;, &#39;dE00&#39;, &#39;dR_vis&#39;], by default [&#39;dE00&#39;]</span>
<span class="sd">        When &#39;all&#39;, it returns all the colorimetric coordinates.</span>

<span class="sd">    dose_unit : Optional[str], optional</span>
<span class="sd">        Unit of the light dose energy, by default [&#39;He&#39;]</span>
<span class="sd">        Any of the following units can be added to the list: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec)</span>

<span class="sd">    dose_values : Union[int, float, list, tuple], optional</span>
<span class="sd">        Dose values for which the colourimetric values will be returned, by default &#39;all&#39;</span>
<span class="sd">        When &#39;all&#39;, it returns the colourimetric values for all the dose values available in the given input data files.</span>
<span class="sd">        A single dose value (an integer or a float number) can be entered.</span>
<span class="sd">        A list of dose values, as integer or float, can also be entered.</span>
<span class="sd">        A tuple of three values (min, max, step) will be used in a numpy.arange() function to return an array of dose values. </span>

<span class="sd">    index : Optional[bool], optional</span>
<span class="sd">        Whether to set the index of the returned dataframes, by default False</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A list of pandas dataframes</span>
<span class="sd">        It returns the values of the wanted colour coordinates inside dataframes where each coordinate corresponds to a column.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Create a dictionary to store the light dose units</span>
    <span class="n">dose_units</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;He&#39;</span><span class="p">:</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;Hv&#39;</span><span class="p">:</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="s1">&#39;t_sec&#39;</span><span class="p">}</span>


    <span class="c1"># Retrieve the range light dose values</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dose_values</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
        <span class="n">dose_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">dose_values</span><span class="p">]</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dose_values</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="n">dose_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">dose_values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dose_values</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dose_values</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dose_values</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">dose_values</span> <span class="o">=</span> <span class="n">dose_values</span>        


    <span class="c1"># Retrieve the data        </span>
    <span class="n">cielab_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_files</span><span class="p">(</span><span class="n">sheets</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CIELAB&#39;</span><span class="p">])</span>
    <span class="n">cielab_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cielab_data</span><span class="p">]</span>

    <span class="c1"># Create an empty list with all the colorimetric data</span>
    <span class="n">all_data</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Compute the delta LabCh values and add the data into the list all_data  </span>
    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">cielab_data</span><span class="p">:</span>

        <span class="c1"># for data with std values</span>
        <span class="k">if</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">]:</span>
            <span class="n">data_dLabCh</span> <span class="o">=</span> <span class="n">delta_coord</span> <span class="o">=</span> <span class="p">[</span><span class="n">unumpy</span><span class="o">.</span><span class="n">uarray</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">coord</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="n">coord</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="n">unumpy</span><span class="o">.</span><span class="n">uarray</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">coord</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="n">coord</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span> <span class="s1">&#39;a*&#39;</span><span class="p">,</span> <span class="s1">&#39;b*&#39;</span><span class="p">,</span> <span class="s1">&#39;C*&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data</span><span class="p">]]</span>

            <span class="n">delta_means</span> <span class="o">=</span> <span class="p">[</span><span class="n">unumpy</span><span class="o">.</span><span class="n">nominal_values</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">delta_coord</span><span class="p">]</span>
            <span class="n">delta_stds</span> <span class="o">=</span> <span class="p">[</span><span class="n">unumpy</span><span class="o">.</span><span class="n">std_devs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">delta_coord</span><span class="p">]</span>

            <span class="n">delta_coord_mean</span> <span class="o">=</span> <span class="p">[(</span><span class="sa">f</span><span class="s1">&#39;d</span><span class="si">{</span><span class="n">coord</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span> <span class="s1">&#39;a*&#39;</span><span class="p">,</span> <span class="s1">&#39;b*&#39;</span><span class="p">,</span> <span class="s1">&#39;C*&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">]]</span>
            <span class="n">delta_coord_std</span> <span class="o">=</span> <span class="p">[(</span><span class="sa">f</span><span class="s1">&#39;d</span><span class="si">{</span><span class="n">coord</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span> <span class="s1">&#39;a*&#39;</span><span class="p">,</span> <span class="s1">&#39;b*&#39;</span><span class="p">,</span> <span class="s1">&#39;C*&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">]]</span>

            <span class="k">for</span> <span class="n">coord_mean</span><span class="p">,</span><span class="n">delta_mean</span><span class="p">,</span><span class="n">coord_std</span><span class="p">,</span><span class="n">delta_std</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">delta_coord_mean</span><span class="p">,</span><span class="n">delta_means</span><span class="p">,</span> <span class="n">delta_coord_std</span><span class="p">,</span><span class="n">delta_stds</span><span class="p">):</span>                    
                <span class="n">data</span><span class="p">[</span><span class="n">coord_mean</span><span class="p">]</span> <span class="o">=</span> <span class="n">delta_mean</span>
                <span class="n">data</span><span class="p">[</span><span class="n">coord_std</span><span class="p">]</span> <span class="o">=</span> <span class="n">delta_std</span>

                <span class="n">all_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>          

        <span class="c1"># for data without std values</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data_LabCh</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span><span class="s1">&#39;b*&#39;</span><span class="p">,</span><span class="s1">&#39;C*&#39;</span><span class="p">,</span><span class="s1">&#39;h&#39;</span><span class="p">]]</span>
            <span class="n">data_dLabCh</span> <span class="o">=</span> <span class="n">data_LabCh</span> <span class="o">-</span> <span class="n">data_LabCh</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
            <span class="n">data_dLabCh</span> <span class="o">=</span> <span class="n">data_dLabCh</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;L*&#39;</span><span class="p">:</span> <span class="s1">&#39;dL*&#39;</span><span class="p">,</span> <span class="s1">&#39;a*&#39;</span><span class="p">:</span> <span class="s1">&#39;da*&#39;</span> <span class="p">,</span><span class="s1">&#39;b*&#39;</span><span class="p">:</span> <span class="s1">&#39;db*&#39;</span><span class="p">,</span><span class="s1">&#39;C*&#39;</span><span class="p">:</span> <span class="s1">&#39;dC*&#39;</span><span class="p">,</span><span class="s1">&#39;h&#39;</span><span class="p">:</span> <span class="s1">&#39;dh&#39;</span><span class="p">},</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">all_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">data</span><span class="p">,</span><span class="n">data_dLabCh</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>


    <span class="c1"># Select the wanted dose_unit and coordinate</span>
    <span class="k">if</span> <span class="n">coordinates</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
        <span class="n">wanted_data</span> <span class="o">=</span> <span class="n">all_data</span>
        <span class="n">wanted_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">set_index</span><span class="p">((</span><span class="n">dose_units</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">],</span><span class="s1">&#39;value&#39;</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">wanted_data</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>       
        <span class="n">wanted_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[[</span><span class="n">dose_units</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">]]</span> <span class="o">+</span> <span class="n">coordinates</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_data</span><span class="p">]</span>       
        <span class="n">wanted_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">wanted_data</span><span class="p">]</span>        

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dose_values</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dose_values</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
            <span class="n">interpolated_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">wanted_data</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="c1"># Interpolation function, assuming linear interpolation</span>
        <span class="n">interp_functions</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>


        <span class="c1"># Double comprehension list to interpolate each dataframe in wanted_data</span>
        <span class="n">interpolated_data</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
                <span class="n">col</span><span class="p">:</span> <span class="n">interp_functions</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">])(</span><span class="n">dose_values</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span>
            <span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">dose_values</span><span class="p">)</span>
            <span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="n">dose_units</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">])</span>
            <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">wanted_data</span>
        <span class="p">]</span>


    <span class="c1"># Whether to set the index</span>
    <span class="k">if</span> <span class="n">index</span><span class="p">:</span>
        <span class="n">interpolated_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">interpolated_data</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">interpolated_data</span>       
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.get_data" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">xarray</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.get_data" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Retrieve the microfading data.</p>
<h5 id="microfading.microfading.MFT.get_data--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.get_data--parameters" title="Permanent link">&para;</a></h5>
<p>data : str|list, optional
    Possibility to select the type of data, by default 'all'.
    When 'all', it returns all the data (spectral and colorimetric).
    When 'sp', it only returns the spectral data.
    When 'cl', it only returns the colorimetric data.<br />
    When 'Lab', it returns the CIE L<em>a</em>b<em> values.
    A list of strings can be entered to select specific colourimetric data among the following: ['dE76,'dE00','dR_vis', 'L</em>', 'a<em>', 'b</em>', 'C*', 'h'].</p>


<details class="xarray-" open>
  <summary>bool, optional</summary>
  <p>When True, the data are returned as an xarray.Dataset object, else as pandas dataframe object, by default False.</p>
</details>        <h5 id="microfading.microfading.MFT.get_data--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.get_data--returns" title="Permanent link">&para;</a></h5>
<p>It returns a list of pandas dataframes or xarray.Dataset objects</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">xarray</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve the microfading data.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : str|list, optional</span>
<span class="sd">        Possibility to select the type of data, by default &#39;all&#39;.</span>
<span class="sd">        When &#39;all&#39;, it returns all the data (spectral and colorimetric).</span>
<span class="sd">        When &#39;sp&#39;, it only returns the spectral data.</span>
<span class="sd">        When &#39;cl&#39;, it only returns the colorimetric data.  </span>
<span class="sd">        When &#39;Lab&#39;, it returns the CIE L*a*b* values.</span>
<span class="sd">        A list of strings can be entered to select specific colourimetric data among the following: [&#39;dE76,&#39;dE00&#39;,&#39;dR_vis&#39;, &#39;L*&#39;, &#39;a*&#39;, &#39;b*&#39;, &#39;C*&#39;, &#39;h&#39;].</span>

<span class="sd">    xarray : bool, optional</span>
<span class="sd">        When True, the data are returned as an xarray.Dataset object, else as pandas dataframe object, by default False.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    It returns a list of pandas dataframes or xarray.Dataset objects</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">all_files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_files</span><span class="p">(</span><span class="n">sheets</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;spectra&#39;</span><span class="p">,</span><span class="s1">&#39;CIELAB&#39;</span><span class="p">])</span>
    <span class="n">all_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">data_sp</span> <span class="o">=</span> <span class="p">[]</span> 
    <span class="n">data_cl</span> <span class="o">=</span> <span class="p">[]</span> 

    <span class="k">for</span> <span class="n">data_file</span> <span class="ow">in</span> <span class="n">all_files</span><span class="p">:</span>

        <span class="n">df_sp</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">df_cl</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">df_sp</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">]:</span>
            <span class="n">sp_n</span> <span class="o">=</span> <span class="n">df_sp</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
            <span class="n">sp_s</span> <span class="o">=</span> <span class="n">df_sp</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

            <span class="n">L_n</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;L*&quot;</span><span class="p">,</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">a_n</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;a*&quot;</span><span class="p">,</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">b_n</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;b*&quot;</span><span class="p">,</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">C_n</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;C*&quot;</span><span class="p">,</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">h_n</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;h&quot;</span><span class="p">,</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">dE76_n</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;dE76&quot;</span><span class="p">,</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">dE00_n</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;dE00&quot;</span><span class="p">,</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">dR_vis_n</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;dR_vis&quot;</span><span class="p">,</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

            <span class="n">L_s</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;L*&quot;</span><span class="p">,</span><span class="s2">&quot;std&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">a_s</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;a*&quot;</span><span class="p">,</span><span class="s2">&quot;std&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">b_s</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;b*&quot;</span><span class="p">,</span><span class="s2">&quot;std&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">C_s</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;C*&quot;</span><span class="p">,</span><span class="s2">&quot;std&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">h_s</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;h&quot;</span><span class="p">,</span><span class="s2">&quot;std&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">dE76_s</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;dE76&quot;</span><span class="p">,</span><span class="s2">&quot;std&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">dE00_s</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;dE00&quot;</span><span class="p">,</span><span class="s2">&quot;std&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">dR_vis_s</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;dR_vis&quot;</span><span class="p">,</span><span class="s2">&quot;std&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">sp_n</span> <span class="o">=</span> <span class="n">df_sp</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
            <span class="n">sp_s</span> <span class="o">=</span> <span class="n">df_sp</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">sp_s</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,:]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">sp_s</span> <span class="o">=</span> <span class="n">sp_s</span><span class="o">.</span><span class="n">values</span>

            <span class="n">L_n</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;L*&quot;</span><span class="p">,</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">a_n</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;a*&quot;</span><span class="p">,</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">b_n</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;b*&quot;</span><span class="p">,</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">C_n</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;C*&quot;</span><span class="p">,</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">h_n</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;h&quot;</span><span class="p">,</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">dE76_n</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;dE76&quot;</span><span class="p">,</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">dE00_n</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;dE00&quot;</span><span class="p">,</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">dR_vis_n</span> <span class="o">=</span> <span class="n">df_cl</span><span class="p">[</span><span class="s2">&quot;dR_vis&quot;</span><span class="p">,</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

            <span class="n">L_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">L_n</span><span class="p">))</span>
            <span class="n">a_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a_n</span><span class="p">))</span>
            <span class="n">b_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">b_n</span><span class="p">))</span>
            <span class="n">C_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">C_n</span><span class="p">))</span>
            <span class="n">h_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h_n</span><span class="p">))</span>
            <span class="n">dE76_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dE76_n</span><span class="p">))</span>
            <span class="n">dE00_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dE00_n</span><span class="p">))</span>
            <span class="n">dR_vis_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dR_vis_n</span><span class="p">))</span>

        <span class="n">wl</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">He</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">Hv</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;t_sec&#39;</span><span class="p">,</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

        <span class="n">spectral_data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s1">&#39;sp&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;wavelength&#39;</span><span class="p">,</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">sp_n</span><span class="p">),</span>
                <span class="s1">&#39;sp_s&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;wavelength&#39;</span><span class="p">,</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">sp_s</span><span class="p">)</span>                
            <span class="p">},</span>
            <span class="n">coords</span><span class="o">=</span><span class="p">{</span>
                <span class="s1">&#39;wavelength&#39;</span><span class="p">:</span> <span class="n">wl</span><span class="p">,</span>   
                <span class="s1">&#39;dose&#39;</span><span class="p">:</span> <span class="n">He</span><span class="p">,</span>
                <span class="s1">&#39;He&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;dose&#39;</span><span class="p">,</span> <span class="n">He</span><span class="p">),</span>
                <span class="s1">&#39;Hv&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;dose&#39;</span><span class="p">,</span> <span class="n">Hv</span><span class="p">),</span>  <span class="c1"># Match radiant energy</span>
                <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;dose&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>  <span class="c1"># Match radiant energy</span>
            <span class="p">}</span>
        <span class="p">)</span>

        <span class="n">color_data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s1">&#39;L*&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">L_n</span><span class="p">),</span>
                <span class="s1">&#39;a*&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">a_n</span><span class="p">),</span>
                <span class="s1">&#39;b*&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">b_n</span><span class="p">),</span>
                <span class="s1">&#39;C*&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">C_n</span><span class="p">),</span>
                <span class="s1">&#39;h&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">h_n</span><span class="p">),</span>
                <span class="s1">&#39;dE76&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">dE76_n</span><span class="p">),</span>
                <span class="s1">&#39;dE00&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">dE00_n</span><span class="p">),</span>
                <span class="s1">&#39;dR_vis&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">dR_vis_n</span><span class="p">),</span>
                <span class="s1">&#39;L*_s&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">L_s</span><span class="p">),</span>
                <span class="s1">&#39;a*_s&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">a_s</span><span class="p">),</span>
                <span class="s1">&#39;b*_s&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">b_s</span><span class="p">),</span>
                <span class="s1">&#39;C*_s&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">C_s</span><span class="p">),</span>
                <span class="s1">&#39;h_s&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">h_s</span><span class="p">),</span>
                <span class="s1">&#39;dE76_s&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">dE76_s</span><span class="p">),</span>
                <span class="s1">&#39;dE00_s&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">dE00_s</span><span class="p">),</span>
                <span class="s1">&#39;dR_vis_s&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">dR_vis_s</span><span class="p">),</span>
            <span class="p">},</span>
            <span class="n">coords</span><span class="o">=</span><span class="p">{</span>                    
                <span class="s1">&#39;He&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;dose&#39;</span><span class="p">,</span><span class="n">He</span><span class="p">),</span>
                <span class="s1">&#39;Hv&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;dose&#39;</span><span class="p">,</span><span class="n">Hv</span><span class="p">),</span>
                <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;dose&#39;</span><span class="p">,</span><span class="n">t</span><span class="p">),</span>
            <span class="p">}</span>
        <span class="p">)</span>                

        <span class="n">sp</span> <span class="o">=</span> <span class="n">spectral_data</span><span class="o">.</span><span class="n">set_xindex</span><span class="p">([</span><span class="s2">&quot;He&quot;</span><span class="p">,</span><span class="s2">&quot;Hv&quot;</span><span class="p">,</span><span class="s2">&quot;t&quot;</span><span class="p">])</span>
        <span class="n">cl</span> <span class="o">=</span> <span class="n">color_data</span><span class="o">.</span><span class="n">set_xindex</span><span class="p">([</span><span class="s2">&quot;He&quot;</span><span class="p">,</span><span class="s2">&quot;Hv&quot;</span><span class="p">,</span><span class="s2">&quot;t&quot;</span><span class="p">])</span>
        <span class="n">combined_data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">sp</span><span class="p">,</span> <span class="n">cl</span><span class="p">])</span>

    <span class="n">all_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">combined_data</span><span class="p">)</span>            


    <span class="k">if</span> <span class="n">data</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xarray</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>                
            <span class="p">[</span><span class="n">data_sp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_files</span><span class="p">]</span>
            <span class="p">[</span><span class="n">data_cl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_files</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">data_sp</span><span class="p">,</span> <span class="n">data_cl</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">all_data</span>

    <span class="k">elif</span> <span class="n">data</span> <span class="o">==</span> <span class="s1">&#39;sp&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xarray</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>                
            <span class="p">[</span><span class="n">data_sp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_files</span><span class="p">]</span>                                           
        <span class="k">else</span><span class="p">:</span>                
            <span class="n">data_sp</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">sp</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_data</span><span class="p">]</span>


        <span class="k">return</span> <span class="n">data_sp</span>

    <span class="k">elif</span> <span class="n">data</span> <span class="o">==</span> <span class="s1">&#39;cl&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xarray</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="p">[</span><span class="n">data_cl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_files</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data_cl</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span><span class="s1">&#39;b*&#39;</span><span class="p">,</span><span class="s1">&#39;C*&#39;</span><span class="p">,</span><span class="s1">&#39;h&#39;</span><span class="p">,</span><span class="s1">&#39;dE76&#39;</span><span class="p">,</span><span class="s1">&#39;dE00&#39;</span><span class="p">,</span><span class="s1">&#39;dR_vis&#39;</span><span class="p">]]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_data</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">data_cl</span>

    <span class="k">elif</span> <span class="n">data</span> <span class="o">==</span> <span class="s1">&#39;Lab&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xarray</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="p">[</span><span class="n">data_cl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">][[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span><span class="s1">&#39;b*&#39;</span><span class="p">]])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_files</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data_cl</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span><span class="s1">&#39;b*&#39;</span><span class="p">]]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_data</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">data_cl</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">xarray</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">dic_doses</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;He&#39;</span><span class="p">:</span> <span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;Hv&#39;</span><span class="p">:</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span><span class="s1">&#39;t_sec&#39;</span><span class="p">}</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">dic_doses</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dic_doses</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
            <span class="p">[</span><span class="n">data_cl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">data</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_files</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">elem</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">if</span> <span class="n">elem</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Hv&#39;</span><span class="p">,</span><span class="s1">&#39;He&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">]]</span>
            <span class="n">data_cl</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">data</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_data</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">data_cl</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Enter a valid data parameter. It can either be a string (&#39;sp&#39;, &#39;cl&#39;, &#39;Lab&#39;, &#39;all&#39;) or a list of strings [&#39;dE00&#39;,&#39;dE76&#39;, &#39;L*&#39;, &#39;a*&#39;, &#39;b*&#39;, &#39;C*&#39;, &#39;h&#39;]&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.get_doses" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_doses</span><span class="p">(</span><span class="n">dose_unit</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">max_doses</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.get_doses" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Retrieve the light energy doses related to each microfading measurement.</p>
<h5 id="microfading.microfading.MFT.get_doses--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.get_doses--parameters" title="Permanent link">&para;</a></h5>
<p>dose_unit : Union[str,list], optional
    Unit of the light dose energy, by default 'all'
    Any of the following units can be added to the list: 'He', 'Hv', 't'. Where 'He' corresponds to radiant energy (MJ/m2), 'Hv' to exposure dose (Mlxh), and 't' to times (sec). When a single unit is requested, it can be given as a string value ('He', 'Hv', or 't').</p>


<details class="max_doses-" open>
  <summary>bool, optional</summary>
  <p>Whether to return the maximum light dose values, by default False.</p>
</details>        <h5 id="microfading.microfading.MFT.get_doses--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.get_doses--returns" title="Permanent link">&para;</a></h5>
<p>list of pandas dataframes
    <em>description</em></p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_doses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dose_unit</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">max_doses</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve the light energy doses related to each microfading measurement.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dose_unit : Union[str,list], optional</span>
<span class="sd">        Unit of the light dose energy, by default &#39;all&#39;</span>
<span class="sd">        Any of the following units can be added to the list: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec). When a single unit is requested, it can be given as a string value (&#39;He&#39;, &#39;Hv&#39;, or &#39;t&#39;).</span>

<span class="sd">    max_doses : bool, optional</span>
<span class="sd">        Whether to return the maximum light dose values, by default False.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list of pandas dataframes</span>
<span class="sd">        _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;cl&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">dose_unit</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
        <span class="n">doses</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[[</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;t_sec&#39;</span><span class="p">]]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">doses_dic</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;He&#39;</span><span class="p">:</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;Hv&#39;</span><span class="p">:</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span><span class="s1">&#39;t_sec&#39;</span><span class="p">}</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dose_unit</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">dose_unit</span> <span class="o">=</span> <span class="p">[</span><span class="n">doses_dic</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dose_unit</span><span class="p">]</span> 
            <span class="n">doses</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">doses</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">doses_dic</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">]]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">max_doses</span><span class="p">:</span>
        <span class="n">doses</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">doses</span><span class="p">]</span>


    <span class="k">return</span> <span class="n">doses</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.get_illuminant" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_illuminant</span><span class="p">(</span><span class="n">illuminant</span><span class="o">=</span><span class="s1">&#39;D65&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="o">=</span><span class="s1">&#39;10&#39;</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.get_illuminant" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Set the illuminant values</p>
<h5 id="microfading.microfading.MFT.get_illuminant--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.get_illuminant--parameters" title="Permanent link">&para;</a></h5>
<p>illuminant : Optional[str], optional
    Select the illuminant, by default 'D65'
    It can be any value within the following list: ['A', 'B', 'C', 'D50', 'D55', 'D60', 'D65', 'D75', 'E', 'FL1', 'FL2', 'FL3', 'FL4', 'FL5', 'FL6', 'FL7', 'FL8', 'FL9', 'FL10', 'FL11', 'FL12', 'FL3.1', 'FL3.2', 'FL3.3', 'FL3.4', 'FL3.5', 'FL3.6', 'FL3.7', 'FL3.8', 'FL3.9', 'FL3.10', 'FL3.11', 'FL3.12', 'FL3.13', 'FL3.14', 'FL3.15', 'HP1', 'HP2', 'HP3', 'HP4', 'HP5', 'LED-B1', 'LED-B2', 'LED-B3', 'LED-B4', 'LED-B5', 'LED-BH1', 'LED-RGB1', 'LED-V1', 'LED-V2', 'ID65', 'ID50', 'ISO 7589 Photographic Daylight', 'ISO 7589 Sensitometric Daylight', 'ISO 7589 Studio Tungsten', 'ISO 7589 Sensitometric Studio Tungsten', 'ISO 7589 Photoflood', 'ISO 7589 Sensitometric Photoflood', 'ISO 7589 Sensitometric Printer']</p>


<details class="observer-" open>
  <summary>Optional[str], optional</summary>
  <p>Standard observer in degree, by default '10'
It can be either '2' or '10'</p>
</details>        <h5 id="microfading.microfading.MFT.get_illuminant--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.get_illuminant--returns" title="Permanent link">&para;</a></h5>
<p>tuple
    It returns a tuple with two set of values: the chromaticity coordinates of the illuminants (CCS) and the spectral distribution of the illuminants (SDS).</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_illuminant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">illuminant</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;D65&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;10&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the illuminant values</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    illuminant : Optional[str], optional</span>
<span class="sd">        Select the illuminant, by default &#39;D65&#39;</span>
<span class="sd">        It can be any value within the following list: [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D50&#39;, &#39;D55&#39;, &#39;D60&#39;, &#39;D65&#39;, &#39;D75&#39;, &#39;E&#39;, &#39;FL1&#39;, &#39;FL2&#39;, &#39;FL3&#39;, &#39;FL4&#39;, &#39;FL5&#39;, &#39;FL6&#39;, &#39;FL7&#39;, &#39;FL8&#39;, &#39;FL9&#39;, &#39;FL10&#39;, &#39;FL11&#39;, &#39;FL12&#39;, &#39;FL3.1&#39;, &#39;FL3.2&#39;, &#39;FL3.3&#39;, &#39;FL3.4&#39;, &#39;FL3.5&#39;, &#39;FL3.6&#39;, &#39;FL3.7&#39;, &#39;FL3.8&#39;, &#39;FL3.9&#39;, &#39;FL3.10&#39;, &#39;FL3.11&#39;, &#39;FL3.12&#39;, &#39;FL3.13&#39;, &#39;FL3.14&#39;, &#39;FL3.15&#39;, &#39;HP1&#39;, &#39;HP2&#39;, &#39;HP3&#39;, &#39;HP4&#39;, &#39;HP5&#39;, &#39;LED-B1&#39;, &#39;LED-B2&#39;, &#39;LED-B3&#39;, &#39;LED-B4&#39;, &#39;LED-B5&#39;, &#39;LED-BH1&#39;, &#39;LED-RGB1&#39;, &#39;LED-V1&#39;, &#39;LED-V2&#39;, &#39;ID65&#39;, &#39;ID50&#39;, &#39;ISO 7589 Photographic Daylight&#39;, &#39;ISO 7589 Sensitometric Daylight&#39;, &#39;ISO 7589 Studio Tungsten&#39;, &#39;ISO 7589 Sensitometric Studio Tungsten&#39;, &#39;ISO 7589 Photoflood&#39;, &#39;ISO 7589 Sensitometric Photoflood&#39;, &#39;ISO 7589 Sensitometric Printer&#39;]</span>

<span class="sd">    observer : Optional[str], optional</span>
<span class="sd">        Standard observer in degree, by default &#39;10&#39;</span>
<span class="sd">        It can be either &#39;2&#39; or &#39;10&#39;</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tuple</span>
<span class="sd">        It returns a tuple with two set of values: the chromaticity coordinates of the illuminants (CCS) and the spectral distribution of the illuminants (SDS).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">observers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;10&#39;</span><span class="p">:</span> <span class="s2">&quot;cie_10_1964&quot;</span><span class="p">,</span>
        <span class="s1">&#39;2&#39;</span> <span class="p">:</span> <span class="s2">&quot;cie_2_1931&quot;</span>
    <span class="p">}</span>

    <span class="n">CCS</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">CCS_ILLUMINANTS</span><span class="p">[</span><span class="n">observers</span><span class="p">[</span><span class="n">observer</span><span class="p">]][</span><span class="n">illuminant</span><span class="p">]</span>
    <span class="n">SDS</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">SDS_ILLUMINANTS</span><span class="p">[</span><span class="n">illuminant</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">CCS</span><span class="p">,</span> <span class="n">SDS</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.get_metadata" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_metadata</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.get_metadata" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Retrieve the metadata.</p>
<h5 id="microfading.microfading.MFT.get_metadata--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.get_metadata--parameters" title="Permanent link">&para;</a></h5>
<p>labels : Optional[list], optional
    A list of strings corresponding to the wanted metadata labels, by default 'all'
    The metadata labels can be found in the 'info' sheet of microfading excel files.
    When 'all', it returns all the metadata</p>
<h5 id="microfading.microfading.MFT.get_metadata--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.get_metadata--returns" title="Permanent link">&para;</a></h5>
<p>pandas dataframe
    It returns the metadata inside a pandas dataframe where each column corresponds to a single file.</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve the metadata.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    labels : Optional[list], optional</span>
<span class="sd">        A list of strings corresponding to the wanted metadata labels, by default &#39;all&#39;</span>
<span class="sd">        The metadata labels can be found in the &#39;info&#39; sheet of microfading excel files.</span>
<span class="sd">        When &#39;all&#39;, it returns all the metadata</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pandas dataframe</span>
<span class="sd">        It returns the metadata inside a pandas dataframe where each column corresponds to a single file.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_files</span><span class="p">()</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df</span><span class="p">]</span>

    <span class="n">df_metadata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;parameter&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">metadata</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;parameter&#39;</span><span class="p">)</span>
        <span class="n">Id</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;meas_id&#39;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>

        <span class="n">df_metadata</span><span class="p">[</span><span class="n">Id</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">labels</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">df_metadata</span>

    <span class="k">else</span><span class="p">:</span>            
        <span class="k">return</span> <span class="n">df_metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">labels</span><span class="p">]</span>     
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.get_observer" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_observer</span><span class="p">(</span><span class="n">observer</span><span class="o">=</span><span class="s1">&#39;10&#39;</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.get_observer" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Set the observer.</p>
<h5 id="microfading.microfading.MFT.get_observer--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.get_observer--parameters" title="Permanent link">&para;</a></h5>
<p>observer : Optional[str], optional
    Standard observer in degree, by default '10'
    It can be either '2' or '10'</p>
<h5 id="microfading.microfading.MFT.get_observer--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.get_observer--returns" title="Permanent link">&para;</a></h5>
<div class="codehilite"><pre><span></span><code>Returns the x_bar,  y_bar, z_bar spectra between 360 and 830 nm.
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_observer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observer</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;10&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the observer.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    observer : Optional[str], optional</span>
<span class="sd">        Standard observer in degree, by default &#39;10&#39;</span>
<span class="sd">        It can be either &#39;2&#39; or &#39;10&#39;</span>

<span class="sd">    Returns</span>
<span class="sd">    -------        </span>
<span class="sd">        Returns the x_bar,  y_bar, z_bar spectra between 360 and 830 nm.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">observers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;10&#39;</span><span class="p">:</span> <span class="s2">&quot;CIE 1964 10 Degree Standard Observer&quot;</span><span class="p">,</span>
        <span class="s1">&#39;2&#39;</span> <span class="p">:</span> <span class="s2">&quot;CIE 1931 2 Degree Standard Observer&quot;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="n">observers</span><span class="p">[</span><span class="n">observer</span><span class="p">]]</span>   
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.get_sRGB" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_sRGB</span><span class="p">(</span><span class="n">illuminant</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">dose_unit</span><span class="o">=</span><span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">dose_values</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">clip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.get_sRGB" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute the sRGB values. </p>
<h5 id="microfading.microfading.MFT.get_sRGB--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.get_sRGB--parameters" title="Permanent link">&para;</a></h5>
<p>illuminant : (str, optional)<br />
    Reference <em>illuminant</em> ('D65', or 'D50'). by default 'default'.
    When 'default', it fetches the illuminant value recorded in the db_config.json file of the package. If no value has been recorded, then it sets the illuminant value to 'D65'.</p>


<details class="observer-" open>
  <summary>(str|int, optional)</summary>
  <p>Reference <em>observer</em> in degree ('10' or '2'). by default 'default'.
When 'default', it fetches the observer value recorded in the db_config.json file of the package. If no value has been recorded, then it sets the observer value to '10'.</p>
</details>

<details class="dose_unit-" open>
  <summary>Optional[str], optional</summary>
  <p>Unit of the light dose energy, by default ['He']
Any of the following units can be entered: 'He', 'Hv', 't'. Where 'He' corresponds to radiant energy (MJ/m2), 'Hv' to exposure dose (Mlxh), and 't' to times (sec)</p>
</details>

<details class="dose_values-" open>
  <summary>Union[int, float, list, tuple], optional</summary>
  <p>Dose values for which the colourimetric values will be returned, by default 'all'
When 'all', it returns the colourimetric values for all the dose values available in the given input data files.
A single dose value (an integer or a float number) can be entered.
A list of dose values, as integer or float, can also be entered.
A tuple of three values (min, max, step) will be used in a numpy.arange() function to return an array of dose values. </p>
</details>

<details class="clip-" open>
  <summary>Optional[bool], optional</summary>
  <p>Whether to constraint the srgb values between 0 and 1.</p>
</details>        <h5 id="microfading.microfading.MFT.get_sRGB--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.get_sRGB--returns" title="Permanent link">&para;</a></h5>
<p>pandas dataframe
    It returns the sRGB values inside a dataframe where each column corresponds to a single file.</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_sRGB</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">illuminant</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">dose_unit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">dose_values</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">clip</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the sRGB values. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    illuminant : (str, optional)  </span>
<span class="sd">        Reference *illuminant* (&#39;D65&#39;, or &#39;D50&#39;). by default &#39;default&#39;.</span>
<span class="sd">        When &#39;default&#39;, it fetches the illuminant value recorded in the db_config.json file of the package. If no value has been recorded, then it sets the illuminant value to &#39;D65&#39;.</span>

<span class="sd">    observer : (str|int, optional)</span>
<span class="sd">        Reference *observer* in degree (&#39;10&#39; or &#39;2&#39;). by default &#39;default&#39;.</span>
<span class="sd">        When &#39;default&#39;, it fetches the observer value recorded in the db_config.json file of the package. If no value has been recorded, then it sets the observer value to &#39;10&#39;.</span>

<span class="sd">    dose_unit : Optional[str], optional</span>
<span class="sd">        Unit of the light dose energy, by default [&#39;He&#39;]</span>
<span class="sd">        Any of the following units can be entered: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec)</span>

<span class="sd">    dose_values : Union[int, float, list, tuple], optional</span>
<span class="sd">        Dose values for which the colourimetric values will be returned, by default &#39;all&#39;</span>
<span class="sd">        When &#39;all&#39;, it returns the colourimetric values for all the dose values available in the given input data files.</span>
<span class="sd">        A single dose value (an integer or a float number) can be entered.</span>
<span class="sd">        A list of dose values, as integer or float, can also be entered.</span>
<span class="sd">        A tuple of three values (min, max, step) will be used in a numpy.arange() function to return an array of dose values. </span>

<span class="sd">    clip : Optional[bool], optional</span>
<span class="sd">        Whether to constraint the srgb values between 0 and 1.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pandas dataframe</span>
<span class="sd">        It returns the sRGB values inside a dataframe where each column corresponds to a single file.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">DB</span> <span class="o">=</span> <span class="n">databases</span><span class="o">.</span><span class="n">DB</span><span class="p">()</span>


    <span class="c1"># Set the observer value</span>
    <span class="k">if</span> <span class="n">observer</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">observer</span> <span class="o">=</span> <span class="s1">&#39;10deg&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">observer</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;observer&#39;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">observer</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">observer</span><span class="p">)</span><span class="si">}</span><span class="s1">deg&#39;</span>

    <span class="c1"># Set the illuminant value</span>
    <span class="k">if</span> <span class="n">illuminant</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">illuminant</span> <span class="o">=</span> <span class="s1">&#39;D65&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">illuminant</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;illuminant&#39;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>


    <span class="c1"># Get colorimetric data related to the standard observer</span>
    <span class="n">observers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;10deg&#39;</span><span class="p">:</span> <span class="s1">&#39;cie_10_1964&#39;</span><span class="p">,</span>
        <span class="s1">&#39;2deg&#39;</span> <span class="p">:</span> <span class="s1">&#39;cie_2_1931&#39;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">cmfs_observers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;10deg&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1964 10 Degree Standard Observer&quot;</span><span class="p">],</span>
        <span class="s1">&#39;2deg&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1931 2 Degree Standard Observer&quot;</span><span class="p">]</span> 
        <span class="p">}</span>

    <span class="n">ccs_ill</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">CCS_ILLUMINANTS</span><span class="p">[</span><span class="n">observers</span><span class="p">[</span><span class="n">observer</span><span class="p">]][</span><span class="n">illuminant</span><span class="p">]</span>

    <span class="n">meas_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_meas_ids</span> 

    <span class="n">df_sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_spectra</span><span class="p">(</span><span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span> <span class="n">dose_values</span><span class="o">=</span><span class="n">dose_values</span><span class="p">)</span>   
    <span class="n">df_sp_nominal</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span><span class="p">[:,</span> <span class="s1">&#39;mean&#39;</span><span class="p">]]</span> <span class="k">if</span> <span class="s1">&#39;mean&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span><span class="p">[:,</span> <span class="s1">&#39;value&#39;</span><span class="p">]]</span>
        <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">df_sp</span>
    <span class="p">]</span> 

    <span class="n">df_srgb</span> <span class="o">=</span> <span class="p">[]</span>


    <span class="k">for</span> <span class="n">df</span><span class="p">,</span> <span class="n">meas_id</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df_sp_nominal</span><span class="p">,</span> <span class="n">meas_ids</span><span class="p">):</span>

        <span class="n">srgb_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>            

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>

            <span class="n">sp</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
            <span class="n">wl</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>
            <span class="n">sd</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">SpectralDistribution</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">wl</span><span class="p">)</span>                

            <span class="n">XYZ</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">sd_to_XYZ</span><span class="p">(</span><span class="n">sd</span><span class="p">,</span><span class="n">cmfs_observers</span><span class="p">[</span><span class="n">observer</span><span class="p">],</span> <span class="n">illuminant</span><span class="o">=</span><span class="n">colour</span><span class="o">.</span><span class="n">SDS_ILLUMINANTS</span><span class="p">[</span><span class="n">illuminant</span><span class="p">])</span> 
            <span class="n">srgb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">colour</span><span class="o">.</span><span class="n">XYZ_to_sRGB</span><span class="p">(</span><span class="n">XYZ</span> <span class="o">/</span> <span class="mi">100</span><span class="p">,</span> <span class="n">illuminant</span><span class="o">=</span><span class="n">ccs_ill</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>                        
            <span class="n">srgb_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">srgb_values</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">srgb</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">srgb_values</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">srgb_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">srgb_values</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="n">meas_id</span><span class="p">],</span> <span class="n">srgb_values</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">clip</span><span class="p">:</span>
            <span class="n">srgb_values</span> <span class="o">=</span> <span class="n">srgb_values</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">df_srgb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">srgb_values</span><span class="p">)</span>


    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_srgb</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.get_spectra" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_spectra</span><span class="p">(</span><span class="n">wl_range</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">dose_unit</span><span class="o">=</span><span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">dose_values</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">spectral_mode</span><span class="o">=</span><span class="s1">&#39;rfl&#39;</span><span class="p">,</span> <span class="n">smoothing</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span></code>

<a href="#microfading.microfading.MFT.get_spectra" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Retrieve the reflectance spectra related to the input files.</p>
<h5 id="microfading.microfading.MFT.get_spectra--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.get_spectra--parameters" title="Permanent link">&para;</a></h5>
<p>wl_range : Union[int, float, list, tuple], optional
    Select the wavelengths for which the spectral values should be given with a two-values tuple corresponding to the lowest and highest wavelength values, by default 'all'
    When 'all', it will returned all the available wavelengths contained in the datasets.
    A single wavelength value (an integer or a float number) can be entered.
    A list of specific wavelength values as integer or float can also be entered.
    A tuple of two or three values (min, max, step) will take the range values between these two first values. By default the step is equal to 1.</p>


<details class="dose_unit-" open>
  <summary>string, optional</summary>
  <p>Unit of the light energy dose, by default 'He'
Any of the following units can be used: 'He', 'Hv', 't'. Where 'He' corresponds to radiant energy (MJ/m2), 'Hv' to exposure dose (Mlxh), and 't' to times (sec).</p>
</details>

<details class="dose_values-" open>
  <summary>Union[int, float, list, tuple], optional</summary>
  <p>Dose values for which the reflectance values will be returned, by default 'all'
When 'all', it returns the reflectance values for all the dose values available in the given input data files.
A single dose value (an integer or a float number) can be entered.
A list of dose values, as integer or float, can also be entered.
A tuple of three values (min, max, step) will be used in a numpy.arange() function to return an array of dose values. </p>
</details>

<details class="spectral_mode-" open>
  <summary>string, optional</summary>
  <p>When 'rfl', it returns the reflectance spectra
When 'abs', it returns the absorption spectra using the following equation: A = -log(R)</p>
</details>

<details class="smoothing-" open>
  <summary>list of two integers, optional</summary>
  <p>Whether to smooth the reflectance data using the Savitzky-Golay filter from the Scipy package, by default [1,0]
The first integer corresponds to the window length and should be less than or equal to the size of a reflectance spectrum. The second integer corresponds to the polyorder parameter which is used to fit the samples. The polyorder value must be less than the value of the window length.</p>
</details>        <h5 id="microfading.microfading.MFT.get_spectra--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.get_spectra--returns" title="Permanent link">&para;</a></h5>
<p>A list of pandas dataframes
    It returns a list of pandas dataframes where the columns correspond to the dose values and the rows correspond to the wavelengths.</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_spectra</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wl_range</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">dose_unit</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">dose_values</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">spectral_mode</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;rfl&#39;</span><span class="p">,</span> <span class="n">smoothing</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve the reflectance spectra related to the input files.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wl_range : Union[int, float, list, tuple], optional</span>
<span class="sd">        Select the wavelengths for which the spectral values should be given with a two-values tuple corresponding to the lowest and highest wavelength values, by default &#39;all&#39;</span>
<span class="sd">        When &#39;all&#39;, it will returned all the available wavelengths contained in the datasets.</span>
<span class="sd">        A single wavelength value (an integer or a float number) can be entered.</span>
<span class="sd">        A list of specific wavelength values as integer or float can also be entered.</span>
<span class="sd">        A tuple of two or three values (min, max, step) will take the range values between these two first values. By default the step is equal to 1.</span>

<span class="sd">    dose_unit : string, optional</span>
<span class="sd">        Unit of the light energy dose, by default &#39;He&#39;</span>
<span class="sd">        Any of the following units can be used: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec).</span>

<span class="sd">    dose_values : Union[int, float, list, tuple], optional</span>
<span class="sd">        Dose values for which the reflectance values will be returned, by default &#39;all&#39;</span>
<span class="sd">        When &#39;all&#39;, it returns the reflectance values for all the dose values available in the given input data files.</span>
<span class="sd">        A single dose value (an integer or a float number) can be entered.</span>
<span class="sd">        A list of dose values, as integer or float, can also be entered.</span>
<span class="sd">        A tuple of three values (min, max, step) will be used in a numpy.arange() function to return an array of dose values. </span>

<span class="sd">    spectral_mode : string, optional</span>
<span class="sd">        When &#39;rfl&#39;, it returns the reflectance spectra</span>
<span class="sd">        When &#39;abs&#39;, it returns the absorption spectra using the following equation: A = -log(R)</span>

<span class="sd">    smoothing : list of two integers, optional</span>
<span class="sd">        Whether to smooth the reflectance data using the Savitzky-Golay filter from the Scipy package, by default [1,0]</span>
<span class="sd">        The first integer corresponds to the window length and should be less than or equal to the size of a reflectance spectrum. The second integer corresponds to the polyorder parameter which is used to fit the samples. The polyorder value must be less than the value of the window length.</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A list of pandas dataframes</span>
<span class="sd">        It returns a list of pandas dataframes where the columns correspond to the dose values and the rows correspond to the wavelengths.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">data_sp</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_files</span><span class="p">(</span><span class="n">sheets</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;spectra&#39;</span><span class="p">,</span> <span class="s1">&#39;CIELAB&#39;</span><span class="p">])</span>   

    <span class="n">dose_units</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;He&#39;</span><span class="p">:</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;Hv&#39;</span><span class="p">:</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span><span class="s1">&#39;t_sec&#39;</span><span class="p">}</span>     

    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="n">df_sp</span> <span class="o">=</span> <span class="n">file</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>            

        <span class="c1"># whether to compute the absorption spectra</span>
        <span class="k">if</span> <span class="n">spectral_mode</span> <span class="o">==</span> <span class="s1">&#39;abs&#39;</span><span class="p">:</span>
            <span class="n">df_sp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">df_sp</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>


        <span class="c1"># Set the dose unit</span>
        <span class="k">if</span> <span class="n">dose_unit</span> <span class="o">==</span> <span class="s1">&#39;Hv&#39;</span><span class="p">:</span>
            <span class="n">Hv</span> <span class="o">=</span> <span class="n">file</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">df_sp</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df_sp</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">set_levels</span><span class="p">(</span><span class="n">Hv</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>                
            <span class="c1">#df_sp.index.name = &#39;wl-nm_Hv-Mlxh&#39;</span>

        <span class="k">elif</span> <span class="n">dose_unit</span> <span class="o">==</span><span class="s1">&#39;t&#39;</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">file</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;t_sec&#39;</span><span class="p">,</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">df_sp</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df_sp</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">set_levels</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="c1">#df_sp.index.name = &#39;wl-nm_t-sec&#39;</span>


        <span class="c1"># Set the wavelengths</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wl_range</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">wl_range</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">wl_range</span> <span class="o">=</span> <span class="p">(</span><span class="n">wl_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">wl_range</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">wl_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wl_range</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">wl_range</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>                               

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wl_range</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">wavelengths</span> <span class="o">=</span> <span class="n">wl_range</span>                               

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wl_range</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">wl_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">wl_range</span><span class="p">]</span>
            <span class="n">wavelengths</span> <span class="o">=</span> <span class="n">wl_range</span>  

        <span class="k">else</span><span class="p">:</span>
            <span class="n">wavelengths</span> <span class="o">=</span> <span class="n">df_sp</span><span class="o">.</span><span class="n">index</span>          

        <span class="n">df_sp</span> <span class="o">=</span> <span class="n">df_sp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">wavelengths</span><span class="p">]</span>


        <span class="c1"># Smooth the data</span>
        <span class="n">doses</span> <span class="o">=</span> <span class="n">df_sp</span><span class="o">.</span><span class="n">columns</span>
        <span class="n">df_sp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">savgol_filter</span><span class="p">(</span><span class="n">df_sp</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">window_length</span><span class="o">=</span><span class="n">smoothing</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">polyorder</span><span class="o">=</span><span class="n">smoothing</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">doses</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">wavelengths</span><span class="p">)</span>

        <span class="c1"># Set the dose values </span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dose_values</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dose_values</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">dose_values</span> <span class="o">=</span> <span class="p">(</span><span class="n">dose_values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">dose_values</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">wanted_doses</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">dose_values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dose_values</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dose_values</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dose_values</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dose_values</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>            
            <span class="n">wanted_doses</span> <span class="o">=</span> <span class="p">[</span><span class="n">dose_values</span><span class="p">]</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dose_values</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">wanted_doses</span> <span class="o">=</span> <span class="n">dose_values</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">wanted_doses</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">df_sp</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>


        <span class="k">def</span> <span class="nf">multiindex_2Dinterpolation</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">dose_unit</span><span class="p">,</span> <span class="n">wanted_x</span><span class="p">,</span> <span class="n">wanted_y</span><span class="p">,</span> <span class="n">level_name</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">):</span>
            <span class="n">interpolator</span> <span class="o">=</span> <span class="n">RegularGridInterpolator</span><span class="p">((</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span> <span class="n">df</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>

            <span class="c1"># Create a meshgrid of the new points</span>
            <span class="n">new_wv_grid</span><span class="p">,</span> <span class="n">new_ev_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">wanted_y</span><span class="p">,</span> <span class="n">wanted_x</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s1">&#39;ij&#39;</span><span class="p">)</span>

            <span class="c1"># Flatten the grid arrays and combine them into coordinate pairs</span>
            <span class="n">new_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">new_wv_grid</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">new_ev_grid</span><span class="o">.</span><span class="n">ravel</span><span class="p">()])</span><span class="o">.</span><span class="n">T</span>

            <span class="c1"># Interpolate the data at the new points</span>
            <span class="n">interpolated_values</span> <span class="o">=</span> <span class="n">interpolator</span><span class="p">(</span><span class="n">new_points</span><span class="p">)</span>

            <span class="c1"># Reshape the interpolated values to match the new grid shape</span>
            <span class="n">interpolated_values</span> <span class="o">=</span> <span class="n">interpolated_values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wanted_y</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">wanted_x</span><span class="p">))</span>

            <span class="c1"># Create a new DataFrame with the interpolated data</span>
            <span class="n">new_columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([</span><span class="n">wanted_x</span><span class="p">,</span> <span class="p">[</span><span class="n">level_name</span><span class="p">]],</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="n">dose_units</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">],</span> <span class="s1">&#39;value&#39;</span><span class="p">])</span>
            <span class="n">interpolated_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">interpolated_values</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">wanted_y</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">new_columns</span><span class="p">)</span>

            <span class="n">interpolated_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;wavelength_nm&#39;</span>

            <span class="k">return</span> <span class="n">interpolated_df</span>

        <span class="k">if</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">df_sp</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">]:</span>
            <span class="n">df_sp_n</span> <span class="o">=</span> <span class="n">df_sp</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">df_sp_s</span> <span class="o">=</span> <span class="n">df_sp</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">interpolated_df_sp_n</span> <span class="o">=</span> <span class="n">multiindex_2Dinterpolation</span><span class="p">(</span><span class="n">df_sp_n</span><span class="p">,</span> <span class="n">dose_unit</span><span class="p">,</span> <span class="n">wanted_doses</span><span class="p">,</span> <span class="n">df_sp</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">)</span>   <span class="c1">#.T[::2].T</span>
            <span class="n">interpolated_df_sp_s</span> <span class="o">=</span> <span class="n">multiindex_2Dinterpolation</span><span class="p">(</span><span class="n">df_sp_s</span><span class="p">,</span> <span class="n">dose_unit</span><span class="p">,</span> <span class="n">wanted_doses</span><span class="p">,</span> <span class="n">df_sp</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">)</span>    <span class="c1">#.T[::2].T</span>
            <span class="n">interpolated_df_sp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">interpolated_df_sp_n</span><span class="p">,</span><span class="n">interpolated_df_sp_s</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>                


        <span class="k">else</span><span class="p">:</span>
            <span class="n">interpolated_df_sp</span> <span class="o">=</span> <span class="n">multiindex_2Dinterpolation</span><span class="p">(</span><span class="n">df_sp</span><span class="p">,</span> <span class="n">dose_unit</span><span class="p">,</span> <span class="n">wanted_doses</span><span class="p">,</span> <span class="n">df_sp</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

        <span class="c1"># append the spectral data</span>
        <span class="n">data_sp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">interpolated_df_sp</span><span class="p">)</span> 

    <span class="k">return</span> <span class="n">data_sp</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.get_xy" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_xy</span><span class="p">(</span><span class="n">illuminant</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">dose_unit</span><span class="o">=</span><span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">dose_values</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.get_xy" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute the xy values. </p>
<h5 id="microfading.microfading.MFT.get_xy--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.get_xy--parameters" title="Permanent link">&para;</a></h5>
<p>illuminant : (str, optional)<br />
    Reference <em>illuminant</em> ('D65', or 'D50'). by default 'default'.
    When 'default', it fetches the illuminant value recorded in the db_config.json file of the package. If no value has been recorded, then it sets the illuminant value to 'D65'.</p>


<details class="observer-" open>
  <summary>(str|int, optional)</summary>
  <p>Reference <em>observer</em> in degree ('10' or '2'). by default 'default'.
When 'default', it fetches the observer value recorded in the db_config.json file of the package. If no value has been recorded, then it sets the observer value to '10'.</p>
</details>

<details class="dose_unit-" open>
  <summary>Optional[str], optional</summary>
  <p>Unit of the light dose energy, by default ['He']
Any of the following units can be entered: 'He', 'Hv', 't'. Where 'He' corresponds to radiant energy (MJ/m2), 'Hv' to exposure dose (Mlxh), and 't' to times (sec)</p>
</details>

<details class="dose_values-" open>
  <summary>Union[int, float, list, tuple], optional</summary>
  <p>Dose values for which the colourimetric values will be returned, by default 'all'
When 'all', it returns the colourimetric values for all the dose values available in the given input data files.
A single dose value (an integer or a float number) can be entered.
A list of dose values, as integer or float, can also be entered.
A tuple of three values (min, max, step) will be used in a numpy.arange() function to return an array of dose values. </p>
</details>        <h5 id="microfading.microfading.MFT.get_xy--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.get_xy--returns" title="Permanent link">&para;</a></h5>
<p>pandas dataframe
    It returns the xy values inside a dataframe where each column corresponds to a single file.</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2101</span>
<span class="normal">2102</span>
<span class="normal">2103</span>
<span class="normal">2104</span>
<span class="normal">2105</span>
<span class="normal">2106</span>
<span class="normal">2107</span>
<span class="normal">2108</span>
<span class="normal">2109</span>
<span class="normal">2110</span>
<span class="normal">2111</span>
<span class="normal">2112</span>
<span class="normal">2113</span>
<span class="normal">2114</span>
<span class="normal">2115</span>
<span class="normal">2116</span>
<span class="normal">2117</span>
<span class="normal">2118</span>
<span class="normal">2119</span>
<span class="normal">2120</span>
<span class="normal">2121</span>
<span class="normal">2122</span>
<span class="normal">2123</span>
<span class="normal">2124</span>
<span class="normal">2125</span>
<span class="normal">2126</span>
<span class="normal">2127</span>
<span class="normal">2128</span>
<span class="normal">2129</span>
<span class="normal">2130</span>
<span class="normal">2131</span>
<span class="normal">2132</span>
<span class="normal">2133</span>
<span class="normal">2134</span>
<span class="normal">2135</span>
<span class="normal">2136</span>
<span class="normal">2137</span>
<span class="normal">2138</span>
<span class="normal">2139</span>
<span class="normal">2140</span>
<span class="normal">2141</span>
<span class="normal">2142</span>
<span class="normal">2143</span>
<span class="normal">2144</span>
<span class="normal">2145</span>
<span class="normal">2146</span>
<span class="normal">2147</span>
<span class="normal">2148</span>
<span class="normal">2149</span>
<span class="normal">2150</span>
<span class="normal">2151</span>
<span class="normal">2152</span>
<span class="normal">2153</span>
<span class="normal">2154</span>
<span class="normal">2155</span>
<span class="normal">2156</span>
<span class="normal">2157</span>
<span class="normal">2158</span>
<span class="normal">2159</span>
<span class="normal">2160</span>
<span class="normal">2161</span>
<span class="normal">2162</span>
<span class="normal">2163</span>
<span class="normal">2164</span>
<span class="normal">2165</span>
<span class="normal">2166</span>
<span class="normal">2167</span>
<span class="normal">2168</span>
<span class="normal">2169</span>
<span class="normal">2170</span>
<span class="normal">2171</span>
<span class="normal">2172</span>
<span class="normal">2173</span>
<span class="normal">2174</span>
<span class="normal">2175</span>
<span class="normal">2176</span>
<span class="normal">2177</span>
<span class="normal">2178</span>
<span class="normal">2179</span>
<span class="normal">2180</span>
<span class="normal">2181</span>
<span class="normal">2182</span>
<span class="normal">2183</span>
<span class="normal">2184</span>
<span class="normal">2185</span>
<span class="normal">2186</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">illuminant</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">dose_unit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">dose_values</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the xy values. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    illuminant : (str, optional)  </span>
<span class="sd">        Reference *illuminant* (&#39;D65&#39;, or &#39;D50&#39;). by default &#39;default&#39;.</span>
<span class="sd">        When &#39;default&#39;, it fetches the illuminant value recorded in the db_config.json file of the package. If no value has been recorded, then it sets the illuminant value to &#39;D65&#39;.</span>

<span class="sd">    observer : (str|int, optional)</span>
<span class="sd">        Reference *observer* in degree (&#39;10&#39; or &#39;2&#39;). by default &#39;default&#39;.</span>
<span class="sd">        When &#39;default&#39;, it fetches the observer value recorded in the db_config.json file of the package. If no value has been recorded, then it sets the observer value to &#39;10&#39;.</span>

<span class="sd">    dose_unit : Optional[str], optional</span>
<span class="sd">        Unit of the light dose energy, by default [&#39;He&#39;]</span>
<span class="sd">        Any of the following units can be entered: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec)</span>

<span class="sd">    dose_values : Union[int, float, list, tuple], optional</span>
<span class="sd">        Dose values for which the colourimetric values will be returned, by default &#39;all&#39;</span>
<span class="sd">        When &#39;all&#39;, it returns the colourimetric values for all the dose values available in the given input data files.</span>
<span class="sd">        A single dose value (an integer or a float number) can be entered.</span>
<span class="sd">        A list of dose values, as integer or float, can also be entered.</span>
<span class="sd">        A tuple of three values (min, max, step) will be used in a numpy.arange() function to return an array of dose values. </span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pandas dataframe</span>
<span class="sd">        It returns the xy values inside a dataframe where each column corresponds to a single file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">DB</span> <span class="o">=</span> <span class="n">databases</span><span class="o">.</span><span class="n">DB</span><span class="p">()</span>

    <span class="c1"># Set the observer value</span>
    <span class="k">if</span> <span class="n">observer</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">observer</span> <span class="o">=</span> <span class="s1">&#39;10deg&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">observer</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;observer&#39;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">observer</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">observer</span><span class="p">)</span><span class="si">}</span><span class="s1">deg&#39;</span>


    <span class="c1"># Set the illuminant value</span>
    <span class="k">if</span> <span class="n">illuminant</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">illuminant</span> <span class="o">=</span> <span class="s1">&#39;D65&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">illuminant</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;illuminant&#39;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>               


    <span class="c1"># Get colorimetric data related to the standard observer</span>
    <span class="n">cmfs_observers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;10deg&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1964 10 Degree Standard Observer&quot;</span><span class="p">],</span>
        <span class="s1">&#39;2deg&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1931 2 Degree Standard Observer&quot;</span><span class="p">]</span> 
        <span class="p">}</span>       


    <span class="n">meas_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_meas_ids</span>                
    <span class="n">df_sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_spectra</span><span class="p">(</span><span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span> <span class="n">dose_values</span><span class="o">=</span><span class="n">dose_values</span><span class="p">)</span>   
    <span class="n">df_sp_nominal</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span><span class="p">[:,</span> <span class="s1">&#39;mean&#39;</span><span class="p">]]</span> <span class="k">if</span> <span class="s1">&#39;mean&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span><span class="p">[:,</span> <span class="s1">&#39;value&#39;</span><span class="p">]]</span>
        <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">df_sp</span>
    <span class="p">]</span>     
    <span class="n">df_xy</span> <span class="o">=</span> <span class="p">[]</span>


    <span class="k">for</span> <span class="n">df</span><span class="p">,</span> <span class="n">meas_id</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df_sp_nominal</span><span class="p">,</span> <span class="n">meas_ids</span><span class="p">):</span>

        <span class="n">xy_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>           

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>

            <span class="n">sp</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
            <span class="n">wl</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>
            <span class="n">sd</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">SpectralDistribution</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">wl</span><span class="p">)</span>                

            <span class="n">XYZ</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">sd_to_XYZ</span><span class="p">(</span><span class="n">sd</span><span class="p">,</span><span class="n">cmfs_observers</span><span class="p">[</span><span class="n">observer</span><span class="p">],</span> <span class="n">illuminant</span><span class="o">=</span><span class="n">colour</span><span class="o">.</span><span class="n">SDS_ILLUMINANTS</span><span class="p">[</span><span class="n">illuminant</span><span class="p">])</span>
            <span class="n">xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">colour</span><span class="o">.</span><span class="n">XYZ_to_xy</span><span class="p">(</span><span class="n">XYZ</span><span class="p">),</span><span class="mi">4</span><span class="p">)</span>
            <span class="n">xy_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">xy_values</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">xy_values</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">xy_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">xy_values</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="n">meas_id</span><span class="p">],</span> <span class="n">xy_values</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>
        <span class="n">df_xy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xy_values</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_xy</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.plot_CIELAB" class="doc doc-heading">
            <code class=" language-python"><span class="n">plot_CIELAB</span><span class="p">(</span><span class="n">stds</span><span class="o">=</span><span class="p">[],</span> <span class="n">dose_unit</span><span class="o">=</span><span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">dose_values</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">legend_labels</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">legend_position</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">legend_fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">legend_title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dE</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">obs_ill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">path_fig</span><span class="o">=</span><span class="s1">&#39;cwd&#39;</span><span class="p">,</span> <span class="n">report</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.plot_CIELAB" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Plot the Lab values related to input the microfading files.</p>
<h5 id="microfading.microfading.MFT.plot_CIELAB--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.plot_CIELAB--parameters" title="Permanent link">&para;</a></h5>
<p>stds : list, optional
    A list of standard variation values respective to each element given in the data parameter, by default []</p>


<details class="dose_unit-" open>
  <summary>str, optional</summary>
  <p>Unit of the light energy dose, by default 'He'
Any of the following units can be used: 'He', 'Hv', 't'. Where 'He' corresponds to radiant energy (MJ/m2), 'Hv' to exposure dose (Mlxh), and 't' to times (sec)</p>
</details>

<details class="dose_values-" open>
  <summary>[int, float, list, tuple], optional</summary>
  <p>Values of the light dose energy, by default 'all'
A single value (integer or float number), a list of multiple numerical values, or range values with a tuple (start, end, step) can be entered.
When 'all', it takes the values found in the data.   </p>
</details>

<details class="colors-" open>
  <summary>[str, list], optional</summary>
  <p>Define the colors of the data points, by default None
When 'sample', the color of each points will be based on srgb values computed from the reflectance values. Alternatively, a single string value can be used to define the color (see matplotlib colour values) or a list of matplotlib colour values can be used.     </p>
</details>

<details class="title-" open>
  <summary>str, optional</summary>
  <p>Whether to add a title to the plot, by default None</p>
</details>

<details class="fontsize-" open>
  <summary>int, optional</summary>
  <p>Fontsize of the plot (title, ticks, and labels), by default 24</p>
</details>

<details class="legend_labels-" open>
  <summary>[str, list], optional</summary>
  <p>A list of labels respective to each element given in the data parameter that will be shown in the legend. When the list is empty there is no legend displayed, by default 'default'
When 'default', each label will composed of the Id number of the number followed by a short description</p>
</details>

<details class="legend_position-" open>
  <summary>str, optional</summary>
  <p>Position of the legend, by default 'in'
The legend can either be inside the figure ('in') or outside ('out')</p>
</details>

<details class="legend_fontsize-" open>
  <summary>int, optional</summary>
  <p>Fontsize of the legend, by default 24</p>
</details>

<details class="legend_title-" open>
  <summary>str, optional</summary>
  <p>Add a title above the legend, by default ''</p>
</details>

<details class="de-" open>
  <summary>bool, optional</summary>
  <p>Whether to display the dE00 curves in the bottom left suplots instead of the CIELAB 2D space, by default False
NOT IMPLEMENTED YET ! LEAVE PARAMETER TO FALSE</p>
</details>

<details class="obs_ill-" open>
  <summary>bool, optional</summary>
  <p>Whether to display the observer and illuminant values, by default True</p>
</details>

<details class="save-" open>
  <summary>bool, optional</summary>
  <p>Whether to save the figure, by default False</p>
</details>

<details class="path_fig-" open>
  <summary>str, optional</summary>
  <p>Absolute path required to save the figure, by default 'cwd'
When 'cwd', it will save the figure in the current working directory.</p>
</details>        <h5 id="microfading.microfading.MFT.plot_CIELAB--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.plot_CIELAB--returns" title="Permanent link">&para;</a></h5>
<p>png file
    It returns a figure with 4 subplots that can be saved as a png file.</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2444</span>
<span class="normal">2445</span>
<span class="normal">2446</span>
<span class="normal">2447</span>
<span class="normal">2448</span>
<span class="normal">2449</span>
<span class="normal">2450</span>
<span class="normal">2451</span>
<span class="normal">2452</span>
<span class="normal">2453</span>
<span class="normal">2454</span>
<span class="normal">2455</span>
<span class="normal">2456</span>
<span class="normal">2457</span>
<span class="normal">2458</span>
<span class="normal">2459</span>
<span class="normal">2460</span>
<span class="normal">2461</span>
<span class="normal">2462</span>
<span class="normal">2463</span>
<span class="normal">2464</span>
<span class="normal">2465</span>
<span class="normal">2466</span>
<span class="normal">2467</span>
<span class="normal">2468</span>
<span class="normal">2469</span>
<span class="normal">2470</span>
<span class="normal">2471</span>
<span class="normal">2472</span>
<span class="normal">2473</span>
<span class="normal">2474</span>
<span class="normal">2475</span>
<span class="normal">2476</span>
<span class="normal">2477</span>
<span class="normal">2478</span>
<span class="normal">2479</span>
<span class="normal">2480</span>
<span class="normal">2481</span>
<span class="normal">2482</span>
<span class="normal">2483</span>
<span class="normal">2484</span>
<span class="normal">2485</span>
<span class="normal">2486</span>
<span class="normal">2487</span>
<span class="normal">2488</span>
<span class="normal">2489</span>
<span class="normal">2490</span>
<span class="normal">2491</span>
<span class="normal">2492</span>
<span class="normal">2493</span>
<span class="normal">2494</span>
<span class="normal">2495</span>
<span class="normal">2496</span>
<span class="normal">2497</span>
<span class="normal">2498</span>
<span class="normal">2499</span>
<span class="normal">2500</span>
<span class="normal">2501</span>
<span class="normal">2502</span>
<span class="normal">2503</span>
<span class="normal">2504</span>
<span class="normal">2505</span>
<span class="normal">2506</span>
<span class="normal">2507</span>
<span class="normal">2508</span>
<span class="normal">2509</span>
<span class="normal">2510</span>
<span class="normal">2511</span>
<span class="normal">2512</span>
<span class="normal">2513</span>
<span class="normal">2514</span>
<span class="normal">2515</span>
<span class="normal">2516</span>
<span class="normal">2517</span>
<span class="normal">2518</span>
<span class="normal">2519</span>
<span class="normal">2520</span>
<span class="normal">2521</span>
<span class="normal">2522</span>
<span class="normal">2523</span>
<span class="normal">2524</span>
<span class="normal">2525</span>
<span class="normal">2526</span>
<span class="normal">2527</span>
<span class="normal">2528</span>
<span class="normal">2529</span>
<span class="normal">2530</span>
<span class="normal">2531</span>
<span class="normal">2532</span>
<span class="normal">2533</span>
<span class="normal">2534</span>
<span class="normal">2535</span>
<span class="normal">2536</span>
<span class="normal">2537</span>
<span class="normal">2538</span>
<span class="normal">2539</span>
<span class="normal">2540</span>
<span class="normal">2541</span>
<span class="normal">2542</span>
<span class="normal">2543</span>
<span class="normal">2544</span>
<span class="normal">2545</span>
<span class="normal">2546</span>
<span class="normal">2547</span>
<span class="normal">2548</span>
<span class="normal">2549</span>
<span class="normal">2550</span>
<span class="normal">2551</span>
<span class="normal">2552</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_CIELAB</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stds</span><span class="o">=</span><span class="p">[],</span> <span class="n">dose_unit</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">dose_values</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">colors</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">legend_labels</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">legend_position</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">legend_fontsize</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">legend_title</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">dE</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">obs_ill</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">save</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">path_fig</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;cwd&#39;</span><span class="p">,</span> <span class="n">report</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot the Lab values related to input the microfading files.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    stds : list, optional</span>
<span class="sd">        A list of standard variation values respective to each element given in the data parameter, by default []</span>

<span class="sd">    dose_unit : str, optional</span>
<span class="sd">        Unit of the light energy dose, by default &#39;He&#39;</span>
<span class="sd">        Any of the following units can be used: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec)</span>

<span class="sd">    dose_values : [int, float, list, tuple], optional        </span>
<span class="sd">        Values of the light dose energy, by default &#39;all&#39;</span>
<span class="sd">        A single value (integer or float number), a list of multiple numerical values, or range values with a tuple (start, end, step) can be entered.</span>
<span class="sd">        When &#39;all&#39;, it takes the values found in the data.   </span>

<span class="sd">    colors : [str, list], optional</span>
<span class="sd">        Define the colors of the data points, by default None</span>
<span class="sd">        When &#39;sample&#39;, the color of each points will be based on srgb values computed from the reflectance values. Alternatively, a single string value can be used to define the color (see matplotlib colour values) or a list of matplotlib colour values can be used.     </span>

<span class="sd">    title : str, optional</span>
<span class="sd">        Whether to add a title to the plot, by default None</span>

<span class="sd">    fontsize : int, optional</span>
<span class="sd">        Fontsize of the plot (title, ticks, and labels), by default 24</span>

<span class="sd">    legend_labels : [str, list], optional</span>
<span class="sd">        A list of labels respective to each element given in the data parameter that will be shown in the legend. When the list is empty there is no legend displayed, by default &#39;default&#39;</span>
<span class="sd">        When &#39;default&#39;, each label will composed of the Id number of the number followed by a short description</span>

<span class="sd">    legend_position : str, optional</span>
<span class="sd">        Position of the legend, by default &#39;in&#39;</span>
<span class="sd">        The legend can either be inside the figure (&#39;in&#39;) or outside (&#39;out&#39;)</span>

<span class="sd">    legend_fontsize : int, optional</span>
<span class="sd">        Fontsize of the legend, by default 24</span>

<span class="sd">    legend_title : str, optional</span>
<span class="sd">        Add a title above the legend, by default &#39;&#39;</span>

<span class="sd">    dE : bool, optional</span>
<span class="sd">        Whether to display the dE00 curves in the bottom left suplots instead of the CIELAB 2D space, by default False</span>
<span class="sd">        NOT IMPLEMENTED YET ! LEAVE PARAMETER TO FALSE</span>

<span class="sd">    obs_ill : bool, optional</span>
<span class="sd">        Whether to display the observer and illuminant values, by default True</span>

<span class="sd">    save : bool, optional</span>
<span class="sd">        Whether to save the figure, by default False</span>

<span class="sd">    path_fig : str, optional</span>
<span class="sd">        Absolute path required to save the figure, by default &#39;cwd&#39;</span>
<span class="sd">        When &#39;cwd&#39;, it will save the figure in the current working directory.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    png file</span>
<span class="sd">        It returns a figure with 4 subplots that can be saved as a png file.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">data_Lab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cielab</span><span class="p">(</span><span class="n">coordinates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span> <span class="s1">&#39;a*&#39;</span><span class="p">,</span> <span class="s1">&#39;b*&#39;</span><span class="p">],</span> <span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span> <span class="n">dose_values</span><span class="o">=</span><span class="n">dose_values</span><span class="p">)</span>
    <span class="n">data_Lab</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">values</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_Lab</span><span class="p">]</span>


    <span class="c1"># Retrieve the metadata</span>
    <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()</span>
    <span class="n">ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_meas_ids</span> <span class="k">if</span> <span class="s1">&#39;BW&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span> 

    <span class="k">if</span> <span class="s1">&#39;group_description&#39;</span> <span class="ow">in</span> <span class="n">info</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>                
        <span class="n">group_descriptions</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;group_description&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">group_descriptions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>



    <span class="c1"># Define the colour of the curves</span>
    <span class="k">if</span> <span class="n">colors</span> <span class="o">==</span> <span class="s1">&#39;sample&#39;</span><span class="p">:</span>
        <span class="k">pass</span>           

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">colors</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">colors</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>

    <span class="c1"># Define the labels</span>
    <span class="k">if</span> <span class="n">legend_labels</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
        <span class="n">legend_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_meas_ids</span><span class="p">,</span><span class="n">group_descriptions</span><span class="p">)]</span>
        <span class="n">legend_title</span> <span class="o">=</span> <span class="s1">&#39;Measurement $n^o$&#39;</span>

    <span class="c1"># Whether to plot the observer and illuminant info</span>
    <span class="k">if</span> <span class="n">obs_ill</span><span class="p">:</span>
        <span class="n">DB</span> <span class="o">=</span> <span class="n">databases</span><span class="o">.</span><span class="n">DB</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">observer</span> <span class="o">=</span> <span class="s1">&#39;10deg&#39;</span>
            <span class="n">illuminant</span> <span class="o">=</span> <span class="s1">&#39;D65&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">observer</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;observer&#39;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
            <span class="n">illuminant</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;illuminant&#39;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>

        <span class="n">dic_obs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;10deg&#39;</span><span class="p">:</span><span class="s1">&#39;$\mathrm{10^o}$&#39;</span><span class="p">,</span> <span class="s1">&#39;2deg&#39;</span><span class="p">:</span><span class="s1">&#39;$\mathrm{2^o}$&#39;</span><span class="p">}</span>            
        <span class="n">obs_ill</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">dic_obs</span><span class="p">[</span><span class="n">observer</span><span class="p">]</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">illuminant</span><span class="si">}</span><span class="s1">&#39;</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">obs_ill</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">plotting</span><span class="o">.</span><span class="n">CIELAB</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data_Lab</span><span class="p">,</span> <span class="n">legend_labels</span><span class="o">=</span><span class="n">legend_labels</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">legend_fontsize</span><span class="o">=</span><span class="n">legend_fontsize</span><span class="p">,</span> <span class="n">legend_position</span><span class="o">=</span><span class="n">legend_position</span><span class="p">,</span> <span class="n">legend_title</span><span class="o">=</span><span class="n">legend_title</span><span class="p">,</span> <span class="n">dE</span><span class="o">=</span><span class="n">dE</span><span class="p">,</span> <span class="n">obs_ill</span><span class="o">=</span><span class="n">obs_ill</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span> <span class="n">path_fig</span><span class="o">=</span><span class="n">path_fig</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.plot_bars" class="doc doc-heading">
            <code class=" language-python"><span class="n">plot_bars</span><span class="p">(</span><span class="n">BWS_lines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">coordinate</span><span class="o">=</span><span class="s1">&#39;dE00&#39;</span><span class="p">,</span> <span class="n">dose_unit</span><span class="o">=</span><span class="s1">&#39;Hv&#39;</span><span class="p">,</span> <span class="n">dose_value</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">xlabels</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">group_objects</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">rotate_xlabels</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">position_xlabels</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">position_text</span><span class="o">=</span><span class="p">(</span><span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.92</span><span class="p">),</span> <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">path_fig</span><span class="o">=</span><span class="s1">&#39;cwd&#39;</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.plot_bars" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Plot a bar graph of a given colorimetric coordinate for a given light dose value.</p>
<h5 id="microfading.microfading.MFT.plot_bars--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.plot_bars--parameters" title="Permanent link">&para;</a></h5>
<p>BWS_lines : Optional[bool], optional
    Whether to display the blue wool standard values as horizontal lines or as bars, by default True</p>


<details class="coordinate-" open>
  <summary>Optional[str], optional</summary>
  <p>Colorimetric coordinate to be displayed, by default 'dE00'
It can be any coordinates among the following list : ['L<em>','a</em>','b<em>','C</em>','h','dL<em>','da</em>','db<em>','dC</em>','dh','dE76','dE00','dR_vis'].</p>
</details>

<details class="dose_unit-" open>
  <summary>Optional[str], optional</summary>
  <p>Unit of the light energy dose, by default 'Hv'
Any of the following units can be used: 'He', 'Hv', 't'. Where 'He' corresponds to radiant energy (MJ/m2), 'Hv' to exposure dose (Mlxh), and 't' to times (sec)</p>
</details>

<details class="dose_value-" open>
  <summary>Union[int, float], optional</summary>
  <p>Values of the light dose energy, by default 0.5</p>
</details>

<details class="xlabels-" open>
  <summary>Union[str, list], optional</summary>
  <p>Values of the labels on the x-axis (one label per bar), by default 'default'
When 'default', it takes the measurement id as label.</p>
</details>

<details class="fontsize-" open>
  <summary>Optional[int], optional</summary>
  <p>Fontsize of the plot (title, ticks, and labels), by default 24</p>
</details>

<details class="rotate_xlabels-" open>
  <summary>Optional[int], optional</summary>
  <p>Whether to rotate the labels on the x-axis, by default 0
It can be any integer value between 0 and 360.</p>
</details>

<details class="position_xlabels-" open>
  <summary>Optional[str], optional</summary>
  <p>Position of the labels according to each bar ('center', 'left', 'right'), by default 'center'</p>
</details>

<details class="position_text-" open>
  <summary>Optional[tuple], optional</summary>
  <p>Position (x,y) of the text with the exposure dose value, by default (0.03,0.92)</p>
</details>

<details class="colors-" open>
  <summary>Union[str,float,list], optional</summary>
  <p>Colors of the bar, by default None
When 'sample', the color of each bar will be based on srgb values computed from the reflectance values. 
A single string or float value can also be used to define the color of all the bars (see matplotlib colour values). 
A list string can also be given, in that case, the number of element in the list should be equal to the number of bars. </p>
</details>

<details class="save-" open>
  <summary>bool, optional</summary>
  <p>Whether to save the figure, by default False</p>
</details>

<details class="path_fig-" open>
  <summary>str, optional</summary>
  <p>Absolute path required to save the figure, by default 'cwd'
When 'cwd', it will save the figure in the current working directory.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2212</span>
<span class="normal">2213</span>
<span class="normal">2214</span>
<span class="normal">2215</span>
<span class="normal">2216</span>
<span class="normal">2217</span>
<span class="normal">2218</span>
<span class="normal">2219</span>
<span class="normal">2220</span>
<span class="normal">2221</span>
<span class="normal">2222</span>
<span class="normal">2223</span>
<span class="normal">2224</span>
<span class="normal">2225</span>
<span class="normal">2226</span>
<span class="normal">2227</span>
<span class="normal">2228</span>
<span class="normal">2229</span>
<span class="normal">2230</span>
<span class="normal">2231</span>
<span class="normal">2232</span>
<span class="normal">2233</span>
<span class="normal">2234</span>
<span class="normal">2235</span>
<span class="normal">2236</span>
<span class="normal">2237</span>
<span class="normal">2238</span>
<span class="normal">2239</span>
<span class="normal">2240</span>
<span class="normal">2241</span>
<span class="normal">2242</span>
<span class="normal">2243</span>
<span class="normal">2244</span>
<span class="normal">2245</span>
<span class="normal">2246</span>
<span class="normal">2247</span>
<span class="normal">2248</span>
<span class="normal">2249</span>
<span class="normal">2250</span>
<span class="normal">2251</span>
<span class="normal">2252</span>
<span class="normal">2253</span>
<span class="normal">2254</span>
<span class="normal">2255</span>
<span class="normal">2256</span>
<span class="normal">2257</span>
<span class="normal">2258</span>
<span class="normal">2259</span>
<span class="normal">2260</span>
<span class="normal">2261</span>
<span class="normal">2262</span>
<span class="normal">2263</span>
<span class="normal">2264</span>
<span class="normal">2265</span>
<span class="normal">2266</span>
<span class="normal">2267</span>
<span class="normal">2268</span>
<span class="normal">2269</span>
<span class="normal">2270</span>
<span class="normal">2271</span>
<span class="normal">2272</span>
<span class="normal">2273</span>
<span class="normal">2274</span>
<span class="normal">2275</span>
<span class="normal">2276</span>
<span class="normal">2277</span>
<span class="normal">2278</span>
<span class="normal">2279</span>
<span class="normal">2280</span>
<span class="normal">2281</span>
<span class="normal">2282</span>
<span class="normal">2283</span>
<span class="normal">2284</span>
<span class="normal">2285</span>
<span class="normal">2286</span>
<span class="normal">2287</span>
<span class="normal">2288</span>
<span class="normal">2289</span>
<span class="normal">2290</span>
<span class="normal">2291</span>
<span class="normal">2292</span>
<span class="normal">2293</span>
<span class="normal">2294</span>
<span class="normal">2295</span>
<span class="normal">2296</span>
<span class="normal">2297</span>
<span class="normal">2298</span>
<span class="normal">2299</span>
<span class="normal">2300</span>
<span class="normal">2301</span>
<span class="normal">2302</span>
<span class="normal">2303</span>
<span class="normal">2304</span>
<span class="normal">2305</span>
<span class="normal">2306</span>
<span class="normal">2307</span>
<span class="normal">2308</span>
<span class="normal">2309</span>
<span class="normal">2310</span>
<span class="normal">2311</span>
<span class="normal">2312</span>
<span class="normal">2313</span>
<span class="normal">2314</span>
<span class="normal">2315</span>
<span class="normal">2316</span>
<span class="normal">2317</span>
<span class="normal">2318</span>
<span class="normal">2319</span>
<span class="normal">2320</span>
<span class="normal">2321</span>
<span class="normal">2322</span>
<span class="normal">2323</span>
<span class="normal">2324</span>
<span class="normal">2325</span>
<span class="normal">2326</span>
<span class="normal">2327</span>
<span class="normal">2328</span>
<span class="normal">2329</span>
<span class="normal">2330</span>
<span class="normal">2331</span>
<span class="normal">2332</span>
<span class="normal">2333</span>
<span class="normal">2334</span>
<span class="normal">2335</span>
<span class="normal">2336</span>
<span class="normal">2337</span>
<span class="normal">2338</span>
<span class="normal">2339</span>
<span class="normal">2340</span>
<span class="normal">2341</span>
<span class="normal">2342</span>
<span class="normal">2343</span>
<span class="normal">2344</span>
<span class="normal">2345</span>
<span class="normal">2346</span>
<span class="normal">2347</span>
<span class="normal">2348</span>
<span class="normal">2349</span>
<span class="normal">2350</span>
<span class="normal">2351</span>
<span class="normal">2352</span>
<span class="normal">2353</span>
<span class="normal">2354</span>
<span class="normal">2355</span>
<span class="normal">2356</span>
<span class="normal">2357</span>
<span class="normal">2358</span>
<span class="normal">2359</span>
<span class="normal">2360</span>
<span class="normal">2361</span>
<span class="normal">2362</span>
<span class="normal">2363</span>
<span class="normal">2364</span>
<span class="normal">2365</span>
<span class="normal">2366</span>
<span class="normal">2367</span>
<span class="normal">2368</span>
<span class="normal">2369</span>
<span class="normal">2370</span>
<span class="normal">2371</span>
<span class="normal">2372</span>
<span class="normal">2373</span>
<span class="normal">2374</span>
<span class="normal">2375</span>
<span class="normal">2376</span>
<span class="normal">2377</span>
<span class="normal">2378</span>
<span class="normal">2379</span>
<span class="normal">2380</span>
<span class="normal">2381</span>
<span class="normal">2382</span>
<span class="normal">2383</span>
<span class="normal">2384</span>
<span class="normal">2385</span>
<span class="normal">2386</span>
<span class="normal">2387</span>
<span class="normal">2388</span>
<span class="normal">2389</span>
<span class="normal">2390</span>
<span class="normal">2391</span>
<span class="normal">2392</span>
<span class="normal">2393</span>
<span class="normal">2394</span>
<span class="normal">2395</span>
<span class="normal">2396</span>
<span class="normal">2397</span>
<span class="normal">2398</span>
<span class="normal">2399</span>
<span class="normal">2400</span>
<span class="normal">2401</span>
<span class="normal">2402</span>
<span class="normal">2403</span>
<span class="normal">2404</span>
<span class="normal">2405</span>
<span class="normal">2406</span>
<span class="normal">2407</span>
<span class="normal">2408</span>
<span class="normal">2409</span>
<span class="normal">2410</span>
<span class="normal">2411</span>
<span class="normal">2412</span>
<span class="normal">2413</span>
<span class="normal">2414</span>
<span class="normal">2415</span>
<span class="normal">2416</span>
<span class="normal">2417</span>
<span class="normal">2418</span>
<span class="normal">2419</span>
<span class="normal">2420</span>
<span class="normal">2421</span>
<span class="normal">2422</span>
<span class="normal">2423</span>
<span class="normal">2424</span>
<span class="normal">2425</span>
<span class="normal">2426</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_bars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">BWS_lines</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">coordinate</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;dE00&#39;</span><span class="p">,</span> <span class="n">dose_unit</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Hv&#39;</span><span class="p">,</span> <span class="n">dose_value</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">xlabels</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">group_objects</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span> <span class="n">rotate_xlabels</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">position_xlabels</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">position_text</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.03</span><span class="p">,</span><span class="mf">0.92</span><span class="p">),</span> <span class="n">colors</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">float</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">path_fig</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;cwd&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot a bar graph of a given colorimetric coordinate for a given light dose value.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    BWS_lines : Optional[bool], optional</span>
<span class="sd">        Whether to display the blue wool standard values as horizontal lines or as bars, by default True</span>

<span class="sd">    coordinate : Optional[str], optional</span>
<span class="sd">        Colorimetric coordinate to be displayed, by default &#39;dE00&#39;</span>
<span class="sd">        It can be any coordinates among the following list : [&#39;L*&#39;,&#39;a*&#39;,&#39;b*&#39;,&#39;C*&#39;,&#39;h&#39;,&#39;dL*&#39;,&#39;da*&#39;,&#39;db*&#39;,&#39;dC*&#39;,&#39;dh&#39;,&#39;dE76&#39;,&#39;dE00&#39;,&#39;dR_vis&#39;].</span>

<span class="sd">    dose_unit : Optional[str], optional</span>
<span class="sd">        Unit of the light energy dose, by default &#39;Hv&#39;</span>
<span class="sd">        Any of the following units can be used: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec)</span>

<span class="sd">    dose_value : Union[int, float], optional</span>
<span class="sd">        Values of the light dose energy, by default 0.5</span>

<span class="sd">    xlabels : Union[str, list], optional</span>
<span class="sd">        Values of the labels on the x-axis (one label per bar), by default &#39;default&#39;</span>
<span class="sd">        When &#39;default&#39;, it takes the measurement id as label.</span>

<span class="sd">    fontsize : Optional[int], optional</span>
<span class="sd">        Fontsize of the plot (title, ticks, and labels), by default 24</span>

<span class="sd">    rotate_xlabels : Optional[int], optional</span>
<span class="sd">        Whether to rotate the labels on the x-axis, by default 0</span>
<span class="sd">        It can be any integer value between 0 and 360.</span>

<span class="sd">    position_xlabels : Optional[str], optional</span>
<span class="sd">        Position of the labels according to each bar (&#39;center&#39;, &#39;left&#39;, &#39;right&#39;), by default &#39;center&#39;</span>

<span class="sd">    position_text : Optional[tuple], optional</span>
<span class="sd">        Position (x,y) of the text with the exposure dose value, by default (0.03,0.92)</span>

<span class="sd">    colors : Union[str,float,list], optional</span>
<span class="sd">        Colors of the bar, by default None</span>
<span class="sd">        When &#39;sample&#39;, the color of each bar will be based on srgb values computed from the reflectance values. </span>
<span class="sd">        A single string or float value can also be used to define the color of all the bars (see matplotlib colour values). </span>
<span class="sd">        A list string can also be given, in that case, the number of element in the list should be equal to the number of bars. </span>

<span class="sd">    save : bool, optional</span>
<span class="sd">        Whether to save the figure, by default False</span>

<span class="sd">    path_fig : str, optional</span>
<span class="sd">        Absolute path required to save the figure, by default &#39;cwd&#39;</span>
<span class="sd">        When &#39;cwd&#39;, it will save the figure in the current working directory.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># [&#39;L*&#39;,&#39;a*&#39;,&#39;b*&#39;,&#39;C*&#39;,&#39;h&#39;,&#39;dL*&#39;,&#39;da*&#39;,&#39;db*&#39;,&#39;dC*&#39;,&#39;dh&#39;,&#39;dE76&#39;,&#39;dE00&#39;,&#39;dR_vis&#39;]</span>

    <span class="c1"># Define the light dose value      </span>
    <span class="n">doses_dic</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;He&#39;</span><span class="p">:</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;Hv&#39;</span><span class="p">:</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span><span class="s1">&#39;t_sec&#39;</span><span class="p">}</span>
    <span class="n">max_doses</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_doses</span><span class="p">(</span><span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span> <span class="n">max_doses</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>

    <span class="k">if</span> <span class="n">dose_value</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">max_doses</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The choosen dose_value (</span><span class="si">{</span><span class="n">dose_value</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">doses_dic</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">) is bigger than one of the final dose values. Thus the dose_value has been set to </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">max_doses</span><span class="p">)</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">doses_dic</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">, which is the lowest final dose value.&#39;</span><span class="p">)</span>
        <span class="n">dose_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">max_doses</span><span class="p">)</span>


    <span class="c1"># Define the labels on the x-axis</span>
    <span class="k">if</span> <span class="n">xlabels</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
        <span class="n">xlabels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_meas_ids</span>

    <span class="k">elif</span> <span class="n">xlabels</span> <span class="o">==</span> <span class="s1">&#39;meas_nb&#39;</span><span class="p">:</span>
        <span class="n">xlabels</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_meas_ids</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">xlabels</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()</span><span class="o">.</span><span class="n">index</span> <span class="k">if</span> <span class="s1">&#39;[&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]:</span>
        <span class="n">xlabels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">xlabels</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>


    <span class="c1"># Define the colour of the bars</span>
    <span class="k">if</span> <span class="n">colors</span> <span class="o">==</span> <span class="s1">&#39;sample&#39;</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sRGB</span><span class="p">(</span><span class="n">dose_values</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">colors</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">colors</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>

    <span class="c1"># Define the objects ID</span>
    <span class="n">object_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="s1">&#39;object_id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

    <span class="c1"># Define the object name</span>
    <span class="n">object_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="s1">&#39;object_name&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

    <span class="c1"># Gather the data and relevant info inside a dataframe</span>
    <span class="n">all_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cielab</span><span class="p">(</span><span class="n">coordinates</span><span class="o">=</span><span class="p">[</span><span class="n">coordinate</span><span class="p">],</span> <span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span> <span class="n">dose_values</span><span class="o">=</span><span class="n">dose_value</span><span class="p">)</span>
    <span class="n">cl_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_data</span><span class="p">]</span>
    <span class="n">cl_data_std</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;std&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_data</span><span class="p">]</span>

    <span class="n">plot_data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">cl_data</span><span class="p">,</span>
        <span class="s1">&#39;y_std&#39;</span><span class="p">:</span> <span class="n">cl_data_std</span><span class="p">,</span> 
        <span class="s1">&#39;xlabels&#39;</span><span class="p">:</span> <span class="n">xlabels</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="s1">&#39;object_type&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">object_ids</span><span class="p">,</span>
        <span class="s1">&#39;objectID&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">([</span><span class="s1">&#39;object_id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="n">colors</span>
    <span class="p">}</span>

    <span class="n">df_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">plot_data</span><span class="p">)</span>        


    <span class="c1"># Create the plot</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">font</span><span class="o">=</span><span class="s1">&#39;serif&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">BWS_lines</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>         

        <span class="n">df_BWS</span> <span class="o">=</span> <span class="n">df_data</span><span class="p">[</span><span class="n">df_data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;BWS&#39;</span><span class="p">]</span>
        <span class="n">df_data</span> <span class="o">=</span> <span class="n">df_data</span><span class="p">[</span><span class="n">df_data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;BWS&#39;</span><span class="p">]</span>
        <span class="n">object_ids</span> <span class="o">=</span> <span class="n">df_data</span><span class="p">[</span><span class="s1">&#39;objectID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

        <span class="n">ls_dic</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;BW1&#39;</span><span class="p">:</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;BW2&#39;</span><span class="p">:</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="s1">&#39;BW3&#39;</span><span class="p">:</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span><span class="s1">&#39;BW4&#39;</span><span class="p">:</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;BWS0028&#39;</span><span class="p">:</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;BWS0029&#39;</span><span class="p">:</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="s1">&#39;BWS0030&#39;</span><span class="p">:</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span><span class="s1">&#39;BWS0031&#39;</span><span class="p">:</span><span class="s1">&#39;:&#39;</span><span class="p">}</span>

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_BWS</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">data_BWS</span> <span class="o">=</span> <span class="n">df_BWS</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">data_BWS</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span><span class="n">ls_dic</span><span class="p">[</span><span class="n">data_BWS</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]],</span> <span class="n">label</span><span class="o">=</span><span class="n">data_BWS</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axhspan</span><span class="p">(</span><span class="n">ymin</span><span class="o">=</span><span class="n">data_BWS</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">data_BWS</span><span class="p">[</span><span class="s1">&#39;y_std&#39;</span><span class="p">],</span> <span class="n">ymax</span><span class="o">=</span><span class="n">data_BWS</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">data_BWS</span><span class="p">[</span><span class="s1">&#39;y_std&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.75&#39;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>        


    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">df_data</span><span class="p">))</span>


    <span class="k">if</span> <span class="n">colors</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">df_data</span><span class="p">[</span><span class="s1">&#39;colors&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">group_objects</span><span class="p">:</span> 
        <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">df_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">yerr</span><span class="o">=</span><span class="n">df_data</span><span class="p">[</span><span class="s1">&#39;y_std&#39;</span><span class="p">],</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">x_ticks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>


        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">object_ids</span><span class="p">)):</span>

            <span class="n">df_obj</span> <span class="o">=</span> <span class="n">df_data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;objectID == &quot;</span><span class="si">{</span><span class="n">obj</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>


            <span class="n">y_values</span> <span class="o">=</span> <span class="n">df_obj</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">meas_ids</span> <span class="o">=</span> <span class="n">df_obj</span><span class="p">[</span><span class="s1">&#39;xlabels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">srgb_values</span> <span class="o">=</span> <span class="n">df_obj</span><span class="p">[</span><span class="s1">&#39;colors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

            <span class="n">labels_obj</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">meas_ids</span><span class="p">)</span>    
            <span class="n">obj_tick</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="n">N</span><span class="p">))[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">N</span><span class="p">))</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">ID</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">srgb</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">meas_ids</span><span class="p">,</span> <span class="n">y_values</span><span class="p">,</span> <span class="n">srgb_values</span><span class="p">):</span>

                <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">srgb</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>

                <span class="n">labels_obj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ID</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]))</span>
                <span class="n">x_ticks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>


            <span class="n">labels_obj</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">((</span><span class="n">obj_tick</span><span class="p">),</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">obj_tick</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">obj</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span> <span class="n">labels_obj</span><span class="p">))</span>

            <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">labels_obj</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">])</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>    
            <span class="n">x_ticks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

        <span class="c1"># Define the labels for x-axis ticks</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">xs</span> <span class="ow">in</span> <span class="n">labels</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">]</span>

        <span class="c1"># Set the x-ticks and xlabels</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x_ticks</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>

        <span class="c1"># Display the legend</span>
        <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
        <span class="n">unique</span> <span class="o">=</span> <span class="p">[(</span><span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="p">))</span> <span class="k">if</span> <span class="n">l</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">[:</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="o">*</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">unique</span><span class="p">),</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>




    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span> <span class="c1"># horizontal lines only</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Microfading analyses numbers&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">labels_eq</span><span class="p">[</span><span class="n">coordinate</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>


    <span class="c1">#ax.set_xticks(x)</span>
    <span class="c1">#ax.set_xticklabels(df_data[&#39;xlabels&#39;], rotation=rotate_xlabels, ha=position_xlabels)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">position_text</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">position_text</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Light dose = </span><span class="si">{</span><span class="n">dose_value</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">doses_dic</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">BWS_lines</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">save</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">path_fig</span> <span class="o">==</span> <span class="s1">&#39;cwd&#39;</span><span class="p">:</span>
            <span class="n">path_fig</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">coordinate</span><span class="si">}</span><span class="s1">-bar.png&#39;</span>                    

        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">path_fig</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span> 

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>     
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.plot_delta" class="doc doc-heading">
            <code class=" language-python"><span class="n">plot_delta</span><span class="p">(</span><span class="n">stds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">coordinates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dE00&#39;</span><span class="p">],</span> <span class="n">dose_unit</span><span class="o">=</span><span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">legend_labels</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">initial_values</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">legend_fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">legend_title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">path_fig</span><span class="o">=</span><span class="s1">&#39;cwd&#39;</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.plot_delta" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Plot the delta values of choosen colorimetric coordinates related to the microfading analyses.</p>
<h5 id="microfading.microfading.MFT.plot_delta--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.plot_delta--parameters" title="Permanent link">&para;</a></h5>
<p>stds : bool, optional
    Whether to show the standard deviation values if any, by default True.</p>


<details class="coordinates-" open>
  <summary>list, optional</summary>
  <p>List of colorimetric coordinates, by default ['dE00']
Any of the following coordinates can be added to the list: 'dE76', 'dE00', 'dR_vis' , 'L<em>', 'a</em>', 'b<em>', 'C</em>', 'h'.</p>
</details>

<details class="dose_unit-" open>
  <summary>str, optional</summary>
  <p>Unit of the light energy dose, by default 'He'
Any of the following units can be used: 'He', 'Hv', 't'. Where 'He' corresponds to radiant energy (MJ/m2), 'Hv' to exposure dose (Mlxh), and 't' to times (sec)</p>
</details>

<details class="legend_labels-" open>
  <summary>Union[str, list], optional</summary>
  <p>A list of labels respective to each element given in the data parameter that will be shown in the legend. When the list is empty there is no legend displayed, by default 'default'
When 'default', each label will composed of the Id number of the number followed by a short description</p>
</details>

<details class="colors-" open>
  <summary>Union[str, list], optional</summary>
  <p>Define the colors of the curves, by default None
When 'sample', the color of each line will be based on srgb values computed from the reflectance values. Alternatively, a single string value can be used to define the color (see matplotlib colour values) and will be applied to all the lines. Or a list of matplotlib colour values can be used. With a single coordinate, the list should have the same length as measurement files. With multiple coordinates, the list should have the same length as coordinates.</p>
</details>

<details class="lw-" open>
  <summary>Union[int,list], optional</summary>
  <p>Width of the lines, by default 'default'
When 'default', it attributes a given a width according to each coordinates, otherwise it gives a value of 2.
A single value (an integer) can be entered and applied to all the lines.
A list of integers can also be entered. With a single coordinate, the list should have the same length as measurement files. With multiple coordinates, the list should have the same length as coordinates.</p>
</details>

<details class="title-" open>
  <summary>str, optional</summary>
  <p>Whether to add a title to the plot, by default None</p>
</details>

<details class="fontsize-" open>
  <summary>int, optional</summary>
  <p>Fontsize of the plot (title, ticks, and labels), by default 24</p>
</details>

<details class="legend_fontsize-" open>
  <summary>int, optional</summary>
  <p>Fontsize of the legend, by default 24</p>
</details>

<details class="legend_title-" open>
  <summary>str, optional</summary>
  <p>Add a title above the legend, by default ''</p>
</details>

<details class="xlim-" open>
  <summary>tuple, optional</summary>
  <p>A tuple of two integers that define the left and right limits of the x-axis , by default None.</p>
</details>

<details class="save-" open>
  <summary>bool, optional</summary>
  <p>Whether to save the figure, by default False</p>
</details>

<details class="path_fig-" open>
  <summary>str, optional</summary>
  <p>Absolute path required to save the figure, by default 'cwd'
When 'cwd', it will save the figure in the current working directory.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2763</span>
<span class="normal">2764</span>
<span class="normal">2765</span>
<span class="normal">2766</span>
<span class="normal">2767</span>
<span class="normal">2768</span>
<span class="normal">2769</span>
<span class="normal">2770</span>
<span class="normal">2771</span>
<span class="normal">2772</span>
<span class="normal">2773</span>
<span class="normal">2774</span>
<span class="normal">2775</span>
<span class="normal">2776</span>
<span class="normal">2777</span>
<span class="normal">2778</span>
<span class="normal">2779</span>
<span class="normal">2780</span>
<span class="normal">2781</span>
<span class="normal">2782</span>
<span class="normal">2783</span>
<span class="normal">2784</span>
<span class="normal">2785</span>
<span class="normal">2786</span>
<span class="normal">2787</span>
<span class="normal">2788</span>
<span class="normal">2789</span>
<span class="normal">2790</span>
<span class="normal">2791</span>
<span class="normal">2792</span>
<span class="normal">2793</span>
<span class="normal">2794</span>
<span class="normal">2795</span>
<span class="normal">2796</span>
<span class="normal">2797</span>
<span class="normal">2798</span>
<span class="normal">2799</span>
<span class="normal">2800</span>
<span class="normal">2801</span>
<span class="normal">2802</span>
<span class="normal">2803</span>
<span class="normal">2804</span>
<span class="normal">2805</span>
<span class="normal">2806</span>
<span class="normal">2807</span>
<span class="normal">2808</span>
<span class="normal">2809</span>
<span class="normal">2810</span>
<span class="normal">2811</span>
<span class="normal">2812</span>
<span class="normal">2813</span>
<span class="normal">2814</span>
<span class="normal">2815</span>
<span class="normal">2816</span>
<span class="normal">2817</span>
<span class="normal">2818</span>
<span class="normal">2819</span>
<span class="normal">2820</span>
<span class="normal">2821</span>
<span class="normal">2822</span>
<span class="normal">2823</span>
<span class="normal">2824</span>
<span class="normal">2825</span>
<span class="normal">2826</span>
<span class="normal">2827</span>
<span class="normal">2828</span>
<span class="normal">2829</span>
<span class="normal">2830</span>
<span class="normal">2831</span>
<span class="normal">2832</span>
<span class="normal">2833</span>
<span class="normal">2834</span>
<span class="normal">2835</span>
<span class="normal">2836</span>
<span class="normal">2837</span>
<span class="normal">2838</span>
<span class="normal">2839</span>
<span class="normal">2840</span>
<span class="normal">2841</span>
<span class="normal">2842</span>
<span class="normal">2843</span>
<span class="normal">2844</span>
<span class="normal">2845</span>
<span class="normal">2846</span>
<span class="normal">2847</span>
<span class="normal">2848</span>
<span class="normal">2849</span>
<span class="normal">2850</span>
<span class="normal">2851</span>
<span class="normal">2852</span>
<span class="normal">2853</span>
<span class="normal">2854</span>
<span class="normal">2855</span>
<span class="normal">2856</span>
<span class="normal">2857</span>
<span class="normal">2858</span>
<span class="normal">2859</span>
<span class="normal">2860</span>
<span class="normal">2861</span>
<span class="normal">2862</span>
<span class="normal">2863</span>
<span class="normal">2864</span>
<span class="normal">2865</span>
<span class="normal">2866</span>
<span class="normal">2867</span>
<span class="normal">2868</span>
<span class="normal">2869</span>
<span class="normal">2870</span>
<span class="normal">2871</span>
<span class="normal">2872</span>
<span class="normal">2873</span>
<span class="normal">2874</span>
<span class="normal">2875</span>
<span class="normal">2876</span>
<span class="normal">2877</span>
<span class="normal">2878</span>
<span class="normal">2879</span>
<span class="normal">2880</span>
<span class="normal">2881</span>
<span class="normal">2882</span>
<span class="normal">2883</span>
<span class="normal">2884</span>
<span class="normal">2885</span>
<span class="normal">2886</span>
<span class="normal">2887</span>
<span class="normal">2888</span>
<span class="normal">2889</span>
<span class="normal">2890</span>
<span class="normal">2891</span>
<span class="normal">2892</span>
<span class="normal">2893</span>
<span class="normal">2894</span>
<span class="normal">2895</span>
<span class="normal">2896</span>
<span class="normal">2897</span>
<span class="normal">2898</span>
<span class="normal">2899</span>
<span class="normal">2900</span>
<span class="normal">2901</span>
<span class="normal">2902</span>
<span class="normal">2903</span>
<span class="normal">2904</span>
<span class="normal">2905</span>
<span class="normal">2906</span>
<span class="normal">2907</span>
<span class="normal">2908</span>
<span class="normal">2909</span>
<span class="normal">2910</span>
<span class="normal">2911</span>
<span class="normal">2912</span>
<span class="normal">2913</span>
<span class="normal">2914</span>
<span class="normal">2915</span>
<span class="normal">2916</span>
<span class="normal">2917</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_delta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stds</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dE00&#39;</span><span class="p">],</span> <span class="n">dose_unit</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">legend_labels</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">initial_values</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">figsize</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">9</span><span class="p">),</span> <span class="n">colors</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">lw</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span> <span class="n">legend_fontsize</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span> <span class="n">legend_title</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xlim</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">save</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">path_fig</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;cwd&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot the delta values of choosen colorimetric coordinates related to the microfading analyses.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    stds : bool, optional</span>
<span class="sd">        Whether to show the standard deviation values if any, by default True.</span>

<span class="sd">    coordinates : list, optional</span>
<span class="sd">        List of colorimetric coordinates, by default [&#39;dE00&#39;]</span>
<span class="sd">        Any of the following coordinates can be added to the list: &#39;dE76&#39;, &#39;dE00&#39;, &#39;dR_vis&#39; , &#39;L*&#39;, &#39;a*&#39;, &#39;b*&#39;, &#39;C*&#39;, &#39;h&#39;.</span>

<span class="sd">    dose_unit : str, optional</span>
<span class="sd">        Unit of the light energy dose, by default &#39;He&#39;</span>
<span class="sd">        Any of the following units can be used: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec)</span>

<span class="sd">    legend_labels : Union[str, list], optional</span>
<span class="sd">        A list of labels respective to each element given in the data parameter that will be shown in the legend. When the list is empty there is no legend displayed, by default &#39;default&#39;</span>
<span class="sd">        When &#39;default&#39;, each label will composed of the Id number of the number followed by a short description</span>

<span class="sd">    colors : Union[str, list], optional</span>
<span class="sd">        Define the colors of the curves, by default None</span>
<span class="sd">        When &#39;sample&#39;, the color of each line will be based on srgb values computed from the reflectance values. Alternatively, a single string value can be used to define the color (see matplotlib colour values) and will be applied to all the lines. Or a list of matplotlib colour values can be used. With a single coordinate, the list should have the same length as measurement files. With multiple coordinates, the list should have the same length as coordinates.</span>

<span class="sd">    lw : Union[int,list], optional</span>
<span class="sd">        Width of the lines, by default &#39;default&#39;</span>
<span class="sd">        When &#39;default&#39;, it attributes a given a width according to each coordinates, otherwise it gives a value of 2.</span>
<span class="sd">        A single value (an integer) can be entered and applied to all the lines.</span>
<span class="sd">        A list of integers can also be entered. With a single coordinate, the list should have the same length as measurement files. With multiple coordinates, the list should have the same length as coordinates.</span>

<span class="sd">    title : str, optional</span>
<span class="sd">        Whether to add a title to the plot, by default None</span>

<span class="sd">    fontsize : int, optional</span>
<span class="sd">        Fontsize of the plot (title, ticks, and labels), by default 24</span>

<span class="sd">    legend_fontsize : int, optional</span>
<span class="sd">        Fontsize of the legend, by default 24</span>

<span class="sd">    legend_title : str, optional</span>
<span class="sd">        Add a title above the legend, by default &#39;&#39;</span>

<span class="sd">    xlim : tuple, optional</span>
<span class="sd">        A tuple of two integers that define the left and right limits of the x-axis , by default None.</span>

<span class="sd">    save : bool, optional</span>
<span class="sd">        Whether to save the figure, by default False</span>

<span class="sd">    path_fig : str, optional</span>
<span class="sd">        Absolute path required to save the figure, by default &#39;cwd&#39;</span>
<span class="sd">        When &#39;cwd&#39;, it will save the figure in the current working directory.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Retrieve the data</span>
    <span class="k">if</span> <span class="n">xlim</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dose_values</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xlim</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="n">dose_values</span> <span class="o">=</span> <span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.05</span><span class="p">)</span>

    <span class="n">all_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_delta</span><span class="p">(</span><span class="n">coordinates</span><span class="o">=</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span> <span class="n">dose_values</span><span class="o">=</span><span class="n">dose_values</span><span class="p">)</span>
    <span class="n">nominal_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">stdev_data</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">all_data</span><span class="p">:</span>

        <span class="k">if</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">]:</span>
            <span class="n">nominal</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">stds</span><span class="p">:</span>
                <span class="n">stdev</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>   
            <span class="k">else</span><span class="p">:</span>
                <span class="n">stdev</span> <span class="o">=</span> <span class="n">nominal</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>   
                <span class="n">stdev</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:]</span> <span class="o">=</span> <span class="mi">0</span>         

        <span class="k">else</span><span class="p">:</span>

            <span class="n">nominal</span> <span class="o">=</span> <span class="n">data</span>
            <span class="n">stdev</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">stdev</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:]</span> <span class="o">=</span> <span class="mi">0</span>


        <span class="n">nominal_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nominal</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="n">stdev_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stdev</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>



    <span class="c1"># Retrieve the metadata</span>
    <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()</span>
    <span class="n">ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_meas_ids</span><span class="p">]</span>
    <span class="n">meas_nbs</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">]</span>

    <span class="k">if</span> <span class="s1">&#39;spot_description&#39;</span> <span class="ow">in</span> <span class="n">info</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>                
        <span class="n">group_descriptions</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;spot_description&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">group_descriptions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>


    <span class="c1"># Set the labels values</span>
    <span class="k">if</span> <span class="n">legend_labels</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>                       
        <span class="n">legend_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ids</span><span class="p">,</span> <span class="n">group_descriptions</span><span class="p">)]</span> 

    <span class="k">elif</span> <span class="n">legend_labels</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="n">legend_labels</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">legend_labels</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">legend_labels</span> <span class="o">=</span> <span class="n">legend_labels</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        labels_list = []</span>
<span class="sd">        for i,Id in enumerate(self.get_meas_ids):</span>
<span class="sd">            label = Id.split(&#39;.&#39;)[-1]</span>
<span class="sd">            for el in labels:</span>
<span class="sd">                label = label + f&#39;-{self.get_metadata().loc[el].values[i]}&#39;</span>
<span class="sd">            labels_list.append(label)</span>

<span class="sd">        labels = labels_list</span>
<span class="sd">        &#39;&#39;&#39;</span>

    <span class="c1"># Add the initial values of the colorimetric coordinates</span>

    <span class="k">if</span> <span class="n">initial_values</span><span class="p">:</span>  
        <span class="n">initial_values</span> <span class="o">=</span> <span class="p">{}</span>          
        <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">coordinates</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">coord</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;dL*&#39;</span><span class="p">,</span> <span class="s1">&#39;da*&#39;</span><span class="p">,</span> <span class="s1">&#39;db*&#39;</span><span class="p">,</span> <span class="s1">&#39;dC*&#39;</span><span class="p">,</span> <span class="s1">&#39;dh&#39;</span><span class="p">]:</span>
                <span class="n">initial_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cielab</span><span class="p">(</span><span class="n">coordinates</span><span class="o">=</span><span class="p">[</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">:]])[</span><span class="mi">0</span><span class="p">][</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">initial_values</span><span class="p">[</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span> <span class="o">=</span> <span class="n">initial_value</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">initial_values</span> <span class="o">=</span> <span class="p">{}</span>  

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">meas_nbs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">initial_values</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Set the color of the lines according to the sample</span>
    <span class="k">if</span> <span class="n">colors</span> <span class="o">==</span> <span class="s1">&#39;sample&#39;</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_sRGB</span><span class="p">(</span><span class="n">dose_values</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">meas_nbs</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">colors</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>

    <span class="c1"># Whether to add a title or not</span>
    <span class="k">if</span> <span class="n">title</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;MFT&#39;</span>            
    <span class="k">elif</span> <span class="n">title</span> <span class="o">==</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">title</span> 

    <span class="c1"># Define the saving folder in case the figure should be saved</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">path_fig</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
            <span class="n">path_fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dir</span><span class="p">(</span><span class="n">folder_type</span><span class="o">=</span><span class="s1">&#39;figures&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">filename</span>                

        <span class="k">if</span> <span class="n">path_fig</span> <span class="o">==</span> <span class="s1">&#39;cwd&#39;</span><span class="p">:</span>
            <span class="n">path_fig</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">&#39;</span> 


    <span class="n">plotting</span><span class="o">.</span><span class="n">delta</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">nominal_data</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">stdev_data</span><span class="p">,</span> <span class="n">dose_unit</span><span class="o">=</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">],</span> <span class="n">coordinates</span><span class="o">=</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">initial_values</span><span class="o">=</span><span class="n">initial_values</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">legend_labels</span><span class="o">=</span><span class="n">legend_labels</span><span class="p">,</span> <span class="n">legend_fontsize</span><span class="o">=</span><span class="n">legend_fontsize</span><span class="p">,</span> <span class="n">legend_title</span><span class="o">=</span><span class="n">legend_title</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span> <span class="n">path_fig</span><span class="o">=</span><span class="n">path_fig</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.plot_sp" class="doc doc-heading">
            <code class=" language-python"><span class="n">plot_sp</span><span class="p">(</span><span class="n">stdev</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">spectra</span><span class="o">=</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">dose_unit</span><span class="o">=</span><span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">dose_values</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">spectral_mode</span><span class="o">=</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="n">legend_labels</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">fontsize_legend</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">legend_title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">wl_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">text_xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">),</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">path_fig</span><span class="o">=</span><span class="s1">&#39;cwd&#39;</span><span class="p">,</span> <span class="n">derivation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">smoothing</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">report</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.plot_sp" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Plot the reflectance spectra corresponding to the associated microfading analyses.</p>
<h5 id="microfading.microfading.MFT.plot_sp--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.plot_sp--parameters" title="Permanent link">&para;</a></h5>
<p>stdev : bool, optional
    Whether to show the standard deviation values, by default False</p>


<details class="spectra-" open>
  <summary>Optional[str], optional</summary>
  <p>Define which spectra to display, by default 'i'
'i' for initial spectral, 
'f' for final spectra,
'i+f' for initial and final spectra, 
'all' for all the spectra, 
'doses' for spectra at different dose values indicated by the dose_unit and dose_values parameters</p>
</details>

<details class="dose_unit-" open>
  <summary>str, optional</summary>
  <p>Unit of the light energy dose, by default 'He'
Any of the following units can be used: 'He', 'Hv', 't'. Where 'He' corresponds to radiant energy (MJ/m2), 'Hv' to exposure dose (Mlxh), and 't' to times (sec). It only works if the 'spectra' parameters has been set to 'doses'.</p>
</details>

<details class="dose_values-" open>
  <summary>Union[int, float, list, tuple], optional</summary>
  <p>Values of the light dose energy, by default 'all'
A single value (integer or float number), a list of multiple numerical values, or range values with a tuple (start, end, step) can be entered.
When 'all', it takes the values found in the data. It only works if the 'spectra' parameters has been set to 'doses'.</p>
</details>

<details class="spectral_mode-" open>
  <summary>string, optional</summary>
  <p>When 'R', it returns the reflectance spectra          <br />
When 'A', it returns the absorption spectra using the following equation: A = -log(R)</p>
</details>

<details class="legend_labels-" open>
  <summary>Union[str, list], optional</summary>
  <p>A list of labels respective to each element given in the data parameter that will be shown in the legend. When the list is empty there is no legend displayed, by default 'default'
When 'default', each label will composed of the Id number of the number followed by a short description</p>
</details>

<details class="title-" open>
  <summary>str, optional</summary>
  <p>Whether to add a title to the plot, by default None</p>
</details>

<details class="fontsize-" open>
  <summary>int, optional</summary>
  <p>Fontsize of the plot (title, ticks, and labels), by default 24</p>
</details>

<details class="fontsize_legend-" open>
  <summary>int, optional</summary>
  <p>Fontsize of the legend, by default 24</p>
</details>

<details class="legend_title-" open>
  <summary>str, optional</summary>
  <p>Add a title above the legend, by default ''</p>
</details>

<details class="wl_range-" open>
  <summary>tuple, optional</summary>
  <p>Define the wavelength range with a two-values tuple corresponding to the lowest and highest wavelength values, by default None</p>
</details>

<details class="colors-" open>
  <summary>Union[str, list], optional</summary>
  <p>Define the colors of the reflectance curves, by default None
When 'sample', the color of each line will be based on srgb values computed from the reflectance values. Alternatively, a single string value can be used to define the color (see matplotlib colour values) or a list of matplotlib colour values can be used. </p>
</details>

<details class="lw-" open>
  <summary>Union[int, list], optional</summary>
  <p>Define the width of the plot lines, by default 2
It can be a single integer value that will apply to all the curves. Or a list of integers can be used where the number of integer elements should match the number of reflectance curves.</p>
</details>

<details class="ls-" open>
  <summary>Union[str, list], optional</summary>
  <p>Define the line style of the plot lines, by default '-'
It can be a string ('-', '--', ':', '-.') that will apply to all the curves. Or a list of string can be used where the number of string elements should match the number of reflectance curves.</p>
</details>

<details class="save-" open>
  <summary>bool, optional</summary>
  <p>Whether to save the figure, by default False</p>
</details>

<details class="path_fig-" open>
  <summary>str, optional</summary>
  <p>Absolute path required to save the figure, by default 'cwd'
When 'cwd', it will save the figure in the current working directory.</p>
</details>

<details class="derivation-" open>
  <summary>bool, optional</summary>
  <p>Wether to compute and display the first derivative values of the spectra, by default False</p>
</details>

<details class="smooth-" open>
  <summary>bool, optional</summary>
  <p>Whether to smooth the reflectance curves, by default False</p>
</details>

<details class="smooth_params-" open>
  <summary>list, optional</summary>
  <p>Parameters related to the Savitzky-Golay filter, by default [10,1]
Enter a list of two integers where the first value corresponds to the window_length and the second to the polyorder value. </p>
</details>

<details class="report-" open>
  <summary>Optional[bool], optional</summary>
  <p>Configure some aspects of the figure for use in a report, by default False</p>
</details>        <h5 id="microfading.microfading.MFT.plot_sp--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.plot_sp--returns" title="Permanent link">&para;</a></h5>
<p><em>type</em>
    It returns a figure that can be save as a png file.</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2920</span>
<span class="normal">2921</span>
<span class="normal">2922</span>
<span class="normal">2923</span>
<span class="normal">2924</span>
<span class="normal">2925</span>
<span class="normal">2926</span>
<span class="normal">2927</span>
<span class="normal">2928</span>
<span class="normal">2929</span>
<span class="normal">2930</span>
<span class="normal">2931</span>
<span class="normal">2932</span>
<span class="normal">2933</span>
<span class="normal">2934</span>
<span class="normal">2935</span>
<span class="normal">2936</span>
<span class="normal">2937</span>
<span class="normal">2938</span>
<span class="normal">2939</span>
<span class="normal">2940</span>
<span class="normal">2941</span>
<span class="normal">2942</span>
<span class="normal">2943</span>
<span class="normal">2944</span>
<span class="normal">2945</span>
<span class="normal">2946</span>
<span class="normal">2947</span>
<span class="normal">2948</span>
<span class="normal">2949</span>
<span class="normal">2950</span>
<span class="normal">2951</span>
<span class="normal">2952</span>
<span class="normal">2953</span>
<span class="normal">2954</span>
<span class="normal">2955</span>
<span class="normal">2956</span>
<span class="normal">2957</span>
<span class="normal">2958</span>
<span class="normal">2959</span>
<span class="normal">2960</span>
<span class="normal">2961</span>
<span class="normal">2962</span>
<span class="normal">2963</span>
<span class="normal">2964</span>
<span class="normal">2965</span>
<span class="normal">2966</span>
<span class="normal">2967</span>
<span class="normal">2968</span>
<span class="normal">2969</span>
<span class="normal">2970</span>
<span class="normal">2971</span>
<span class="normal">2972</span>
<span class="normal">2973</span>
<span class="normal">2974</span>
<span class="normal">2975</span>
<span class="normal">2976</span>
<span class="normal">2977</span>
<span class="normal">2978</span>
<span class="normal">2979</span>
<span class="normal">2980</span>
<span class="normal">2981</span>
<span class="normal">2982</span>
<span class="normal">2983</span>
<span class="normal">2984</span>
<span class="normal">2985</span>
<span class="normal">2986</span>
<span class="normal">2987</span>
<span class="normal">2988</span>
<span class="normal">2989</span>
<span class="normal">2990</span>
<span class="normal">2991</span>
<span class="normal">2992</span>
<span class="normal">2993</span>
<span class="normal">2994</span>
<span class="normal">2995</span>
<span class="normal">2996</span>
<span class="normal">2997</span>
<span class="normal">2998</span>
<span class="normal">2999</span>
<span class="normal">3000</span>
<span class="normal">3001</span>
<span class="normal">3002</span>
<span class="normal">3003</span>
<span class="normal">3004</span>
<span class="normal">3005</span>
<span class="normal">3006</span>
<span class="normal">3007</span>
<span class="normal">3008</span>
<span class="normal">3009</span>
<span class="normal">3010</span>
<span class="normal">3011</span>
<span class="normal">3012</span>
<span class="normal">3013</span>
<span class="normal">3014</span>
<span class="normal">3015</span>
<span class="normal">3016</span>
<span class="normal">3017</span>
<span class="normal">3018</span>
<span class="normal">3019</span>
<span class="normal">3020</span>
<span class="normal">3021</span>
<span class="normal">3022</span>
<span class="normal">3023</span>
<span class="normal">3024</span>
<span class="normal">3025</span>
<span class="normal">3026</span>
<span class="normal">3027</span>
<span class="normal">3028</span>
<span class="normal">3029</span>
<span class="normal">3030</span>
<span class="normal">3031</span>
<span class="normal">3032</span>
<span class="normal">3033</span>
<span class="normal">3034</span>
<span class="normal">3035</span>
<span class="normal">3036</span>
<span class="normal">3037</span>
<span class="normal">3038</span>
<span class="normal">3039</span>
<span class="normal">3040</span>
<span class="normal">3041</span>
<span class="normal">3042</span>
<span class="normal">3043</span>
<span class="normal">3044</span>
<span class="normal">3045</span>
<span class="normal">3046</span>
<span class="normal">3047</span>
<span class="normal">3048</span>
<span class="normal">3049</span>
<span class="normal">3050</span>
<span class="normal">3051</span>
<span class="normal">3052</span>
<span class="normal">3053</span>
<span class="normal">3054</span>
<span class="normal">3055</span>
<span class="normal">3056</span>
<span class="normal">3057</span>
<span class="normal">3058</span>
<span class="normal">3059</span>
<span class="normal">3060</span>
<span class="normal">3061</span>
<span class="normal">3062</span>
<span class="normal">3063</span>
<span class="normal">3064</span>
<span class="normal">3065</span>
<span class="normal">3066</span>
<span class="normal">3067</span>
<span class="normal">3068</span>
<span class="normal">3069</span>
<span class="normal">3070</span>
<span class="normal">3071</span>
<span class="normal">3072</span>
<span class="normal">3073</span>
<span class="normal">3074</span>
<span class="normal">3075</span>
<span class="normal">3076</span>
<span class="normal">3077</span>
<span class="normal">3078</span>
<span class="normal">3079</span>
<span class="normal">3080</span>
<span class="normal">3081</span>
<span class="normal">3082</span>
<span class="normal">3083</span>
<span class="normal">3084</span>
<span class="normal">3085</span>
<span class="normal">3086</span>
<span class="normal">3087</span>
<span class="normal">3088</span>
<span class="normal">3089</span>
<span class="normal">3090</span>
<span class="normal">3091</span>
<span class="normal">3092</span>
<span class="normal">3093</span>
<span class="normal">3094</span>
<span class="normal">3095</span>
<span class="normal">3096</span>
<span class="normal">3097</span>
<span class="normal">3098</span>
<span class="normal">3099</span>
<span class="normal">3100</span>
<span class="normal">3101</span>
<span class="normal">3102</span>
<span class="normal">3103</span>
<span class="normal">3104</span>
<span class="normal">3105</span>
<span class="normal">3106</span>
<span class="normal">3107</span>
<span class="normal">3108</span>
<span class="normal">3109</span>
<span class="normal">3110</span>
<span class="normal">3111</span>
<span class="normal">3112</span>
<span class="normal">3113</span>
<span class="normal">3114</span>
<span class="normal">3115</span>
<span class="normal">3116</span>
<span class="normal">3117</span>
<span class="normal">3118</span>
<span class="normal">3119</span>
<span class="normal">3120</span>
<span class="normal">3121</span>
<span class="normal">3122</span>
<span class="normal">3123</span>
<span class="normal">3124</span>
<span class="normal">3125</span>
<span class="normal">3126</span>
<span class="normal">3127</span>
<span class="normal">3128</span>
<span class="normal">3129</span>
<span class="normal">3130</span>
<span class="normal">3131</span>
<span class="normal">3132</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_sp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stdev</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">spectra</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">dose_unit</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">dose_values</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">spectral_mode</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="n">legend_labels</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span> <span class="n">fontsize_legend</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span> <span class="n">legend_title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">wl_range</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">colors</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">lw</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">text_xy</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.02</span><span class="p">,</span><span class="mf">0.03</span><span class="p">),</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">path_fig</span><span class="o">=</span><span class="s1">&#39;cwd&#39;</span><span class="p">,</span> <span class="n">derivation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">smoothing</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">report</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot the reflectance spectra corresponding to the associated microfading analyses.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    stdev : bool, optional</span>
<span class="sd">        Whether to show the standard deviation values, by default False</span>

<span class="sd">    spectra : Optional[str], optional</span>
<span class="sd">        Define which spectra to display, by default &#39;i&#39;</span>
<span class="sd">        &#39;i&#39; for initial spectral, </span>
<span class="sd">        &#39;f&#39; for final spectra,</span>
<span class="sd">        &#39;i+f&#39; for initial and final spectra, </span>
<span class="sd">        &#39;all&#39; for all the spectra, </span>
<span class="sd">        &#39;doses&#39; for spectra at different dose values indicated by the dose_unit and dose_values parameters</span>

<span class="sd">    dose_unit : str, optional</span>
<span class="sd">        Unit of the light energy dose, by default &#39;He&#39;</span>
<span class="sd">        Any of the following units can be used: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec). It only works if the &#39;spectra&#39; parameters has been set to &#39;doses&#39;.</span>

<span class="sd">    dose_values : Union[int, float, list, tuple], optional</span>
<span class="sd">        Values of the light dose energy, by default &#39;all&#39;</span>
<span class="sd">        A single value (integer or float number), a list of multiple numerical values, or range values with a tuple (start, end, step) can be entered.</span>
<span class="sd">        When &#39;all&#39;, it takes the values found in the data. It only works if the &#39;spectra&#39; parameters has been set to &#39;doses&#39;.</span>

<span class="sd">    spectral_mode : string, optional</span>
<span class="sd">        When &#39;R&#39;, it returns the reflectance spectra            </span>
<span class="sd">        When &#39;A&#39;, it returns the absorption spectra using the following equation: A = -log(R)</span>

<span class="sd">    legend_labels : Union[str, list], optional</span>
<span class="sd">        A list of labels respective to each element given in the data parameter that will be shown in the legend. When the list is empty there is no legend displayed, by default &#39;default&#39;</span>
<span class="sd">        When &#39;default&#39;, each label will composed of the Id number of the number followed by a short description</span>

<span class="sd">    title : str, optional</span>
<span class="sd">        Whether to add a title to the plot, by default None</span>

<span class="sd">    fontsize : int, optional</span>
<span class="sd">        Fontsize of the plot (title, ticks, and labels), by default 24</span>

<span class="sd">    fontsize_legend : int, optional</span>
<span class="sd">        Fontsize of the legend, by default 24</span>

<span class="sd">    legend_title : str, optional</span>
<span class="sd">        Add a title above the legend, by default &#39;&#39;</span>

<span class="sd">    wl_range : tuple, optional</span>
<span class="sd">        Define the wavelength range with a two-values tuple corresponding to the lowest and highest wavelength values, by default None</span>

<span class="sd">    colors : Union[str, list], optional</span>
<span class="sd">        Define the colors of the reflectance curves, by default None</span>
<span class="sd">        When &#39;sample&#39;, the color of each line will be based on srgb values computed from the reflectance values. Alternatively, a single string value can be used to define the color (see matplotlib colour values) or a list of matplotlib colour values can be used. </span>

<span class="sd">    lw : Union[int, list], optional</span>
<span class="sd">        Define the width of the plot lines, by default 2</span>
<span class="sd">        It can be a single integer value that will apply to all the curves. Or a list of integers can be used where the number of integer elements should match the number of reflectance curves.</span>

<span class="sd">    ls : Union[str, list], optional</span>
<span class="sd">        Define the line style of the plot lines, by default &#39;-&#39;</span>
<span class="sd">        It can be a string (&#39;-&#39;, &#39;--&#39;, &#39;:&#39;, &#39;-.&#39;) that will apply to all the curves. Or a list of string can be used where the number of string elements should match the number of reflectance curves.</span>

<span class="sd">    save : bool, optional</span>
<span class="sd">        Whether to save the figure, by default False</span>

<span class="sd">    path_fig : str, optional</span>
<span class="sd">        Absolute path required to save the figure, by default &#39;cwd&#39;</span>
<span class="sd">        When &#39;cwd&#39;, it will save the figure in the current working directory.</span>

<span class="sd">    derivation : bool, optional</span>
<span class="sd">        Wether to compute and display the first derivative values of the spectra, by default False</span>

<span class="sd">    smooth : bool, optional</span>
<span class="sd">        Whether to smooth the reflectance curves, by default False</span>

<span class="sd">    smooth_params : list, optional</span>
<span class="sd">        Parameters related to the Savitzky-Golay filter, by default [10,1]</span>
<span class="sd">        Enter a list of two integers where the first value corresponds to the window_length and the second to the polyorder value. </span>

<span class="sd">    report : Optional[bool], optional</span>
<span class="sd">        Configure some aspects of the figure for use in a report, by default False</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    _type_</span>
<span class="sd">        It returns a figure that can be save as a png file.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Apply the report characteristics</span>

    <span class="k">if</span> <span class="n">report</span><span class="p">:</span>
        <span class="n">save</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="s1">&#39;sample&#39;</span>
        <span class="n">spectra</span> <span class="o">=</span> <span class="s1">&#39;i+f&#39;</span>
        <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">30</span>

    <span class="c1"># Retrieve the metadata</span>
    <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()</span>

    <span class="k">if</span> <span class="s1">&#39;spot_description&#39;</span> <span class="ow">in</span> <span class="n">info</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>                
        <span class="n">spot_descriptions</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;spot_description&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">spot_descriptions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>


    <span class="c1"># Define the colour of the curves</span>
    <span class="k">if</span> <span class="n">colors</span> <span class="o">==</span> <span class="s1">&#39;sample&#39;</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sRGB</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">colors</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">colors</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>

    <span class="c1"># Define the labels</span>
    <span class="k">if</span> <span class="n">legend_labels</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
        <span class="n">legend_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_meas_ids</span><span class="p">,</span><span class="n">spot_descriptions</span><span class="p">)]</span>
        <span class="n">legend_title</span> <span class="o">=</span> <span class="s1">&#39;Measurement $n^o$&#39;</span>

    <span class="c1"># Select the spectral data</span>
    <span class="k">if</span> <span class="n">spectra</span> <span class="o">==</span> <span class="s1">&#39;i&#39;</span><span class="p">:</span>            
        <span class="n">data_sp_all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_spectra</span><span class="p">(</span><span class="n">wl_range</span><span class="o">=</span><span class="n">wl_range</span><span class="p">,</span> <span class="n">smoothing</span><span class="o">=</span><span class="n">smoothing</span><span class="p">)</span>
        <span class="n">data_sp</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_sp_all</span><span class="p">]</span>            

        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Initial spectra&#39;</span>

    <span class="k">elif</span> <span class="n">spectra</span> <span class="o">==</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span>
        <span class="n">data_sp_all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_spectra</span><span class="p">(</span><span class="n">wl_range</span><span class="o">=</span><span class="n">wl_range</span><span class="p">,</span> <span class="n">smoothing</span><span class="o">=</span><span class="n">smoothing</span><span class="p">)</span>
        <span class="n">data_sp</span> <span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_sp_all</span><span class="p">]</span> 

        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Final spectra&#39;</span>

    <span class="k">elif</span> <span class="n">spectra</span> <span class="o">==</span> <span class="s1">&#39;i+f&#39;</span><span class="p">:</span>
        <span class="n">data_sp_all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_spectra</span><span class="p">(</span><span class="n">wl_range</span><span class="o">=</span><span class="n">wl_range</span><span class="p">,</span> <span class="n">smoothing</span><span class="o">=</span><span class="n">smoothing</span><span class="p">)</span>
        <span class="n">data_sp</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)[[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_sp_all</span><span class="p">]</span>            

        <span class="n">ls</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_sp</span><span class="p">)</span>
        <span class="n">lw</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_sp</span><span class="p">)</span>
        <span class="n">black_lines</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_sp</span><span class="p">)</span>            
        <span class="n">colors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="n">black_lines</span><span class="p">)))</span>            


        <span class="k">if</span> <span class="n">legend_labels</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
            <span class="n">meas_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_meas_ids</span><span class="p">,</span><span class="n">spot_descriptions</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">meas_labels</span> <span class="o">=</span> <span class="n">legend_labels</span>
        <span class="n">none_labels</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">meas_labels</span><span class="p">)</span>
        <span class="n">legend_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">meas_labels</span><span class="p">,</span> <span class="n">none_labels</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">pair</span><span class="p">]</span>

        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Initial and final spectra (black dashed lines)&#39;</span>

    <span class="k">elif</span> <span class="n">spectra</span> <span class="o">==</span> <span class="s1">&#39;doses&#39;</span><span class="p">:</span>
        <span class="n">data_sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_spectra</span><span class="p">(</span><span class="n">wl_range</span><span class="o">=</span><span class="n">wl_range</span><span class="p">,</span> <span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span><span class="n">dose_values</span><span class="o">=</span><span class="n">dose_values</span><span class="p">,</span> <span class="n">smoothing</span><span class="o">=</span><span class="n">smoothing</span><span class="p">)</span>


        <span class="n">dose_units</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;He&#39;</span><span class="p">:</span> <span class="s1">&#39;MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;Hv&#39;</span><span class="p">:</span> <span class="s1">&#39;Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="s1">&#39;sec&#39;</span><span class="p">}</span>
        <span class="n">legend_title</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Light dose values&#39;</span>
        <span class="n">legend_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">dose_units</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dose_values</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_sp</span><span class="p">)</span>

        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="n">ls_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span><span class="s1">&#39;:&#39;</span><span class="p">,]</span>
        <span class="n">ls</span> <span class="o">=</span> <span class="n">ls_list</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">dose_values</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_sp</span><span class="p">)</span>        
        <span class="n">srgb_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sRGB</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>            
        <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">srgb_i</span><span class="p">,</span> <span class="n">data_sp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>          

    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">spectra</span><span class="si">}</span><span class="s1">&quot; is not an adequate value. Enter a value for the parameter &quot;spectra&quot; among the following list: &quot;i&quot;, &quot;f&quot;, &quot;i+f&quot;, &quot;doses&quot;.&#39;</span><span class="p">)</span>
        <span class="k">return</span>           

    <span class="c1"># whether to compute the absorption spectra</span>
    <span class="k">if</span> <span class="n">spectral_mode</span> <span class="o">==</span> <span class="s1">&#39;abs&#39;</span><span class="p">:</span>
        <span class="n">data_sp</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_sp</span><span class="p">]</span>

    <span class="c1"># Reset the index</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_sp</span><span class="p">]</span>

    <span class="c1"># Whether to compute the first derivative</span>
    <span class="k">if</span> <span class="n">derivation</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>

    <span class="c1"># Compile the spectra to plot inside a list</span>
    <span class="n">wanted_data</span> <span class="o">=</span> <span class="p">[]</span>  
    <span class="n">wanted_std</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Set the wavelength column as index</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>          

    <span class="c1"># Add the std values</span>
    <span class="k">if</span> <span class="n">stdev</span><span class="p">:</span>            
        <span class="k">try</span><span class="p">:</span>     

            <span class="n">values_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
            <span class="n">values_wl</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">el1</span><span class="p">,</span> <span class="n">wl</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">values_data</span><span class="p">,</span> <span class="n">values_wl</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">el2</span> <span class="ow">in</span> <span class="n">el1</span><span class="p">:</span>
                    <span class="n">wanted_data</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">wl</span><span class="p">,</span><span class="n">el2</span><span class="p">))</span>

            <span class="n">values_std</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>                
            <span class="k">for</span> <span class="n">el1</span> <span class="ow">in</span> <span class="n">values_std</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">el2</span> <span class="ow">in</span> <span class="n">el1</span><span class="p">:</span>
                    <span class="n">wanted_std</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">el2</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="n">wanted_std</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>                
            <span class="n">data_values</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="n">el</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">el</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
            <span class="n">wanted_data</span> <span class="o">=</span> <span class="n">wanted_data</span> <span class="o">+</span> <span class="n">data_values</span> 
        <span class="n">wanted_std</span> <span class="o">=</span> <span class="p">[]</span>


    <span class="k">return</span> <span class="n">plotting</span><span class="o">.</span><span class="n">spectra</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">wanted_data</span><span class="p">,</span> <span class="n">stds</span><span class="o">=</span><span class="n">wanted_std</span><span class="p">,</span> <span class="n">spectral_mode</span><span class="o">=</span><span class="n">spectral_mode</span><span class="p">,</span> <span class="n">legend_labels</span><span class="o">=</span><span class="n">legend_labels</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">fontsize_legend</span><span class="o">=</span><span class="n">fontsize_legend</span><span class="p">,</span> <span class="n">legend_title</span><span class="o">=</span><span class="n">legend_title</span><span class="p">,</span> <span class="n">x_range</span><span class="o">=</span><span class="n">wl_range</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="n">ls</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">text_xy</span><span class="o">=</span><span class="n">text_xy</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span> <span class="n">path_fig</span><span class="o">=</span><span class="n">path_fig</span><span class="p">,</span> <span class="n">derivation</span><span class="o">=</span><span class="n">derivation</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.plot_swatches_circle" class="doc doc-heading">
            <code class=" language-python"><span class="n">plot_swatches_circle</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">light_doses</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span> <span class="n">JND</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">dose_unit</span><span class="o">=</span><span class="s1">&#39;Hv&#39;</span><span class="p">,</span> <span class="n">dE</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">equation</span><span class="o">=</span><span class="s1">&#39;power_3p&#39;</span><span class="p">,</span> <span class="n">initial_params</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">),</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">path_fig</span><span class="o">=</span><span class="s1">&#39;cwd&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">report</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.plot_swatches_circle" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Plot the microfading data with circular colored patches. </p>
<h5 id="microfading.microfading.MFT.plot_swatches_circle--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.plot_swatches_circle--parameters" title="Permanent link">&para;</a></h5>


<details class="light_doses-" open>
  <summary>list, optional</summary>
  <p>Light doses in Mlxh for which a coloured patches will be created, by default [0,0.5,1,2,5,1]
There has been at least two numerical values in the list. The first value corresponds to the color background of the plot and is usually set to 0. The other values will be plotted as circular patches.</p>
</details>

<details class="jnd-" open>
  <summary>list, optional</summary>
  <p>Whether to plot circular patches of just noticeable differences, by default [1,2,3,5,10]
NOT YET IMPLEMENTED</p>
</details>

<details class="dose_unit-" open>
  <summary>[str, tuple], optional</summary>
  <p>Unit of the light energy dose, by default 'Hv'
Any of the following units can be used: 'He', 'Hv', 't'. Where 'He' corresponds to radiant energy (MJ/m2), 'Hv' to exposure dose (Mlxh), and 't' to times (hours) (exh,50,10,365)</p>
</details>

<details class="de-" open>
  <summary>bool, optional</summary>
  <p>Whether to include the dE00 value between the background and each circular patche, by default True</p>
</details>

<details class="fontsize-" open>
  <summary>int, optional</summary>
  <p>Fontsize of the plot (title, ticks, and labels), by default 24        </p>
</details>

<details class="equation-" open>
  <summary>str, optional</summary>
  <p>Mathematical equation used to fit the coordinate values, by default 'c0<em>(x</em><em>c1) + c2'.
Any others mathematical can be given. The following equation can also be used for fitting microfading data: '((x) / (c0 + (c1</em>x)))'.</p>
</details>

<details class="initial_params-" open>
  <summary>List[float], optional</summary>
  <p>Initial guesses of the 'c' parameters given in the equation (c0, c1, c2, etc.), by default [0.1, 0.0]
In the default values, only c0 and c1 are provided ; c2 is retrieved from the initial value of each colorimetric coordinate plot.</p>
</details>

<details class="save-" open>
  <summary>bool, optional</summary>
  <p>Whether to save the figure, by default False</p>
</details>

<details class="path_fig-" open>
  <summary>str, optional</summary>
  <p>Absolute path required to save the figure, by default 'cwd'
When 'cwd', it will save the figure in the current working directory.</p>
</details>

<details class="title-" open>
  <summary>str, optional</summary>
  <p>Whether to add a title to the plot, by default None, by default None        </p>
</details>

<details class="report-" open>
  <summary>bool, optional</summary>
  <p><em>description</em>, by default False</p>
</details>        <h5 id="microfading.microfading.MFT.plot_swatches_circle--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.plot_swatches_circle--returns" title="Permanent link">&para;</a></h5>
<p><em>type</em>
    <em>description</em></p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2555</span>
<span class="normal">2556</span>
<span class="normal">2557</span>
<span class="normal">2558</span>
<span class="normal">2559</span>
<span class="normal">2560</span>
<span class="normal">2561</span>
<span class="normal">2562</span>
<span class="normal">2563</span>
<span class="normal">2564</span>
<span class="normal">2565</span>
<span class="normal">2566</span>
<span class="normal">2567</span>
<span class="normal">2568</span>
<span class="normal">2569</span>
<span class="normal">2570</span>
<span class="normal">2571</span>
<span class="normal">2572</span>
<span class="normal">2573</span>
<span class="normal">2574</span>
<span class="normal">2575</span>
<span class="normal">2576</span>
<span class="normal">2577</span>
<span class="normal">2578</span>
<span class="normal">2579</span>
<span class="normal">2580</span>
<span class="normal">2581</span>
<span class="normal">2582</span>
<span class="normal">2583</span>
<span class="normal">2584</span>
<span class="normal">2585</span>
<span class="normal">2586</span>
<span class="normal">2587</span>
<span class="normal">2588</span>
<span class="normal">2589</span>
<span class="normal">2590</span>
<span class="normal">2591</span>
<span class="normal">2592</span>
<span class="normal">2593</span>
<span class="normal">2594</span>
<span class="normal">2595</span>
<span class="normal">2596</span>
<span class="normal">2597</span>
<span class="normal">2598</span>
<span class="normal">2599</span>
<span class="normal">2600</span>
<span class="normal">2601</span>
<span class="normal">2602</span>
<span class="normal">2603</span>
<span class="normal">2604</span>
<span class="normal">2605</span>
<span class="normal">2606</span>
<span class="normal">2607</span>
<span class="normal">2608</span>
<span class="normal">2609</span>
<span class="normal">2610</span>
<span class="normal">2611</span>
<span class="normal">2612</span>
<span class="normal">2613</span>
<span class="normal">2614</span>
<span class="normal">2615</span>
<span class="normal">2616</span>
<span class="normal">2617</span>
<span class="normal">2618</span>
<span class="normal">2619</span>
<span class="normal">2620</span>
<span class="normal">2621</span>
<span class="normal">2622</span>
<span class="normal">2623</span>
<span class="normal">2624</span>
<span class="normal">2625</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_swatches_circle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orientation</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">light_doses</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">15</span><span class="p">],</span> <span class="n">JND</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span> <span class="n">dose_unit</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Hv&#39;</span><span class="p">,</span> <span class="n">dE</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span> <span class="n">equation</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;power_3p&#39;</span><span class="p">,</span> <span class="n">initial_params</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">bounds</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">),</span> <span class="n">save</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">path_fig</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;cwd&#39;</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">report</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span> 
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot the microfading data with circular colored patches. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    light_doses : list, optional</span>
<span class="sd">        Light doses in Mlxh for which a coloured patches will be created, by default [0,0.5,1,2,5,1]</span>
<span class="sd">        There has been at least two numerical values in the list. The first value corresponds to the color background of the plot and is usually set to 0. The other values will be plotted as circular patches.</span>

<span class="sd">    JND : list, optional</span>
<span class="sd">        Whether to plot circular patches of just noticeable differences, by default [1,2,3,5,10]</span>
<span class="sd">        NOT YET IMPLEMENTED</span>

<span class="sd">    dose_unit : [str, tuple], optional</span>
<span class="sd">        Unit of the light energy dose, by default &#39;Hv&#39;</span>
<span class="sd">        Any of the following units can be used: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (hours) (exh,50,10,365)</span>

<span class="sd">    dE : bool, optional</span>
<span class="sd">        Whether to include the dE00 value between the background and each circular patche, by default True</span>

<span class="sd">    fontsize : int, optional</span>
<span class="sd">        Fontsize of the plot (title, ticks, and labels), by default 24        </span>

<span class="sd">    equation : str, optional</span>
<span class="sd">        Mathematical equation used to fit the coordinate values, by default &#39;c0*(x**c1) + c2&#39;.</span>
<span class="sd">        Any others mathematical can be given. The following equation can also be used for fitting microfading data: &#39;((x) / (c0 + (c1*x)))&#39;.</span>

<span class="sd">    initial_params : List[float], optional</span>
<span class="sd">        Initial guesses of the &#39;c&#39; parameters given in the equation (c0, c1, c2, etc.), by default [0.1, 0.0]</span>
<span class="sd">        In the default values, only c0 and c1 are provided ; c2 is retrieved from the initial value of each colorimetric coordinate plot.</span>

<span class="sd">    save : bool, optional</span>
<span class="sd">        Whether to save the figure, by default False</span>

<span class="sd">    path_fig : str, optional</span>
<span class="sd">        Absolute path required to save the figure, by default &#39;cwd&#39;</span>
<span class="sd">        When &#39;cwd&#39;, it will save the figure in the current working directory.</span>

<span class="sd">    title : str, optional</span>
<span class="sd">        Whether to add a title to the plot, by default None, by default None        </span>

<span class="sd">    report : bool, optional</span>
<span class="sd">        _description_, by default False</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    _type_</span>
<span class="sd">        _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Define the title</span>
    <span class="k">if</span> <span class="n">title</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_meas_ids</span><span class="p">)</span>


    <span class="c1"># Compute the extrapolated Lab values</span>
    <span class="n">list_extrapolated_Lab</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span><span class="s1">&#39;b*&#39;</span><span class="p">]:</span>            

        <span class="n">fitted_coord</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_fitting</span><span class="p">(</span><span class="n">coordinate</span><span class="o">=</span><span class="n">coord</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span> <span class="n">equation</span><span class="o">=</span><span class="n">equation</span><span class="p">,</span><span class="n">initial_params</span><span class="o">=</span><span class="n">initial_params</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span><span class="n">x_range</span><span class="o">=</span><span class="p">(</span><span class="n">light_doses</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">light_doses</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">light_doses</span><span class="p">]</span>

        <span class="n">list_extrapolated_Lab</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fitted_coord</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>


    <span class="c1"># Run the plotting function for each filehow to b</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)):</span>
        <span class="n">wanted_Lab</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">list_extrapolated_Lab</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">values</span>

        <span class="n">plotting</span><span class="o">.</span><span class="n">swatches_circle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">wanted_Lab</span><span class="p">],</span> <span class="n">data_type</span><span class="o">=</span><span class="s1">&#39;Lab&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="n">orientation</span><span class="p">,</span> <span class="n">light_doses</span><span class="o">=</span><span class="n">light_doses</span><span class="p">,</span> <span class="n">dose_unit</span><span class="o">=</span><span class="n">dose_unit</span><span class="p">,</span> <span class="n">dE</span><span class="o">=</span><span class="n">dE</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">path_fig</span><span class="o">=</span><span class="n">path_fig</span><span class="p">)</span>        
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.plots" class="doc doc-heading">
            <code class=" language-python"><span class="n">plots</span><span class="p">(</span><span class="n">plots</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CIELAB&#39;</span><span class="p">,</span> <span class="s1">&#39;SP&#39;</span><span class="p">,</span> <span class="s1">&#39;SW&#39;</span><span class="p">,</span> <span class="s1">&#39;dE&#39;</span><span class="p">,</span> <span class="s1">&#39;dLab&#39;</span><span class="p">])</span></code>

<a href="#microfading.microfading.MFT.plots" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Create plots</p>
<h5 id="microfading.microfading.MFT.plots--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.plots--parameters" title="Permanent link">&para;</a></h5>
<p>plots : list, optional
    <em>description</em>, by default ['CIELAB', 'SP', 'SW', 'dE', 'dLab']</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2189</span>
<span class="normal">2190</span>
<span class="normal">2191</span>
<span class="normal">2192</span>
<span class="normal">2193</span>
<span class="normal">2194</span>
<span class="normal">2195</span>
<span class="normal">2196</span>
<span class="normal">2197</span>
<span class="normal">2198</span>
<span class="normal">2199</span>
<span class="normal">2200</span>
<span class="normal">2201</span>
<span class="normal">2202</span>
<span class="normal">2203</span>
<span class="normal">2204</span>
<span class="normal">2205</span>
<span class="normal">2206</span>
<span class="normal">2207</span>
<span class="normal">2208</span>
<span class="normal">2209</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plots</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CIELAB&#39;</span><span class="p">,</span> <span class="s1">&#39;SP&#39;</span><span class="p">,</span> <span class="s1">&#39;SW&#39;</span><span class="p">,</span> <span class="s1">&#39;dE&#39;</span><span class="p">,</span> <span class="s1">&#39;dLab&#39;</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create plots</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    plots : list, optional</span>
<span class="sd">        _description_, by default [&#39;CIELAB&#39;, &#39;SP&#39;, &#39;SW&#39;, &#39;dE&#39;, &#39;dLab&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">plot</span> <span class="ow">in</span> <span class="n">plots</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">plot</span> <span class="o">==</span> <span class="s1">&#39;CIELAB&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_CIELAB</span><span class="p">(</span><span class="n">legend_labels</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">legend_fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">plot</span> <span class="o">==</span> <span class="s1">&#39;SP&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_sp</span><span class="p">(</span><span class="n">spectra</span><span class="o">=</span><span class="s1">&#39;i+f&#39;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">plot</span> <span class="o">==</span> <span class="s1">&#39;SW&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_swatches_circle</span><span class="p">()</span>

        <span class="k">elif</span> <span class="n">plot</span> <span class="o">==</span> <span class="s1">&#39;dE&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_delta</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.read_files" class="doc doc-heading">
            <code class=" language-python"><span class="n">read_files</span><span class="p">(</span><span class="n">sheets</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="s1">&#39;CIELAB&#39;</span><span class="p">,</span> <span class="s1">&#39;spectra&#39;</span><span class="p">])</span></code>

<a href="#microfading.microfading.MFT.read_files" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Read the data files given as argument when defining the instance of the MFT class.</p>
<h5 id="microfading.microfading.MFT.read_files--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.read_files--parameters" title="Permanent link">&para;</a></h5>
<p>sheets : Optional[list], optional
    Name of the excel sheets to be selected, by default ['info', 'CIELAB', 'spectra']</p>
<h5 id="microfading.microfading.MFT.read_files--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.read_files--returns" title="Permanent link">&para;</a></h5>
<p>A list of list of pandas dataframes
    The content of each input data file is returned as a list pandas dataframes (3 dataframes maximum, one dataframe per sheet). Ultimately, the function returns a list of list, so that when there are several input data files, each list - related a single file - corresponds to a single element of a list.</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3786</span>
<span class="normal">3787</span>
<span class="normal">3788</span>
<span class="normal">3789</span>
<span class="normal">3790</span>
<span class="normal">3791</span>
<span class="normal">3792</span>
<span class="normal">3793</span>
<span class="normal">3794</span>
<span class="normal">3795</span>
<span class="normal">3796</span>
<span class="normal">3797</span>
<span class="normal">3798</span>
<span class="normal">3799</span>
<span class="normal">3800</span>
<span class="normal">3801</span>
<span class="normal">3802</span>
<span class="normal">3803</span>
<span class="normal">3804</span>
<span class="normal">3805</span>
<span class="normal">3806</span>
<span class="normal">3807</span>
<span class="normal">3808</span>
<span class="normal">3809</span>
<span class="normal">3810</span>
<span class="normal">3811</span>
<span class="normal">3812</span>
<span class="normal">3813</span>
<span class="normal">3814</span>
<span class="normal">3815</span>
<span class="normal">3816</span>
<span class="normal">3817</span>
<span class="normal">3818</span>
<span class="normal">3819</span>
<span class="normal">3820</span>
<span class="normal">3821</span>
<span class="normal">3822</span>
<span class="normal">3823</span>
<span class="normal">3824</span>
<span class="normal">3825</span>
<span class="normal">3826</span>
<span class="normal">3827</span>
<span class="normal">3828</span>
<span class="normal">3829</span>
<span class="normal">3830</span>
<span class="normal">3831</span>
<span class="normal">3832</span>
<span class="normal">3833</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheets</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="s1">&#39;CIELAB&#39;</span><span class="p">,</span> <span class="s1">&#39;spectra&#39;</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read the data files given as argument when defining the instance of the MFT class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    sheets : Optional[list], optional</span>
<span class="sd">        Name of the excel sheets to be selected, by default [&#39;info&#39;, &#39;CIELAB&#39;, &#39;spectra&#39;]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A list of list of pandas dataframes</span>
<span class="sd">        The content of each input data file is returned as a list pandas dataframes (3 dataframes maximum, one dataframe per sheet). Ultimately, the function returns a list of list, so that when there are several input data files, each list - related a single file - corresponds to a single element of a list.            </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">files</span> <span class="o">=</span> <span class="p">[]</span>        

    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">:</span>

        <span class="n">df_info</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
        <span class="n">df_sp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;spectra&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">df_cl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;CIELAB&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>                      


        <span class="k">if</span> <span class="n">sheets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="s1">&#39;CIELAB&#39;</span><span class="p">,</span> <span class="s1">&#39;spectra&#39;</span><span class="p">]:</span>
            <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_info</span><span class="p">,</span> <span class="n">df_cl</span><span class="p">,</span> <span class="n">df_sp</span><span class="p">])</span>

        <span class="k">elif</span> <span class="n">sheets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">]:</span>
            <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_info</span><span class="p">])</span>

        <span class="k">elif</span> <span class="n">sheets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;CIELAB&#39;</span><span class="p">]:</span>
            <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_cl</span><span class="p">])</span>

        <span class="k">elif</span> <span class="n">sheets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;spectra&#39;</span><span class="p">]:</span>
            <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_sp</span><span class="p">])</span>

        <span class="k">elif</span> <span class="n">sheets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;spectra&#39;</span><span class="p">,</span> <span class="s1">&#39;CIELAB&#39;</span><span class="p">]:</span>
            <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_sp</span><span class="p">,</span> <span class="n">df_cl</span><span class="p">])</span>

        <span class="k">elif</span> <span class="n">sheets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;CIELAB&#39;</span><span class="p">,</span><span class="s1">&#39;spectra&#39;</span><span class="p">]:</span>
            <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_cl</span><span class="p">,</span> <span class="n">df_sp</span><span class="p">])</span>

        <span class="k">elif</span> <span class="n">sheets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">,</span><span class="s1">&#39;CIELAB&#39;</span><span class="p">]:</span>
            <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_info</span><span class="p">,</span> <span class="n">df_cl</span><span class="p">])</span>

        <span class="k">elif</span> <span class="n">sheets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">,</span><span class="s1">&#39;spectra&#39;</span><span class="p">]:</span>
            <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_info</span><span class="p">,</span> <span class="n">df_sp</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">files</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="microfading.microfading.get_colorimetry_info" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_colorimetry_info</span><span class="p">()</span></code>

<a href="#microfading.microfading.get_colorimetry_info" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Retrieve the colorimetric information (observer and illuminant) recorded in the config_info.json file of the microfading package.</p>
<h4 id="microfading.microfading.get_colorimetry_info--returns">Returns<a class="headerlink" href="#microfading.microfading.get_colorimetry_info--returns" title="Permanent link">&para;</a></h4>
<p>pandas dataframe or string
    It returns the information inside a dataframe if they have been recorded.</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_colorimetry_info</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve the colorimetric information (observer and illuminant) recorded in the config_info.json file of the microfading package.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pandas dataframe or string</span>
<span class="sd">        It returns the information inside a dataframe if they have been recorded.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="k">return</span> <span class="n">config</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="microfading.microfading.get_config" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_config</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span></code>

<a href="#microfading.microfading.get_config" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Retrieve the content of the config_info.json file</p>
<h4 id="microfading.microfading.get_config--parameters">Parameters<a class="headerlink" href="#microfading.microfading.get_config--parameters" title="Permanent link">&para;</a></h4>
<p>key : Optional[str], optional
    Give you the possibility to retrieve a specific category of information, by default 'all'
    One can enter a key value among the following list: ['colorimetry', 'databases', 'devices', 'exposure', 'filters', 'functions', 'lamps', 'light_dose', 'institution', 'report_figures']</p>
<h4 id="microfading.microfading.get_config--returns">Returns<a class="headerlink" href="#microfading.microfading.get_config--returns" title="Permanent link">&para;</a></h4>
<p>dict
    It returns the information inside a dictionary.</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="n">key</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve the content of the config_info.json file</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    key : Optional[str], optional</span>
<span class="sd">        Give you the possibility to retrieve a specific category of information, by default &#39;all&#39;</span>
<span class="sd">        One can enter a key value among the following list: [&#39;colorimetry&#39;, &#39;databases&#39;, &#39;devices&#39;, &#39;exposure&#39;, &#39;filters&#39;, &#39;functions&#39;, &#39;lamps&#39;, &#39;light_dose&#39;, &#39;institution&#39;, &#39;report_figures&#39;]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        It returns the information inside a dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">config</span><span class="o">.</span><span class="n">get_config_info</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="microfading.microfading.get_config_path" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_config_path</span><span class="p">()</span></code>

<a href="#microfading.microfading.get_config_path" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Retrieve the absolute path of the config_info.json file.</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config_path</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve the absolute path of the config_info.json file.   </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">config</span><span class="o">.</span><span class="n">get_config_path</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="microfading.microfading.get_datasets" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_datasets</span><span class="p">(</span><span class="n">MFT</span><span class="o">=</span><span class="s1">&#39;fotonowy&#39;</span><span class="p">,</span> <span class="n">rawfiles</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">BWS</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stdev</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#microfading.microfading.get_datasets" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Retrieve exemples of dataset files. These files are meant to give the users the possibility to test the MFT class and its functions.  </p>
<h4 id="microfading.microfading.get_datasets--parameters">Parameters<a class="headerlink" href="#microfading.microfading.get_datasets--parameters" title="Permanent link">&para;</a></h4>
<p>MFT : Optional[str], optional
    Microfading device that has been used to obtain the files, by default 'fotonowy'
    One can choose a single option among the following choices: 'fotonowy', 'sMFT', 
    'fotonowy' corresponds to the microfading device of the Polish company Fotonowy
    'sMFT' corresponds to stereo-MFT (see Patin et al. 2022. Journal of Cultural Heritage, 57)</p>


<details class="rawfiles-" open>
  <summary>Optional[bool], optional</summary>
  <p>Whether to get rawdata files, by default False
The raw files were obtained from microfading analyses performed with the Fotonowy device and consist of four files per analysis.</p>
</details>

<details class="bws-" open>
  <summary>Optional[bool], optional</summary>
  <p>Whether to include the microfading measurements on blue wool standards (BWS), by default True</p>
</details>

<details class="stdev-" open>
  <summary>Optional[bool], optional</summary>
  <p>Whether to have microfading measurements wiht standard deviation values, by default False
It only works if the rawfiles parameters is set to 'False'. The rawfiles do not have standard deviation values.</p>
</details>        <h4 id="microfading.microfading.get_datasets--returns">Returns<a class="headerlink" href="#microfading.microfading.get_datasets--returns" title="Permanent link">&para;</a></h4>
<p>list
    It returns a list of strings, where each string corresponds the absolute path of a microfading measurement excel file. Subsequently, one can use the list as input for the MFT class.</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_datasets</span><span class="p">(</span><span class="n">MFT</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;fotonowy&#39;</span><span class="p">,</span> <span class="n">rawfiles</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">BWS</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">stdev</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve exemples of dataset files. These files are meant to give the users the possibility to test the MFT class and its functions.  </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    MFT : Optional[str], optional</span>
<span class="sd">        Microfading device that has been used to obtain the files, by default &#39;fotonowy&#39;</span>
<span class="sd">        One can choose a single option among the following choices: &#39;fotonowy&#39;, &#39;sMFT&#39;, </span>
<span class="sd">        &#39;fotonowy&#39; corresponds to the microfading device of the Polish company Fotonowy</span>
<span class="sd">        &#39;sMFT&#39; corresponds to stereo-MFT (see Patin et al. 2022. Journal of Cultural Heritage, 57)</span>

<span class="sd">    rawfiles : Optional[bool], optional</span>
<span class="sd">        Whether to get rawdata files, by default False</span>
<span class="sd">        The raw files were obtained from microfading analyses performed with the Fotonowy device and consist of four files per analysis.</span>

<span class="sd">    BWS : Optional[bool], optional</span>
<span class="sd">        Whether to include the microfading measurements on blue wool standards (BWS), by default True</span>

<span class="sd">    stdev : Optional[bool], optional</span>
<span class="sd">        Whether to have microfading measurements wiht standard deviation values, by default False</span>
<span class="sd">        It only works if the rawfiles parameters is set to &#39;False&#39;. The rawfiles do not have standard deviation values.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list</span>
<span class="sd">        It returns a list of strings, where each string corresponds the absolute path of a microfading measurement excel file. Subsequently, one can use the list as input for the MFT class. </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Whether to select files with standard deviation values</span>
    <span class="k">if</span> <span class="n">stdev</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">MFT</span> <span class="o">==</span> <span class="s1">&#39;sMFT&#39;</span><span class="p">:</span>
            <span class="n">data_files</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s1">&#39;2024-144_MF.BWS0024.G02_avg_BW1_model_2024-08-02_MFT1.xlsx&#39;</span><span class="p">,</span>
                <span class="s1">&#39;2024-144_MF.BWS0025.G02_avg_BW2_model_2024-08-02_MFT1.xlsx&#39;</span><span class="p">,</span>
                <span class="s1">&#39;2024-144_MF.BWS0026.G02_avg_BW3_model_2024-08-02_MFT1.xlsx&#39;</span><span class="p">,</span>                
            <span class="p">]</span>

        <span class="k">elif</span> <span class="n">MFT</span> <span class="o">==</span> <span class="s1">&#39;fotonowy&#39;</span><span class="p">:</span>
            <span class="n">data_files</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s1">&#39;2024-144_MF.BWS0024.G01_avg_BW1_model_2024-07-30_MFT2.xlsx&#39;</span><span class="p">,</span>
                <span class="s1">&#39;2024-144_MF.BWS0025.G01_avg_BW2_model_2024-08-02_MFT2.xlsx&#39;</span><span class="p">,</span>
                <span class="s1">&#39;2024-144_MF.BWS0026.G01_avg_BW3_model_2024-08-07_MFT2.xlsx&#39;</span><span class="p">,</span>
                <span class="s1">&#39;2024-144_MF.dayflower4.G01_avg_0h_model_2024-07-30_MFT2.xlsx&#39;</span><span class="p">,</span>
                <span class="s1">&#39;2024-144_MF.indigo3.G01_avg_0h_model_2024-08-02_MFT2.xlsx&#39;</span><span class="p">,</span>
            <span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">MFT</span> <span class="o">==</span> <span class="s1">&#39;sMFT&#39;</span><span class="p">:</span>
            <span class="n">data_files</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s1">&#39;2024-144_MF.BWS0026.04_G02_BW3_model_2024-08-02_MFT1.xlsx&#39;</span><span class="p">,</span>
                <span class="s1">&#39;2024-144_MF.BWS0025.04_G02_BW2_model_2024-08-02_MFT1.xlsx&#39;</span><span class="p">,</span>
                <span class="s1">&#39;2024-144_MF.BWS0024.04_G02_BW1_model_2024-08-02_MFT1.xlsx&#39;</span><span class="p">,</span>
                <span class="s1">&#39;2024-144_MF.yellowwood.01_G01_yellow_model_2024-08-01_MFT1.xlsx&#39;</span><span class="p">,</span>
                <span class="s1">&#39;2024-144_MF.vermillon.01_G01_red_model_2024-07-31_MFT1.xlsx&#39;</span><span class="p">,</span>
            <span class="p">]</span>

        <span class="k">elif</span> <span class="n">MFT</span> <span class="o">==</span> <span class="s1">&#39;fotonowy&#39;</span><span class="p">:</span>
            <span class="n">data_files</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s1">&#39;2024-144_MF.BWS0024.01_G01_BW1_model_2024-07-30_MFT2.xlsx&#39;</span><span class="p">,</span>
                <span class="s1">&#39;2024-144_MF.BWS0025.01_G01_BW2_model_2024-08-02_MFT2.xlsx&#39;</span><span class="p">,</span>
                <span class="s1">&#39;2024-144_MF.BWS0026.01_G01_BW3_model_2024-08-07_MFT2.xlsx&#39;</span><span class="p">,</span>
                <span class="s1">&#39;2024-144_MF.vermillon3.01_G01_0h_sample_2024-07-31_MFT2.xlsx&#39;</span><span class="p">,</span>
                <span class="s1">&#39;2024-144_MF.yellowwood4.01_G01_0h_model_2024-08-01_MFT2.xlsx&#39;</span><span class="p">,</span>
            <span class="p">]</span>

    <span class="c1"># Whether to select rawfiles according to a choosen device</span>
    <span class="k">if</span> <span class="n">rawfiles</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">MFT</span> <span class="o">==</span> <span class="s1">&#39;sMFT&#39;</span><span class="p">:</span>
            <span class="n">data_files</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s1">&#39;2024-144_BWS0024_04_G02_BW1_c01_000001.txt&#39;</span><span class="p">,</span>
                <span class="s1">&#39;2024-144_yellowwood_01_G01_yellow_c01_000001.txt&#39;</span><span class="p">,</span>
            <span class="p">]</span>

        <span class="k">elif</span> <span class="n">MFT</span> <span class="o">==</span> <span class="s1">&#39;fotonowy&#39;</span><span class="p">:</span>
            <span class="n">data_files</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s1">&#39;2024-8200 P-001 G01 uncleaned_01-spect_convert.txt&#39;</span><span class="p">,</span>
                <span class="s1">&#39;2024-8200 P-001 G01 uncleaned_01-spect.txt&#39;</span><span class="p">,</span>
                <span class="s1">&#39;2024-8200 P-001 G01 uncleaned_01.txt&#39;</span><span class="p">,</span>
                <span class="s1">&#39;2024-8200 P-001 G01 uncleaned_01.rfc&#39;</span><span class="p">,</span>
                <span class="s1">&#39;2024-144 BWS0024 G01 BW1_01-spect_convert.txt&#39;</span><span class="p">,</span>
                <span class="s1">&#39;2024-144 BWS0024 G01 BW1_01-spect.txt&#39;</span><span class="p">,</span>
                <span class="s1">&#39;2024-144 BWS0024 G01 BW1_01.txt&#39;</span><span class="p">,</span>
                <span class="s1">&#39;2024-144 BWS0024 G01 BW1_01.rfc&#39;</span><span class="p">,</span>
            <span class="p">]</span>

    <span class="c1"># Whether to include the BWS files or not</span>
    <span class="k">if</span> <span class="n">BWS</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">data_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_files</span> <span class="k">if</span> <span class="s1">&#39;BWS&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>


    <span class="c1"># Get the paths to the data files within the package</span>
    <span class="n">file_paths</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="n">data_files</span><span class="p">:</span>

        <span class="k">with</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">path</span><span class="p">(</span><span class="s1">&#39;microfading.datasets&#39;</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span> <span class="k">as</span> <span class="n">data_file</span><span class="p">:</span>
             <span class="n">file_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_file</span><span class="p">)</span>


    <span class="k">return</span> <span class="n">file_paths</span>   
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="microfading.microfading.get_devices_info" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_devices_info</span><span class="p">()</span></code>

<a href="#microfading.microfading.get_devices_info" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Retrieve the configuration information related to the devices.</p>
<h4 id="microfading.microfading.get_devices_info--returns">Returns<a class="headerlink" href="#microfading.microfading.get_devices_info--returns" title="Permanent link">&para;</a></h4>
<p>pandas dataframe
    It returns the list of devices inside a pandas dataframe with four columns: 'Id', 'name', 'description', 'process_function'</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_devices_info</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve the configuration information related to the devices.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pandas dataframe</span>
<span class="sd">        It returns the list of devices inside a pandas dataframe with four columns: &#39;Id&#39;, &#39;name&#39;, &#39;description&#39;, &#39;process_function&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="k">return</span> <span class="n">config</span><span class="o">.</span><span class="n">get_devices_info</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="microfading.microfading.get_exposure_conditions" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_exposure_conditions</span><span class="p">()</span></code>

<a href="#microfading.microfading.get_exposure_conditions" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Retrieve the exposure lighting conditions recorded in the config_info.json file of the microfading package.</p>
<h4 id="microfading.microfading.get_exposure_conditions--returns">Returns<a class="headerlink" href="#microfading.microfading.get_exposure_conditions--returns" title="Permanent link">&para;</a></h4>
<p>pandas dataframe or string
    It returns the information inside a dataframe if they have been recorded.</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_exposure_conditions</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve the exposure lighting conditions recorded in the config_info.json file of the microfading package.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pandas dataframe or string</span>
<span class="sd">        It returns the information inside a dataframe if they have been recorded.</span>
<span class="sd">    &quot;&quot;&quot;</span>   
    <span class="k">return</span> <span class="n">config</span><span class="o">.</span><span class="n">get_exposure_conditions</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="microfading.microfading.get_institution_info" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_institution_info</span><span class="p">()</span></code>

<a href="#microfading.microfading.get_institution_info" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Retrieve the information related to the institution that performed the microfading analysis.</p>
<h4 id="microfading.microfading.get_institution_info--returns">Returns<a class="headerlink" href="#microfading.microfading.get_institution_info--returns" title="Permanent link">&para;</a></h4>
<p>pandas dataframe
    It returns the institution info inside a pandas dataframe.</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_institution_info</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve the information related to the institution that performed the microfading analysis.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pandas dataframe</span>
<span class="sd">        It returns the institution info inside a pandas dataframe.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="k">return</span> <span class="n">config</span><span class="o">.</span><span class="n">get_institution_info</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="microfading.microfading.get_light_dose_info" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_light_dose_info</span><span class="p">()</span></code>

<a href="#microfading.microfading.get_light_dose_info" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Retrieve the light dose info recorded in the config_info.json file of the microfading package.</p>
<h4 id="microfading.microfading.get_light_dose_info--returns">Returns<a class="headerlink" href="#microfading.microfading.get_light_dose_info--returns" title="Permanent link">&para;</a></h4>
<p>pandas dataframe or string
    It returns the information inside a dataframe if they have been recorded.</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_light_dose_info</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve the light dose info recorded in the config_info.json file of the microfading package.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pandas dataframe or string</span>
<span class="sd">        It returns the information inside a dataframe if they have been recorded.</span>
<span class="sd">    &quot;&quot;&quot;</span>       
    <span class="k">return</span> <span class="n">config</span><span class="o">.</span><span class="n">get_light_dose_info</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="microfading.microfading.is_DB" class="doc doc-heading">
            <code class=" language-python"><span class="n">is_DB</span><span class="p">()</span></code>

<a href="#microfading.microfading.is_DB" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Check whether the databases files were created.</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_DB</span><span class="p">():</span>
    <span class="s2">&quot;Check whether the databases files were created.&quot;</span>

    <span class="c1"># instantiate a DB class object</span>
    <span class="n">DB</span> <span class="o">=</span> <span class="n">databases</span><span class="o">.</span><span class="n">DB</span><span class="p">()</span>
    <span class="n">DB_config</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">get_db_config</span><span class="p">()[</span><span class="s1">&#39;databases&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">DB_config</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The databases have not been configured. Please enter databases configuration info by using the function set_DB().&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="n">db_files</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DB_projects.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;DB_objects.csv&#39;</span><span class="p">,</span><span class="s1">&#39;institutions.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;persons.txt&#39;</span><span class="p">,</span><span class="s1">&#39;object_types.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;object_techniques.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;object_supports.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;object_creators.txt&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">,</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">folder_db</span><span class="p">)</span><span class="o">/</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">db_files</span><span class="p">]))):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;All the databases were created and can be found in the following directory: </span><span class="si">{</span><span class="n">DB</span><span class="o">.</span><span class="n">folder_db</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The databases files were created, but one or several files are currently missing.&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The files should be located in the following directory: </span><span class="si">{</span><span class="n">DB</span><span class="o">.</span><span class="n">folder_db</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="microfading.microfading.process_rawdata" class="doc doc-heading">
            <code class=" language-python"><span class="n">process_rawdata</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">filenaming</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">folder</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">db</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">authors</span><span class="o">=</span><span class="s1">&#39;XX&#39;</span><span class="p">,</span> <span class="n">white_standard</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">observer</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">illuminant</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">delete_files</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_filename</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#microfading.microfading.process_rawdata" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Process the microfading raw files created by the software that performed the microfading analysis. </p>
<h4 id="microfading.microfading.process_rawdata--parameters">Parameters<a class="headerlink" href="#microfading.microfading.process_rawdata--parameters" title="Permanent link">&para;</a></h4>
<p>files : list
    A list of string that corresponds to the absolute path of the raw files.</p>


<details class="device-" open>
  <summary>str</summary>
  <p>Define the  microfading that has been used to generate the raw files ('fotonowy_default', 'sMFT_default').</p>
</details>

<details class="filenaming-" open>
  <summary>[str | list], optional</summary>
  <p>Define the filename of the output excel file, by default 'none' 
When 'none', it uses the filename of the raw files
When 'auto', it creates a filename based on the info provided by the databases
A list of parameters provided in the info sheet of the excel output can be used to create a filename   </p>
</details>

<details class="folder-" open>
  <summary>str, optional</summary>
  <p>Folder where the final data files should be saved, by default '.'</p>
</details>

<details class="db-" open>
  <summary>bool, optional</summary>
  <p>Whether to make use of the databases, by default False
When True, it will populate the info sheet in the interim file (the output excel file) with the data found in the databases.
Make sure that the databases were created and that the information about about the project and the objects were recorded.</p>
</details>

<details class="comment-" open>
  <summary>str, optional</summary>
  <p>Whether to include a comment in the final excel file, by default ''</p>
</details>

<details class="authors-" open>
  <summary>str, optional</summary>
  <p>Initials of the persons that performed and processed the microfading measurements, by default 'XX' (unknown).
Make sure that you registered the persons in the persons.txt file (see function 'add_new_person').
If there are several persons, use a dash to connect the initials (e.g: 'JD-MG-OL').</p>
</details>

<details class="interpolation-" open>
  <summary>str, optional</summary>
  <p>Whether to perform the interpolation ('He', 'Hv', 't') or not ('none'), by default 'He'
'He' performs interpolation based on the radiant exposure (MJ/m2)
'Hv' performs interpolation based on the exposure dose (Mlxh)
't' performs interpolation based on the exposure duration (sec)</p>
</details>

<details class="step-" open>
  <summary>[float  |  int], optional</summary>
  <p>Interpolation step related to the scale previously mentioned ('He', 'Hv', 'time'), by default 0.1</p>
</details>

<details class="observer-" open>
  <summary>str, optional</summary>
  <p>Reference CIE <em>observer</em> in degree ('10deg' or '2deg'). by default 'default'.
When 'default', it fetches the observer value recorded in the db_config.json file of the package. If no value has been recorded, then it sets the observer value to '10deg'. </p>
</details>

<details class="illuminant-" open>
  <summary>(str, optional)</summary>
  <p>Reference CIE <em>illuminant</em>. It can be any value of the following list: ['A', 'B', 'C', 'D50', 'D55', 'D60', 'D65', 'D75', 'E', 'FL1', 'FL2', 'FL3', 'FL4', 'FL5', 'FL6', 'FL7', 'FL8', 'FL9', 'FL10', 'FL11', 'FL12', 'FL3.1', 'FL3.2', 'FL3.3', 'FL3.4', 'FL3.5', 'FL3.6', 'FL3.7', 'FL3.8', 'FL3.9', 'FL3.10', 'FL3.11', 'FL3.12', 'FL3.13', 'FL3.14', 'FL3.15', 'HP1', 'HP2', 'HP3', 'HP4', 'HP5', 'LED-B1', 'LED-B2', 'LED-B3', 'LED-B4', 'LED-B5', 'LED-BH1', 'LED-RGB1', 'LED-V1', 'LED-V2', 'ID65', 'ID50']. by default 'default'.
When 'default', it fetches the illuminant value recorded in the db_config.json file of the package. If no value has been recorded, then it sets the illuminant value to 'D65'.      </p>
</details>

<details class="delete_files-" open>
  <summary>bool, optional</summary>
  <p>Whether to delete the raw files</p>
</details>        <h4 id="microfading.microfading.process_rawdata--returns">Returns<a class="headerlink" href="#microfading.microfading.process_rawdata--returns" title="Permanent link">&para;</a></h4>
<p>Excel file
    It returns an excel file composed of three tabs (info, CIELAB, spectra).</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">process_rawdata</span><span class="p">(</span><span class="n">files</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">device</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filenaming</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">folder</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">authors</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;XX&#39;</span><span class="p">,</span> <span class="n">white_standard</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">step</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">observer</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">illuminant</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">background</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">delete_files</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">return_filename</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Process the microfading raw files created by the software that performed the microfading analysis. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    files : list</span>
<span class="sd">        A list of string that corresponds to the absolute path of the raw files.</span>

<span class="sd">    device : str</span>
<span class="sd">        Define the  microfading that has been used to generate the raw files (&#39;fotonowy_default&#39;, &#39;sMFT_default&#39;).</span>

<span class="sd">    filenaming : [str | list], optional</span>
<span class="sd">        Define the filename of the output excel file, by default &#39;none&#39; </span>
<span class="sd">        When &#39;none&#39;, it uses the filename of the raw files</span>
<span class="sd">        When &#39;auto&#39;, it creates a filename based on the info provided by the databases</span>
<span class="sd">        A list of parameters provided in the info sheet of the excel output can be used to create a filename   </span>

<span class="sd">    folder : str, optional</span>
<span class="sd">        Folder where the final data files should be saved, by default &#39;.&#39;</span>

<span class="sd">    db : bool, optional</span>
<span class="sd">        Whether to make use of the databases, by default False</span>
<span class="sd">        When True, it will populate the info sheet in the interim file (the output excel file) with the data found in the databases.</span>
<span class="sd">        Make sure that the databases were created and that the information about about the project and the objects were recorded.</span>

<span class="sd">    comment : str, optional</span>
<span class="sd">        Whether to include a comment in the final excel file, by default &#39;&#39;</span>

<span class="sd">    authors : str, optional</span>
<span class="sd">        Initials of the persons that performed and processed the microfading measurements, by default &#39;XX&#39; (unknown).</span>
<span class="sd">        Make sure that you registered the persons in the persons.txt file (see function &#39;add_new_person&#39;).</span>
<span class="sd">        If there are several persons, use a dash to connect the initials (e.g: &#39;JD-MG-OL&#39;).</span>

<span class="sd">    interpolation : str, optional</span>
<span class="sd">        Whether to perform the interpolation (&#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;) or not (&#39;none&#39;), by default &#39;He&#39;</span>
<span class="sd">        &#39;He&#39; performs interpolation based on the radiant exposure (MJ/m2)</span>
<span class="sd">        &#39;Hv&#39; performs interpolation based on the exposure dose (Mlxh)</span>
<span class="sd">        &#39;t&#39; performs interpolation based on the exposure duration (sec)</span>

<span class="sd">    step : [float  |  int], optional</span>
<span class="sd">        Interpolation step related to the scale previously mentioned (&#39;He&#39;, &#39;Hv&#39;, &#39;time&#39;), by default 0.1</span>

<span class="sd">    observer : str, optional</span>
<span class="sd">        Reference CIE *observer* in degree (&#39;10deg&#39; or &#39;2deg&#39;). by default &#39;default&#39;.</span>
<span class="sd">        When &#39;default&#39;, it fetches the observer value recorded in the db_config.json file of the package. If no value has been recorded, then it sets the observer value to &#39;10deg&#39;. </span>

<span class="sd">    illuminant : (str, optional)  </span>
<span class="sd">        Reference CIE *illuminant*. It can be any value of the following list: [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D50&#39;, &#39;D55&#39;, &#39;D60&#39;, &#39;D65&#39;, &#39;D75&#39;, &#39;E&#39;, &#39;FL1&#39;, &#39;FL2&#39;, &#39;FL3&#39;, &#39;FL4&#39;, &#39;FL5&#39;, &#39;FL6&#39;, &#39;FL7&#39;, &#39;FL8&#39;, &#39;FL9&#39;, &#39;FL10&#39;, &#39;FL11&#39;, &#39;FL12&#39;, &#39;FL3.1&#39;, &#39;FL3.2&#39;, &#39;FL3.3&#39;, &#39;FL3.4&#39;, &#39;FL3.5&#39;, &#39;FL3.6&#39;, &#39;FL3.7&#39;, &#39;FL3.8&#39;, &#39;FL3.9&#39;, &#39;FL3.10&#39;, &#39;FL3.11&#39;, &#39;FL3.12&#39;, &#39;FL3.13&#39;, &#39;FL3.14&#39;, &#39;FL3.15&#39;, &#39;HP1&#39;, &#39;HP2&#39;, &#39;HP3&#39;, &#39;HP4&#39;, &#39;HP5&#39;, &#39;LED-B1&#39;, &#39;LED-B2&#39;, &#39;LED-B3&#39;, &#39;LED-B4&#39;, &#39;LED-B5&#39;, &#39;LED-BH1&#39;, &#39;LED-RGB1&#39;, &#39;LED-V1&#39;, &#39;LED-V2&#39;, &#39;ID65&#39;, &#39;ID50&#39;]. by default &#39;default&#39;.</span>
<span class="sd">        When &#39;default&#39;, it fetches the illuminant value recorded in the db_config.json file of the package. If no value has been recorded, then it sets the illuminant value to &#39;D65&#39;.      </span>

<span class="sd">    delete_files : bool, optional</span>
<span class="sd">        Whether to delete the raw files</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Excel file</span>
<span class="sd">        It returns an excel file composed of three tabs (info, CIELAB, spectra).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Load the config_info file    </span>
    <span class="n">config_info</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get_config_info</span><span class="p">()</span>


    <span class="c1"># Set the db value</span>
    <span class="k">if</span> <span class="n">db</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">config_info</span><span class="p">[</span><span class="s1">&#39;databases&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">db</span> <span class="o">=</span> <span class="kc">False</span>            
        <span class="k">else</span><span class="p">:</span>
            <span class="n">db</span> <span class="o">=</span> <span class="n">config_info</span><span class="p">[</span><span class="s1">&#39;databases&#39;</span><span class="p">][</span><span class="s1">&#39;usage&#39;</span><span class="p">]</span>


    <span class="c1"># Set the observer value</span>
    <span class="k">if</span> <span class="n">observer</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">config_info</span><span class="p">[</span><span class="s1">&#39;colorimetry&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">observer</span> <span class="o">=</span> <span class="s1">&#39;10deg&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">observer</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;observer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>


    <span class="c1"># Set the illuminant value</span>
    <span class="k">if</span> <span class="n">illuminant</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">config_info</span><span class="p">[</span><span class="s1">&#39;colorimetry&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">illuminant</span> <span class="o">=</span> <span class="s1">&#39;D65&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">illuminant</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;illuminant&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>


    <span class="c1"># Set the interpolation value</span>
    <span class="k">if</span> <span class="n">interpolation</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">config_info</span><span class="p">[</span><span class="s1">&#39;light_dose&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">interpolation</span> <span class="o">=</span> <span class="s1">&#39;He&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">interpolation</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get_light_dose_info</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;unit&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>


    <span class="c1"># Set the white reference value</span>
    <span class="k">if</span> <span class="n">white_standard</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">config_info</span><span class="p">[</span><span class="s1">&#39;colorimetry&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">white_standard</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">white_standard</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get_colorimetry_info</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;white_standard&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  


    <span class="c1"># Retrieve the process function</span>
    <span class="k">if</span> <span class="n">device</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;fotonowy&#39;</span><span class="p">,</span> <span class="s1">&#39;smft&#39;</span><span class="p">,</span> <span class="s1">&#39;stereo&#39;</span><span class="p">]:</span>
        <span class="n">process_function</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">process_function</span> <span class="o">=</span> <span class="n">config_info</span><span class="p">[</span><span class="s1">&#39;devices&#39;</span><span class="p">][</span><span class="n">device</span><span class="p">][</span><span class="s1">&#39;process_function&#39;</span><span class="p">]</span>


    <span class="c1"># Run the process_rawfiles function</span>
    <span class="k">if</span> <span class="s1">&#39;fotonowy&#39;</span> <span class="ow">in</span> <span class="n">process_function</span><span class="p">:</span>

        <span class="k">return</span> <span class="n">process_rawfiles</span><span class="o">.</span><span class="n">MFT_fotonowy</span><span class="p">(</span><span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">,</span> <span class="n">filenaming</span><span class="o">=</span><span class="n">filenaming</span><span class="p">,</span> <span class="n">folder</span><span class="o">=</span><span class="n">folder</span><span class="p">,</span> <span class="n">db</span><span class="o">=</span><span class="n">db</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span> <span class="n">device_nb</span><span class="o">=</span><span class="n">device</span><span class="p">,</span> <span class="n">authors</span><span class="o">=</span><span class="n">authors</span><span class="p">,</span> <span class="n">white_standard</span><span class="o">=</span><span class="n">white_standard</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="n">interpolation</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span> <span class="n">observer</span><span class="o">=</span><span class="n">observer</span><span class="p">,</span> <span class="n">illuminant</span><span class="o">=</span><span class="n">illuminant</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="n">background</span><span class="p">,</span> <span class="n">delete_files</span><span class="o">=</span><span class="n">delete_files</span><span class="p">,</span> <span class="n">return_filename</span><span class="o">=</span><span class="n">return_filename</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="microfading.microfading.reset_config" class="doc doc-heading">
            <code class=" language-python"><span class="n">reset_config</span><span class="p">()</span></code>

<a href="#microfading.microfading.reset_config" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Reset the content of config_info.json to its initial state, i.e. all empty dictionaries.</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reset_config</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reset the content of config_info.json to its initial state, i.e. all empty dictionaries.  </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">config</span><span class="o">.</span><span class="n">reset_config</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="microfading.microfading.set_DB" class="doc doc-heading">
            <code class=" language-python"><span class="n">set_DB</span><span class="p">(</span><span class="n">folder_path</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">use</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#microfading.microfading.set_DB" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Record the databases info in the config_info.json file of the microfading package.</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_DB</span><span class="p">(</span><span class="n">folder_path</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">use</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Record the databases info in the config_info.json file of the microfading package.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">config</span><span class="o">.</span><span class="n">set_db</span><span class="p">(</span><span class="n">folder_path</span><span class="o">=</span><span class="n">folder_path</span><span class="p">,</span> <span class="n">use</span><span class="o">=</span><span class="n">use</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="microfading.microfading.set_colorimetry_info" class="doc doc-heading">
            <code class=" language-python"><span class="n">set_colorimetry_info</span><span class="p">()</span></code>

<a href="#microfading.microfading.set_colorimetry_info" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Record the colorimetric information (observer, illuminant, white standard) in the config_info.json file of the microfading package.</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_colorimetry_info</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Record the colorimetric information (observer, illuminant, white standard) in the config_info.json file of the microfading package.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">config</span><span class="o">.</span><span class="n">set_colorimetry_info</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="microfading.microfading.set_devices_info" class="doc doc-heading">
            <code class=" language-python"><span class="n">set_devices_info</span><span class="p">()</span></code>

<a href="#microfading.microfading.set_devices_info" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Record the device info in the config_info.json file of the microfading package.</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_devices_info</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Record the device info in the config_info.json file of the microfading package.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">config</span><span class="o">.</span><span class="n">set_devices_info</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="microfading.microfading.set_exposure_conditions" class="doc doc-heading">
            <code class=" language-python"><span class="n">set_exposure_conditions</span><span class="p">()</span></code>

<a href="#microfading.microfading.set_exposure_conditions" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Record the exposure lighting conditions in the config_info.json file of the microfading package.</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_exposure_conditions</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Record the exposure lighting conditions in the config_info.json file of the microfading package.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">config</span><span class="o">.</span><span class="n">set_exposure_conditions</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="microfading.microfading.set_institution_info" class="doc doc-heading">
            <code class=" language-python"><span class="n">set_institution_info</span><span class="p">()</span></code>

<a href="#microfading.microfading.set_institution_info" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Set the information regarding your institution. As a user of the microfading package, you can enter information regarding your professional environment. These information will be automatically added in the microfading data file and inside the reports.</p>
<h4 id="microfading.microfading.set_institution_info--returns">Returns<a class="headerlink" href="#microfading.microfading.set_institution_info--returns" title="Permanent link">&para;</a></h4>
<p>It returns several ipywdigets where you can enter the information regarding your professional environment.</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_institution_info</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the information regarding your institution. As a user of the microfading package, you can enter information regarding your professional environment. These information will be automatically added in the microfading data file and inside the reports.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    It returns several ipywdigets where you can enter the information regarding your professional environment.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">config</span><span class="o">.</span><span class="n">set_institution_info</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="microfading.microfading.set_light_dose" class="doc doc-heading">
            <code class=" language-python"><span class="n">set_light_dose</span><span class="p">()</span></code>

<a href="#microfading.microfading.set_light_dose" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Record the unit of the light dose in the config_info.json file of the microfading package.</p>

            <details class="quote">
              <summary>Source code in <code>microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_light_dose</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Record the unit of the light dose in the config_info.json file of the microfading package.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="k">return</span> <span class="n">config</span><span class="o">.</span><span class="n">set_light_dose</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/g-patin/msdb" target="_blank" rel="noopener" title="GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy"], "search": "../assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.56dfad97.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>